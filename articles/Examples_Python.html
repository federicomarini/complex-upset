<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Examples - Python • ComplexUpset</title>
<!-- jquery --><script src="file:///usr/share/javascript/jquery/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="file:///usr/share/javascript/bootstrap/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="file:///usr/share/javascript/bootstrap/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Examples - Python">
<meta property="og:description" content="ComplexUpset">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:creator" content="@krassowski">
<meta name="twitter:site" content="@krassowski">
<!-- mathjax --><script src="file:///usr/share/javascript/mathjax/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ComplexUpset</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.3.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Examples_Python.html">Examples - Python</a>
    </li>
    <li>
      <a href="../articles/Examples_R.html">Examples - R</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/krassowski/complex-upset/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Examples - Python</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/krassowski/complex-upset/blob/HEAD/vignettes/Examples_Python.Rmd" class="external-link"><code>vignettes/Examples_Python.Rmd</code></a></small>
      <div class="hidden name"><code>Examples_Python.Rmd</code></div>

    </div>

    
    
<div class="section level3">
<h3 id="python-integration-for-use-in-jupyter-notebooks">Python integration (for use in Jupyter Notebooks)<a class="anchor" aria-label="anchor" href="#python-integration-for-use-in-jupyter-notebooks"></a>
</h3>
<p>Please install the requirements using:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install pandas pydataset rpy2</span></code></pre></div>
<p>Load <code>rpy2</code> extension:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>capture</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>load_ext rpy2.ipython</span></code></pre></div>
<p>Install the package (if not already installed):</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="sc">%%</span>R</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(devtools, <span class="at">quietly=</span>T)) <span class="fu">install.packages</span>(<span class="st">"devtools"</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(ComplexUpset, <span class="at">quietly=</span>T)) devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"krassowski/complex-upset"</span>)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="load-ggplot2-and-complexupset">Load ggplot2 and ComplexUpset<a class="anchor" aria-label="anchor" href="#load-ggplot2-and-complexupset"></a>
</h2>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="sc">%%</span>R</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ComplexUpset)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="prepare-the-datasets">Prepare the datasets<a class="anchor" aria-label="anchor" href="#prepare-the-datasets"></a>
</h2>
<div class="sourceCode" id="cb5"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pydataset <span class="im">import</span> data <span class="im">as</span> load_data</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>movies <span class="op">=</span> load_data(<span class="st">'movies'</span>).dropna()</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>movies.head(<span class="dv">3</span>).T</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="table dataframe">
<thead><tr style="text-align: right;">
<th>
</th>
<th>
48
</th>
<th>
112
</th>
<th>
124
</th>
</tr></thead>
<tbody>
<tr>
<th>
title
</th>
<td>
’Til There Was You
</td>
<td>
10 Things I Hate About You
</td>
<td>
100 Mile Rule
</td>
</tr>
<tr>
<th>
year
</th>
<td>
1997
</td>
<td>
1999
</td>
<td>
2002
</td>
</tr>
<tr>
<th>
length
</th>
<td>
113
</td>
<td>
97
</td>
<td>
98
</td>
</tr>
<tr>
<th>
budget
</th>
<td>
2.3e+07
</td>
<td>
1.6e+07
</td>
<td>
1.1e+06
</td>
</tr>
<tr>
<th>
rating
</th>
<td>
4.8
</td>
<td>
6.7
</td>
<td>
5.6
</td>
</tr>
<tr>
<th>
votes
</th>
<td>
799
</td>
<td>
19095
</td>
<td>
181
</td>
</tr>
<tr>
<th>
r1
</th>
<td>
4.5
</td>
<td>
4.5
</td>
<td>
4.5
</td>
</tr>
<tr>
<th>
r2
</th>
<td>
4.5
</td>
<td>
4.5
</td>
<td>
4.5
</td>
</tr>
<tr>
<th>
r3
</th>
<td>
4.5
</td>
<td>
4.5
</td>
<td>
4.5
</td>
</tr>
<tr>
<th>
r4
</th>
<td>
14.5
</td>
<td>
4.5
</td>
<td>
4.5
</td>
</tr>
<tr>
<th>
r5
</th>
<td>
14.5
</td>
<td>
4.5
</td>
<td>
14.5
</td>
</tr>
<tr>
<th>
r6
</th>
<td>
14.5
</td>
<td>
14.5
</td>
<td>
24.5
</td>
</tr>
<tr>
<th>
r7
</th>
<td>
14.5
</td>
<td>
24.5
</td>
<td>
14.5
</td>
</tr>
<tr>
<th>
r8
</th>
<td>
4.5
</td>
<td>
14.5
</td>
<td>
14.5
</td>
</tr>
<tr>
<th>
r9
</th>
<td>
4.5
</td>
<td>
14.5
</td>
<td>
4.5
</td>
</tr>
<tr>
<th>
r10
</th>
<td>
14.5
</td>
<td>
14.5
</td>
<td>
14.5
</td>
</tr>
<tr>
<th>
mpaa
</th>
<td>
PG-13
</td>
<td>
PG-13
</td>
<td>
R
</td>
</tr>
<tr>
<th>
Action
</th>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
</tr>
<tr>
<th>
Animation
</th>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
</tr>
<tr>
<th>
Comedy
</th>
<td>
1
</td>
<td>
1
</td>
<td>
1
</td>
</tr>
<tr>
<th>
Drama
</th>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
</tr>
<tr>
<th>
Documentary
</th>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
</tr>
<tr>
<th>
Romance
</th>
<td>
1
</td>
<td>
1
</td>
<td>
0
</td>
</tr>
<tr>
<th>
Short
</th>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode" id="cb6"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>genres <span class="op">=</span> <span class="bu">list</span>(movies.columns[<span class="op">-</span><span class="dv">7</span>:])</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>genres</span></code></pre></div>
<pre><code>['Action', 'Animation', 'Comedy', 'Drama', 'Documentary', 'Romance', 'Short']</code></pre>
<p>Convert the genre indicator columns to use boolean values:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>movies[genres] <span class="op">=</span> movies[genres] <span class="op">==</span> <span class="dv">1</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>movies[genres].head(<span class="dv">3</span>).T</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="table dataframe">
<thead><tr style="text-align: right;">
<th>
</th>
<th>
48
</th>
<th>
112
</th>
<th>
124
</th>
</tr></thead>
<tbody>
<tr>
<th>
Action
</th>
<td>
False
</td>
<td>
False
</td>
<td>
False
</td>
</tr>
<tr>
<th>
Animation
</th>
<td>
False
</td>
<td>
False
</td>
<td>
False
</td>
</tr>
<tr>
<th>
Comedy
</th>
<td>
True
</td>
<td>
True
</td>
<td>
True
</td>
</tr>
<tr>
<th>
Drama
</th>
<td>
False
</td>
<td>
False
</td>
<td>
False
</td>
</tr>
<tr>
<th>
Documentary
</th>
<td>
False
</td>
<td>
False
</td>
<td>
False
</td>
</tr>
<tr>
<th>
Romance
</th>
<td>
True
</td>
<td>
True
</td>
<td>
False
</td>
</tr>
<tr>
<th>
Short
</th>
<td>
False
</td>
<td>
False
</td>
<td>
False
</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="quick-notes-on-rpy2-r-magic-usage">Quick notes on <code>rpy2</code> <code>%%R</code> magic usage<a class="anchor" aria-label="anchor" href="#quick-notes-on-rpy2-r-magic-usage"></a>
</h3>
<ul>
<li>use <code>-i</code> switch to import data into R using rpy2
interface</li>
<li>
<code>-w</code> and <code>-h</code> can be used to adjust the width
and height of the plot</li>
<li>
<code>-r</code> switch can be used to adjust DPI</li>
</ul>
</div>
<div class="section level3">
<h3 id="import-the-python-data-frame-to-r">Import the Python data frame to R<a class="anchor" aria-label="anchor" href="#import-the-python-data-frame-to-r"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>R <span class="op">-</span>i movies <span class="op">-</span>i genres</span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="basic-usage">0. Basic usage<a class="anchor" aria-label="anchor" href="#basic-usage"></a>
</h2>
<p>There are two required arguments:</p>
<ul>
<li>the first argument is expected to be a dataframe with both group
indicator variables and covariates,</li>
<li>the second argument specifies a list with names of column which
indicate the group membership.</li>
</ul>
<p>Additional arguments can be provided, such as <code>name</code>
(specifies <code><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab()</a></code> for intersection matrix) or
<code>width_ratio</code> (specifies how much space should be occupied by
the set size panel). Other such arguments are discussed at length later
in this document.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="sc">%%</span>R <span class="sc">-</span>w <span class="dv">800</span> <span class="sc">-</span>h <span class="dv">300</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(movies, genres, <span class="at">name=</span><span class="st">'genre'</span>, <span class="at">width_ratio=</span><span class="fl">0.1</span>)</span></code></pre></div>
<p><img src="Examples_Python_files/Examples_Python_19_0.png"></p>
<div class="section level3">
<h3 id="selecting-intersections">0.1 Selecting intersections<a class="anchor" aria-label="anchor" href="#selecting-intersections"></a>
</h3>
<p>We will focus on the intersections with at least ten members
<code>(min_size=10)</code> and on a few variables which are
significantly different between the intersections (see 2. Running
statistical tests).</p>
<p>When using <code>min_size</code>, the empty groups will be skipped by
default (e.g. <em>Short</em> movies would have no overlap with size of
10). To keep all groups pass <code>keep_empty_groups=TRUE</code>:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="sc">%%</span>R <span class="sc">-</span>w <span class="dv">800</span> <span class="sc">-</span>h <span class="dv">300</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">upset</span>(movies, genres, <span class="at">name=</span><span class="st">'genre'</span>, <span class="at">width_ratio=</span><span class="fl">0.1</span>, <span class="at">min_size=</span><span class="dv">10</span>, <span class="at">wrap=</span><span class="cn">TRUE</span>, <span class="at">set_sizes=</span><span class="cn">FALSE</span>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">'Without empty groups (Short dropped)'</span>)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span>    <span class="co"># adding plots is possible thanks to patchwork</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">upset</span>(movies, genres, <span class="at">name=</span><span class="st">'genre'</span>, <span class="at">width_ratio=</span><span class="fl">0.1</span>, <span class="at">min_size=</span><span class="dv">10</span>, <span class="at">keep_empty_groups=</span><span class="cn">TRUE</span>, <span class="at">wrap=</span><span class="cn">TRUE</span>, <span class="at">set_sizes=</span><span class="cn">FALSE</span>)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">'With empty groups'</span>)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="Examples_Python_files/Examples_Python_22_0.png"></p>
<p>When empty columns are detected a warning will be issued. The silence
it, pass <code>warn_when_dropping_groups=FALSE</code>. Complimentary
<code>max_size</code> can be used in tandem.</p>
<p>You can also select intersections by degree (<code>min_degree</code>
and <code>max_degree</code>):</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="sc">%%</span>R <span class="sc">-</span>w <span class="dv">800</span> <span class="sc">-</span>h <span class="dv">300</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    movies, genres, <span class="at">width_ratio=</span><span class="fl">0.1</span>,</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_degree=</span><span class="dv">3</span>,</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="Examples_Python_files/Examples_Python_25_0.png"></p>
<p>Or request a constant number of intersections with
<code>n_intersections</code>:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="sc">%%</span>R <span class="sc">-</span>w <span class="dv">800</span> <span class="sc">-</span>h <span class="dv">300</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    movies, genres, <span class="at">width_ratio=</span><span class="fl">0.1</span>,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_intersections=</span><span class="dv">15</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="Examples_Python_files/Examples_Python_27_0.png"></p>
</div>
<div class="section level3">
<h3 id="region-selection-modes">0.2 Region selection modes<a class="anchor" aria-label="anchor" href="#region-selection-modes"></a>
</h3>
<p>There are four modes defining the regions of interest on
corresponding Venn diagram:</p>
<ul>
<li>
<code>exclusive_intersection</code> region: intersection elements
that belong to the sets defining the intersection but not to any other
set (alias: <em>distinct</em>), <strong>default</strong>
</li>
<li>
<code>inclusive_intersection</code> region: intersection elements
that belong to the sets defining the intersection including overlaps
with other sets (alias: <em>intersect</em>)</li>
<li>
<code>exclusive_union</code> region: union elements that belong to
the sets defining the union, <em>excluding</em> those overlapping with
any other set</li>
<li>
<code>inclusive_union</code> region: union elements that belong to
the sets defining the union, <em>including</em> those overlapping with
any other set (alias: <em>union</em>)</li>
</ul>
<p>Example: given three sets <span class="math inline">\(A\)</span>,
<span class="math inline">\(B\)</span> and <span class="math inline">\(C\)</span> with number of elements defined by the
Venn diagram below</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="sc">%%</span>R</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>abc_data <span class="ot">=</span> <span class="fu">create_upset_abc_example</span>()</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>abc_venn <span class="ot">=</span> (</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">arrange_venn</span>(abc_data))</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> <span class="fu">coord_fixed</span>()</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> <span class="fu">theme_void</span>()</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> <span class="fu">scale_color_venn_mix</span>(abc_data)</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>    abc_venn</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> <span class="fu">geom_venn_region</span>(<span class="at">data=</span>abc_data, <span class="at">alpha=</span><span class="fl">0.05</span>)</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y, <span class="at">color=</span>region), <span class="at">size=</span><span class="dv">1</span>)</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> <span class="fu">geom_venn_circle</span>(abc_data)</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> <span class="fu">geom_venn_label_set</span>(abc_data, <span class="fu">aes</span>(<span class="at">label=</span>region))</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> <span class="fu">geom_venn_label_region</span>(</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>        abc_data, <span class="fu">aes</span>(<span class="at">label=</span>size),</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">outwards_adjust=</span><span class="fl">1.75</span>,</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">position=</span><span class="fu">position_nudge</span>(<span class="at">y=</span><span class="fl">0.2</span>)</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> <span class="fu">scale_fill_venn_mix</span>(abc_data, <span class="at">guide=</span><span class="st">'none'</span>)</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="Examples_Python_files/Examples_Python_31_0.png"></p>
<p>For the above sets <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> the region selection modes correspond
to region of Venn diagram defined as follows:</p>
<ul>
<li>exclusive intersection: <span class="math inline">\((A \cap B)
\setminus C\)</span>
</li>
<li>inclusive intersection: <span class="math inline">\(A \cap
B\)</span>
</li>
<li>exclusive union: <span class="math inline">\((A \cup B) \setminus
C\)</span>
</li>
<li>inclusive union: <span class="math inline">\(A \cup B\)</span>
</li>
</ul>
<p>and have the total number of elements as in the table below:</p>
<table style="width:100%;" class="table">
<colgroup>
<col width="24%">
<col width="13%">
<col width="14%">
<col width="24%">
<col width="22%">
</colgroup>
<thead><tr class="header">
<th>members  mode</th>
<th>exclusive int.</th>
<th>inclusive int.</th>
<th>exclusive union</th>
<th>inclusive union</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>(A, B)</td>
<td>10</td>
<td>11</td>
<td>110</td>
<td>123</td>
</tr>
<tr class="even">
<td>(A, C) == (B, C)</td>
<td>6</td>
<td>7</td>
<td>256</td>
<td>273</td>
</tr>
<tr class="odd">
<td>(A) == (B)</td>
<td>50</td>
<td>67</td>
<td>50</td>
<td>67</td>
</tr>
<tr class="even">
<td>(C)</td>
<td>200</td>
<td>213</td>
<td>200</td>
<td>213</td>
</tr>
<tr class="odd">
<td>(A, B, C)</td>
<td>1</td>
<td>1</td>
<td>323</td>
<td>323</td>
</tr>
<tr class="even">
<td>()</td>
<td>2</td>
<td>2</td>
<td>2</td>
<td>2</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="sc">%%</span>R <span class="sc">-</span>w <span class="dv">600</span> <span class="sc">-</span>h <span class="dv">650</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>simple_venn <span class="ot">=</span> (</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    abc_venn</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> <span class="fu">geom_venn_region</span>(<span class="at">data=</span>abc_data, <span class="at">alpha=</span><span class="fl">0.3</span>)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y), <span class="at">size=</span><span class="fl">0.75</span>, <span class="at">alpha=</span><span class="fl">0.3</span>)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> <span class="fu">geom_venn_circle</span>(abc_data)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> <span class="fu">geom_venn_label_set</span>(abc_data, <span class="fu">aes</span>(<span class="at">label=</span>region), <span class="at">outwards_adjust=</span><span class="fl">2.55</span>)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>highlight <span class="ot">=</span> <span class="cf">function</span>(regions) <span class="fu">scale_fill_venn_mix</span>(</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    abc_data, <span class="at">guide=</span><span class="st">'none'</span>, <span class="at">highlight=</span>regions, <span class="at">inactive_color=</span><span class="st">'NA'</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>    (</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>        simple_venn <span class="sc">+</span> <span class="fu">highlight</span>(<span class="fu">c</span>(<span class="st">'A-B'</span>)) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title=</span><span class="st">'Exclusive intersection of A and B'</span>)</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>        <span class="sc">|</span> simple_venn <span class="sc">+</span> <span class="fu">highlight</span>(<span class="fu">c</span>(<span class="st">'A-B'</span>, <span class="st">'A-B-C'</span>)) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title=</span><span class="st">'Inclusive intersection of A and B'</span>)</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">/</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>    (</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>        simple_venn <span class="sc">+</span> <span class="fu">highlight</span>(<span class="fu">c</span>(<span class="st">'A-B'</span>, <span class="st">'A'</span>, <span class="st">'B'</span>)) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title=</span><span class="st">'Exclusive union of A and B'</span>)</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>        <span class="sc">|</span> simple_venn <span class="sc">+</span> <span class="fu">highlight</span>(<span class="fu">c</span>(<span class="st">'A-B'</span>, <span class="st">'A-B-C'</span>, <span class="st">'A'</span>, <span class="st">'B'</span>, <span class="st">'A-C'</span>, <span class="st">'B-C'</span>)) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title=</span><span class="st">'Inclusive union of A and B'</span>)</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="Examples_Python_files/Examples_Python_34_0.png"></p>
<p>When customizing the <code><a href="../reference/intersection_size.html">intersection_size()</a></code> it is important
to adjust the mode accordingly, as it defaults to
<code>exclusive_intersection</code> and cannot be automatically deduced
when user customizations are being applied:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="sc">%%</span>R <span class="sc">-</span>w <span class="dv">800</span> <span class="sc">-</span>h <span class="dv">450</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>abc_upset <span class="ot">=</span> <span class="cf">function</span>(mode) <span class="fu">upset</span>(</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    abc_data, <span class="fu">c</span>(<span class="st">'A'</span>, <span class="st">'B'</span>, <span class="st">'C'</span>), <span class="at">mode=</span>mode, <span class="at">set_sizes=</span><span class="cn">FALSE</span>,</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">encode_sets=</span><span class="cn">FALSE</span>,</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">queries=</span><span class="fu">list</span>(<span class="fu">upset_query</span>(<span class="at">intersect=</span><span class="fu">c</span>(<span class="st">'A'</span>, <span class="st">'B'</span>), <span class="at">color=</span><span class="st">'orange'</span>)),</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">base_annotations=</span><span class="fu">list</span>(</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Size'</span><span class="ot">=</span>(</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>            <span class="fu">intersection_size</span>(</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">mode=</span>mode,</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">fill=</span>exclusive_intersection),</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>                <span class="at">size=</span><span class="dv">0</span>,</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>                <span class="at">text=</span><span class="fu">list</span>(<span class="at">check_overlap=</span><span class="cn">TRUE</span>)</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>            ) <span class="sc">+</span> <span class="fu">scale_fill_venn_mix</span>(</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>                <span class="at">data=</span>abc_data,</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>                <span class="at">guide=</span><span class="st">'none'</span>,</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>                <span class="at">colors=</span><span class="fu">c</span>(<span class="st">'A'</span><span class="ot">=</span><span class="st">'red'</span>, <span class="st">'B'</span><span class="ot">=</span><span class="st">'blue'</span>, <span class="st">'C'</span><span class="ot">=</span><span class="st">'green3'</span>)</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>    (<span class="fu">abc_upset</span>(<span class="st">'exclusive_intersection'</span>) <span class="sc">|</span> <span class="fu">abc_upset</span>(<span class="st">'inclusive_intersection'</span>))</span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>    <span class="sc">/</span></span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>    (<span class="fu">abc_upset</span>(<span class="st">'exclusive_union'</span>) <span class="sc">|</span> <span class="fu">abc_upset</span>(<span class="st">'inclusive_union'</span>))</span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="Examples_Python_files/Examples_Python_36_0.png"></p>
</div>
<div class="section level3">
<h3 id="displaying-all-intersections">0.3 Displaying all intersections<a class="anchor" aria-label="anchor" href="#displaying-all-intersections"></a>
</h3>
<p>To display all possible intersections (rather than only the observed
ones) use <code>intersections='all'</code>.</p>
<p><strong>Note 1</strong>: it is usually desired to filter all the
possible intersections down with <code>max_degree</code> and/or
<code>min_degree</code> to avoid generating all combinations as those
can easily use up all available RAM memory when dealing with multiple
sets (e.g. all human genes) due to sheer number of possible
combinations</p>
<p><strong>Note 2</strong>: using <code>intersections='all'</code> is
only reasonable for mode different from the default <em>exclusive
intersection</em>.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="sc">%%</span>R <span class="sc">-</span>w <span class="dv">800</span> <span class="sc">-</span>h <span class="dv">300</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    movies, genres,</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">width_ratio=</span><span class="fl">0.1</span>,</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_size=</span><span class="dv">10</span>,</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">mode=</span><span class="st">'inclusive_union'</span>,</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">base_annotations=</span><span class="fu">list</span>(<span class="st">'Size'</span><span class="ot">=</span>(<span class="fu">intersection_size</span>(<span class="at">counts=</span><span class="cn">FALSE</span>, <span class="at">mode=</span><span class="st">'inclusive_union'</span>))),</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">intersections=</span><span class="st">'all'</span>,</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">max_degree=</span><span class="dv">3</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="Examples_Python_files/Examples_Python_39_0.png"></p>
</div>
</div>
<div class="section level2">
<h2 id="adding-components">1. Adding components<a class="anchor" aria-label="anchor" href="#adding-components"></a>
</h2>
<p>We can add multiple annotation components (also called panels) using
one of the three methods demonstrated below:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="sc">%%</span>R <span class="sc">-</span>w <span class="dv">800</span> <span class="sc">-</span>h <span class="dv">800</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)   <span class="co"># keep the same jitter for identical plots</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    movies,</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    genres,</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">annotations =</span> <span class="fu">list</span>(</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 1st method - passing list:</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Length'</span><span class="ot">=</span><span class="fu">list</span>(</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">aes=</span><span class="fu">aes</span>(<span class="at">x=</span>intersection, <span class="at">y=</span>length),</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>            <span class="co"># provide a list if you wish to add several geoms</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">geom=</span><span class="fu">geom_boxplot</span>(<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 2nd method - using ggplot</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Rating'</span><span class="ot">=</span>(</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>            <span class="co"># note that aes(x=intersection) is supplied by default and can be skipped</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>            <span class="fu">ggplot</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">y=</span>rating))</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>            <span class="co"># checkout ggbeeswarm::geom_quasirandom for better results!</span></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>            <span class="sc">+</span> <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">color=</span><span class="fu">log10</span>(votes)), <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>            <span class="sc">+</span> <span class="fu">geom_violin</span>(<span class="at">alpha=</span><span class="fl">0.5</span>, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 3rd method - using `upset_annotate` shorthand</span></span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Budget'</span><span class="ot">=</span><span class="fu">upset_annotate</span>(<span class="st">'budget'</span>, <span class="fu">geom_boxplot</span>(<span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_size=</span><span class="dv">10</span>,</span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">width_ratio=</span><span class="fl">0.1</span></span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="Examples_Python_files/Examples_Python_42_0.png"></p>
<p>You can also use barplots to demonstrate differences in proportions
of categorical variables:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="sc">%%</span>R <span class="sc">-</span>w <span class="dv">800</span> <span class="sc">-</span>h <span class="dv">500</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    movies,</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    genres,</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">annotations =</span> <span class="fu">list</span>(</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">'MPAA Rating'</span><span class="ot">=</span>(</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>            <span class="fu">ggplot</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">fill=</span>mpaa))</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>            <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'count'</span>, <span class="at">position=</span><span class="st">'fill'</span>)</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>            <span class="sc">+</span> <span class="fu">scale_y_continuous</span>(<span class="at">labels=</span>scales<span class="sc">::</span><span class="fu">percent_format</span>())</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>            <span class="sc">+</span> <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>                <span class="st">'R'</span><span class="ot">=</span><span class="st">'#E41A1C'</span>, <span class="st">'PG'</span><span class="ot">=</span><span class="st">'#377EB8'</span>,</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>                <span class="st">'PG-13'</span><span class="ot">=</span><span class="st">'#4DAF4A'</span>, <span class="st">'NC-17'</span><span class="ot">=</span><span class="st">'#FF7F00'</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>            ))</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>            <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">'MPAA Rating'</span>)</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">width_ratio=</span><span class="fl">0.1</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="Examples_Python_files/Examples_Python_44_0.png"></p>
<div class="section level3">
<h3 id="changing-modes-in-annotations">1.1. Changing modes in annotations<a class="anchor" aria-label="anchor" href="#changing-modes-in-annotations"></a>
</h3>
<p>Use <code>upset_mode</code> to change the mode of the annotation:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="sc">%%</span>R <span class="sc">-</span>w <span class="dv">800</span> <span class="sc">-</span>h <span class="dv">800</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    movies,</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    genres,</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">mode=</span><span class="st">'inclusive_intersection'</span>,</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">annotations =</span> <span class="fu">list</span>(</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>        <span class="co"># if not specified, the mode will follow the mode set in `upset()` call (here: `inclusive_intersection`)</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Length (inclusive intersection)'</span><span class="ot">=</span>(</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>            <span class="fu">ggplot</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">y=</span>length))</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>            <span class="sc">+</span> <span class="fu">geom_jitter</span>(<span class="at">alpha=</span><span class="fl">0.2</span>, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Length (exclusive intersection)'</span><span class="ot">=</span>(</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>            <span class="fu">ggplot</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">y=</span>length))</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>            <span class="sc">+</span> <span class="fu">geom_jitter</span>(<span class="at">alpha=</span><span class="fl">0.2</span>, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>            <span class="sc">+</span> <span class="fu">upset_mode</span>(<span class="st">'exclusive_intersection'</span>)</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Length (inclusive union)'</span><span class="ot">=</span>(</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>            <span class="fu">ggplot</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">y=</span>length))</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>            <span class="sc">+</span> <span class="fu">geom_jitter</span>(<span class="at">alpha=</span><span class="fl">0.2</span>, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>            <span class="sc">+</span> <span class="fu">upset_mode</span>(<span class="st">'inclusive_union'</span>)</span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_size=</span><span class="dv">10</span>,</span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">width_ratio=</span><span class="fl">0.1</span></span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="Examples_Python_files/Examples_Python_47_0.png"></p>
</div>
</div>
<div class="section level2">
<h2 id="running-statistical-tests">2. Running statistical tests<a class="anchor" aria-label="anchor" href="#running-statistical-tests"></a>
</h2>
<div class="sourceCode" id="cb21"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>R upset_test(movies, genres)</span></code></pre></div>
<pre><code>[1] "year, length, budget, rating, votes, r1, r2, r3, r4, r5, r6, r7, r8, r9, r10, mpaa differ significantly between intersections"</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="table dataframe">
<thead><tr style="text-align: right;">
<th>
</th>
<th>
variable
</th>
<th>
p.value
</th>
<th>
statistic
</th>
<th>
test
</th>
<th>
fdr
</th>
</tr></thead>
<tbody>
<tr>
<th>
length
</th>
<td>
length
</td>
<td>
6.511525e-71
</td>
<td>
422.884445
</td>
<td>
Kruskal-Wallis rank sum test
</td>
<td>
1.106959e-69
</td>
</tr>
<tr>
<th>
rating
</th>
<td>
rating
</td>
<td>
1.209027e-46
</td>
<td>
301.727638
</td>
<td>
Kruskal-Wallis rank sum test
</td>
<td>
1.027673e-45
</td>
</tr>
<tr>
<th>
budget
</th>
<td>
budget
</td>
<td>
3.899860e-44
</td>
<td>
288.974760
</td>
<td>
Kruskal-Wallis rank sum test
</td>
<td>
2.209921e-43
</td>
</tr>
<tr>
<th>
r8
</th>
<td>
r8
</td>
<td>
9.900004e-39
</td>
<td>
261.288151
</td>
<td>
Kruskal-Wallis rank sum test
</td>
<td>
4.207502e-38
</td>
</tr>
<tr>
<th>
mpaa
</th>
<td>
mpaa
</td>
<td>
3.732200e-35
</td>
<td>
242.779393
</td>
<td>
Kruskal-Wallis rank sum test
</td>
<td>
1.268948e-34
</td>
</tr>
<tr>
<th>
r9
</th>
<td>
r9
</td>
<td>
1.433256e-30
</td>
<td>
218.781602
</td>
<td>
Kruskal-Wallis rank sum test
</td>
<td>
4.060891e-30
</td>
</tr>
<tr>
<th>
r1
</th>
<td>
r1
</td>
<td>
2.211600e-23
</td>
<td>
180.327398
</td>
<td>
Kruskal-Wallis rank sum test
</td>
<td>
5.371029e-23
</td>
</tr>
<tr>
<th>
r4
</th>
<td>
r4
</td>
<td>
1.008119e-18
</td>
<td>
154.627715
</td>
<td>
Kruskal-Wallis rank sum test
</td>
<td>
2.142254e-18
</td>
</tr>
<tr>
<th>
r3
</th>
<td>
r3
</td>
<td>
2.568227e-17
</td>
<td>
146.702174
</td>
<td>
Kruskal-Wallis rank sum test
</td>
<td>
4.851095e-17
</td>
</tr>
<tr>
<th>
r5
</th>
<td>
r5
</td>
<td>
9.823827e-16
</td>
<td>
137.663096
</td>
<td>
Kruskal-Wallis rank sum test
</td>
<td>
1.670051e-15
</td>
</tr>
<tr>
<th>
r7
</th>
<td>
r7
</td>
<td>
9.201549e-14
</td>
<td>
126.192430
</td>
<td>
Kruskal-Wallis rank sum test
</td>
<td>
1.422058e-13
</td>
</tr>
<tr>
<th>
r2
</th>
<td>
r2
</td>
<td>
2.159955e-13
</td>
<td>
124.006043
</td>
<td>
Kruskal-Wallis rank sum test
</td>
<td>
3.059936e-13
</td>
</tr>
<tr>
<th>
r10
</th>
<td>
r10
</td>
<td>
1.283470e-11
</td>
<td>
113.381126
</td>
<td>
Kruskal-Wallis rank sum test
</td>
<td>
1.678384e-11
</td>
</tr>
<tr>
<th>
votes
</th>
<td>
votes
</td>
<td>
2.209085e-10
</td>
<td>
105.795879
</td>
<td>
Kruskal-Wallis rank sum test
</td>
<td>
2.682460e-10
</td>
</tr>
<tr>
<th>
r6
</th>
<td>
r6
</td>
<td>
3.779129e-05
</td>
<td>
70.809705
</td>
<td>
Kruskal-Wallis rank sum test
</td>
<td>
4.283013e-05
</td>
</tr>
<tr>
<th>
year
</th>
<td>
year
</td>
<td>
2.745818e-02
</td>
<td>
46.559723
</td>
<td>
Kruskal-Wallis rank sum test
</td>
<td>
2.917431e-02
</td>
</tr>
<tr>
<th>
title
</th>
<td>
title
</td>
<td>
2.600003e-01
</td>
<td>
34.533745
</td>
<td>
Kruskal-Wallis rank sum test
</td>
<td>
2.600003e-01
</td>
</tr>
</tbody>
</table>
</div>
<p><code>Kruskal-Wallis rank sum test</code> is not always the best
choice.</p>
<p>You can either change the test for:</p>
<ul>
<li>all the variables (<code>test=your.test</code>), or</li>
<li>specific variables (using
<code>tests=list(variable=some.test)</code> argument)</li>
</ul>
<p>The tests are called with
<code>(formula=variable ~ intersection, data)</code> signature, such as
accepted by <code>kruskal.test</code>. The result is expected to be a
list with following members:</p>
<ul>
<li><code>p.value</code></li>
<li><code>statistic</code></li>
<li><code>method</code></li>
</ul>
<p>It is easy to adapt tests which do not obey this signature/output
convention; for example the Chi-squared test and anova can be wrapped
with two-line functions as follows:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="sc">%%</span>R</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>chisq_from_formula <span class="ot">=</span> <span class="cf">function</span>(formula, data) {</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">chisq.test</span>(</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ftable</span>(formula, data)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>anova_single <span class="ot">=</span> <span class="cf">function</span>(formula, data) {</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>    result <span class="ot">=</span> <span class="fu">summary</span>(<span class="fu">aov</span>(formula, data))</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">p.value=</span>result[[<span class="dv">1</span>]][[<span class="st">'Pr(&gt;F)'</span>]][[<span class="dv">1</span>]],</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">method=</span><span class="st">'Analysis of variance Pr(&gt;F)'</span>,</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">statistic=</span>result[[<span class="dv">1</span>]][[<span class="st">'F value'</span>]][[<span class="dv">1</span>]]</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>custom_tests <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">mpaa=</span>chisq_from_formula,</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">budget=</span>anova_single</span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>R head(upset_test(movies, genres, tests<span class="op">=</span>custom_tests))</span></code></pre></div>
<pre><code>[1] "year, length, budget, rating, votes, r1, r2, r3, r4, r5, r6, r7, r8, r9, r10, mpaa differ significantly between intersections"</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="table dataframe">
<thead><tr style="text-align: right;">
<th>
</th>
<th>
variable
</th>
<th>
p.value
</th>
<th>
statistic
</th>
<th>
test
</th>
<th>
fdr
</th>
</tr></thead>
<tbody>
<tr>
<th>
length
</th>
<td>
length
</td>
<td>
6.511525e-71
</td>
<td>
422.884445
</td>
<td>
Kruskal-Wallis rank sum test
</td>
<td>
1.106959e-69
</td>
</tr>
<tr>
<th>
budget
</th>
<td>
budget
</td>
<td>
1.348209e-60
</td>
<td>
13.663948
</td>
<td>
Analysis of variance Pr(&gt;F)
</td>
<td>
1.145977e-59
</td>
</tr>
<tr>
<th>
rating
</th>
<td>
rating
</td>
<td>
1.209027e-46
</td>
<td>
301.727638
</td>
<td>
Kruskal-Wallis rank sum test
</td>
<td>
6.851151e-46
</td>
</tr>
<tr>
<th>
mpaa
</th>
<td>
mpaa
</td>
<td>
9.799097e-42
</td>
<td>
406.338139
</td>
<td>
Pearson’s Chi-squared test
</td>
<td>
4.164616e-41
</td>
</tr>
<tr>
<th>
r8
</th>
<td>
r8
</td>
<td>
9.900004e-39
</td>
<td>
261.288151
</td>
<td>
Kruskal-Wallis rank sum test
</td>
<td>
3.366002e-38
</td>
</tr>
<tr>
<th>
r9
</th>
<td>
r9
</td>
<td>
1.433256e-30
</td>
<td>
218.781602
</td>
<td>
Kruskal-Wallis rank sum test
</td>
<td>
4.060891e-30
</td>
</tr>
</tbody>
</table>
</div>
<p>Many tests will require at least two observations in each group. You
can skip intersections with less than two members with
<code>min_size=2</code>.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="sc">%%</span>R</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>bartlett_results <span class="ot">=</span> <span class="fu">suppressWarnings</span>(<span class="fu">upset_test</span>(movies, genres, <span class="at">test=</span>bartlett.test, <span class="at">min_size=</span><span class="dv">2</span>))</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(bartlett_results)</span></code></pre></div>
<pre><code>[1] "NA, year, length, budget, rating, votes, r1, r2, r3, r4, r5, r6, r7, r8, r9, r10, NA differ significantly between intersections"
       variable      p.value statistic
year       year 1.041955e-67 386.53699
length   length 3.982729e-67 383.70148
budget   budget 7.637563e-50 298.89911
rating   rating 3.980194e-06  66.63277
title     title           NA        NA
mpaa       mpaa           NA        NA
                                            test          fdr
year   Bartlett test of homogeneity of variances 1.302444e-67
length Bartlett test of homogeneity of variances 4.595457e-67
budget Bartlett test of homogeneity of variances 8.183103e-50
rating Bartlett test of homogeneity of variances 3.980194e-06
title  Bartlett test of homogeneity of variances           NA
mpaa   Bartlett test of homogeneity of variances           NA</code></pre>
<div class="section level3">
<h3 id="ignore-specific-variables">2.1 Ignore specific variables<a class="anchor" aria-label="anchor" href="#ignore-specific-variables"></a>
</h3>
<p>You may want to exclude variables which are:</p>
<ul>
<li>highly correlated and therefore interfering with the FDR
calculation, or</li>
<li>simply irrelevant</li>
</ul>
<p>In the movies example, the title variable is not a reasonable thing
to compare. We can ignore it using:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="sc">%%</span>R</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="co"># note: title no longer present</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(<span class="fu">upset_test</span>(movies, genres, <span class="at">ignore=</span><span class="fu">c</span>(<span class="st">'title'</span>)))</span></code></pre></div>
<pre><code>[1] "year, length, budget, rating, votes, r1, r2, r3, r4, r5, r6, r7, r8, r9, r10, mpaa differ significantly between intersections"
 [1] "length" "rating" "budget" "r8"     "mpaa"   "r9"     "r1"     "r4"    
 [9] "r3"     "r5"     "r7"     "r2"     "r10"    "votes"  "r6"     "year"  </code></pre>
</div>
</div>
<div class="section level2">
<h2 id="adjusting-intersection-size">3. Adjusting “Intersection size”<a class="anchor" aria-label="anchor" href="#adjusting-intersection-size"></a>
</h2>
<div class="section level3">
<h3 id="counts">3.1 Counts<a class="anchor" aria-label="anchor" href="#counts"></a>
</h3>
<p>The counts over the bars can be disabled:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="sc">%%</span>R <span class="sc">-</span>w <span class="dv">800</span> <span class="sc">-</span>h <span class="dv">300</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>    movies,</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>    genres,</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">base_annotations=</span><span class="fu">list</span>(</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Intersection size'</span><span class="ot">=</span><span class="fu">intersection_size</span>(<span class="at">counts=</span><span class="cn">FALSE</span>)</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_size=</span><span class="dv">10</span>,</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">width_ratio=</span><span class="fl">0.1</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="Examples_Python_files/Examples_Python_62_0.png"></p>
<p>The colors can be changed, and additional annotations added:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="sc">%%</span>R <span class="sc">-</span>w <span class="dv">800</span> <span class="sc">-</span>h <span class="dv">300</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>    movies,</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>    genres,</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">base_annotations=</span><span class="fu">list</span>(</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Intersection size'</span><span class="ot">=</span><span class="fu">intersection_size</span>(</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">text_colors=</span><span class="fu">c</span>(</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">on_background=</span><span class="st">'brown'</span>, <span class="at">on_bar=</span><span class="st">'yellow'</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>        <span class="sc">+</span> <span class="fu">annotate</span>(</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">geom=</span><span class="st">'text'</span>, <span class="at">x=</span><span class="cn">Inf</span>, <span class="at">y=</span><span class="cn">Inf</span>,</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">label=</span><span class="fu">paste</span>(<span class="st">'Total:'</span>, <span class="fu">nrow</span>(movies)),</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust=</span><span class="dv">1</span>, <span class="at">hjust=</span><span class="dv">1</span></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>        <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">'Intersection size'</span>)</span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_size=</span><span class="dv">10</span>,</span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">width_ratio=</span><span class="fl">0.1</span></span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="Examples_Python_files/Examples_Python_64_0.png"></p>
<p>Any parameter supported by <code>geom_text</code> can be passed in
<code>text</code> list:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="sc">%%</span>R <span class="sc">-</span>w <span class="dv">800</span> <span class="sc">-</span>h <span class="dv">300</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>    movies,</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>    genres,</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">base_annotations=</span><span class="fu">list</span>(</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Intersection size'</span><span class="ot">=</span><span class="fu">intersection_size</span>(</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">text=</span><span class="fu">list</span>(</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">vjust=</span><span class="sc">-</span><span class="fl">0.1</span>,</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">hjust=</span><span class="sc">-</span><span class="fl">0.1</span>,</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>                <span class="at">angle=</span><span class="dv">45</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_size=</span><span class="dv">10</span>,</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">width_ratio=</span><span class="fl">0.1</span></span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="Examples_Python_files/Examples_Python_66_0.png"></p>
</div>
<div class="section level3">
<h3 id="fill-the-bars">3.2 Fill the bars<a class="anchor" aria-label="anchor" href="#fill-the-bars"></a>
</h3>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="sc">%%</span>R <span class="sc">-</span>w <span class="dv">800</span> <span class="sc">-</span>h <span class="dv">300</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>    movies,</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>    genres,</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">base_annotations=</span><span class="fu">list</span>(</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Intersection size'</span><span class="ot">=</span><span class="fu">intersection_size</span>(</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">counts=</span><span class="cn">FALSE</span>,</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">fill=</span>mpaa)</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">width_ratio=</span><span class="fl">0.1</span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="Examples_Python_files/Examples_Python_68_0.png"></p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="sc">%%</span>R <span class="sc">-</span>w <span class="dv">800</span> <span class="sc">-</span>h <span class="dv">300</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>    movies,</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>    genres,</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">base_annotations=</span><span class="fu">list</span>(</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Intersection size'</span><span class="ot">=</span><span class="fu">intersection_size</span>(</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">counts=</span><span class="cn">FALSE</span>,</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">fill=</span>mpaa)</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>        ) <span class="sc">+</span> <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>            <span class="st">'R'</span><span class="ot">=</span><span class="st">'#E41A1C'</span>, <span class="st">'PG'</span><span class="ot">=</span><span class="st">'#377EB8'</span>,</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>            <span class="st">'PG-13'</span><span class="ot">=</span><span class="st">'#4DAF4A'</span>, <span class="st">'NC-17'</span><span class="ot">=</span><span class="st">'#FF7F00'</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>        ))</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">width_ratio=</span><span class="fl">0.1</span></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="Examples_Python_files/Examples_Python_69_0.png"></p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="sc">%%</span>R <span class="sc">-</span>w <span class="dv">800</span> <span class="sc">-</span>h <span class="dv">300</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>    movies,</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>    genres,</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">base_annotations=</span><span class="fu">list</span>(</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Intersection size'</span><span class="ot">=</span><span class="fu">intersection_size</span>(</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">counts=</span><span class="cn">FALSE</span>,</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">fill=</span><span class="st">'bars_color'</span>)</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>        ) <span class="sc">+</span> <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">'bars_color'</span><span class="ot">=</span><span class="st">'blue'</span>), <span class="at">guide=</span><span class="st">'none'</span>)</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">width_ratio=</span><span class="fl">0.1</span></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="Examples_Python_files/Examples_Python_70_0.png"></p>
</div>
<div class="section level3">
<h3 id="adjusting-the-height-ratio">3.3 Adjusting the height ratio<a class="anchor" aria-label="anchor" href="#adjusting-the-height-ratio"></a>
</h3>
<p>Setting <code>height_ratio=1</code> will cause the intersection
matrix and the intersection size to have an equal height:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="sc">%%</span>R <span class="sc">-</span>w <span class="dv">800</span> <span class="sc">-</span>h <span class="dv">300</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    movies,</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>    genres,</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">height_ratio=</span><span class="dv">1</span>,</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">width_ratio=</span><span class="fl">0.1</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="Examples_Python_files/Examples_Python_73_0.png"></p>
</div>
<div class="section level3">
<h3 id="hiding-intersection-size">3.5 Hiding intersection size<a class="anchor" aria-label="anchor" href="#hiding-intersection-size"></a>
</h3>
<p>You can always disable the intersection size altogether:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="sc">%%</span>R <span class="sc">-</span>w <span class="dv">800</span> <span class="sc">-</span>h <span class="dv">160</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>    movies,</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>    genres,</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">base_annotations=</span><span class="fu">list</span>(),</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_size=</span><span class="dv">10</span>,</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">width_ratio=</span><span class="fl">0.1</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="Examples_Python_files/Examples_Python_76_0.png"></p>
</div>
<div class="section level3">
<h3 id="showing-intersection-sizeunion-size-ratio">3.6 Showing intersection size/union size ratio<a class="anchor" aria-label="anchor" href="#showing-intersection-sizeunion-size-ratio"></a>
</h3>
<p>It can be useful to visualise which intersections are larger than
expected by chance (assuming equal probability of belonging to multiple
sets); this can be achieved using the intersection size/union size
ratio.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="sc">%%</span>R <span class="sc">-</span>w <span class="dv">800</span> <span class="sc">-</span>h <span class="dv">600</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>    movies, genres, <span class="at">name=</span><span class="st">'genre'</span>, <span class="at">width_ratio=</span><span class="fl">0.1</span>, <span class="at">min_size=</span><span class="dv">10</span>,</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">base_annotations=</span><span class="fu">list</span>(</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Intersection size'</span><span class="ot">=</span><span class="fu">intersection_size</span>(),</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Intersection ratio'</span><span class="ot">=</span><span class="fu">intersection_ratio</span>()</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="Examples_Python_files/Examples_Python_79_0.png"></p>
<p>The plot above tells us that the analysed documentary movies are
almost always (in over 60% of cases) documentaries (and nothing more!),
while comedies more often include elements of other genres (e.g. drama,
romance) rather than being comedies alone (like stand-up shows).</p>
</div>
<div class="section level3">
<h3 id="showing-percentages">3.7 Showing percentages<a class="anchor" aria-label="anchor" href="#showing-percentages"></a>
</h3>
<p><code>text_mapping</code> can be used to manipulate the aesthetics of
the labels. Using the <code>intersection_size</code> and
<code>union_size</code> one can calculate percentage of items in the
intersection (relative to the potential size of the intersection). A
<code>upset_text_percentage(digits=0, sep='')</code> shorthand is
provided for convenience:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="sc">%%</span>R <span class="sc">-</span>w <span class="dv">800</span> <span class="sc">-</span>h <span class="dv">600</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>    movies, genres, <span class="at">name=</span><span class="st">'genre'</span>, <span class="at">width_ratio=</span><span class="fl">0.1</span>, <span class="at">min_size=</span><span class="dv">10</span>,</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">base_annotations=</span><span class="fu">list</span>(</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>        <span class="co"># with manual aes specification:</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Intersection size'</span><span class="ot">=</span><span class="fu">intersection_size</span>(<span class="at">text_mapping=</span><span class="fu">aes</span>(<span class="at">label=</span><span class="fu">paste0</span>(<span class="fu">round</span>(</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>            <span class="sc">!!</span><span class="fu">get_size_mode</span>(<span class="st">'exclusive_intersection'</span>)<span class="sc">/!!</span><span class="fu">get_size_mode</span>(<span class="st">'inclusive_union'</span>) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>        ), <span class="st">'%'</span>))),</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>        <span class="co"># using shorthand:</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Intersection ratio'</span><span class="ot">=</span><span class="fu">intersection_ratio</span>(<span class="at">text_mapping=</span><span class="fu">aes</span>(<span class="at">label=</span><span class="sc">!!</span><span class="fu">upset_text_percentage</span>()))</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="Examples_Python_files/Examples_Python_83_0.png"></p>
<p>Also see <a href="#10-display-percentages">10. Display
percentages</a>.</p>
<div class="section level4">
<h4 id="showing-percentages-and-numbers-together">3.7.1 Showing percentages and numbers together<a class="anchor" aria-label="anchor" href="#showing-percentages-and-numbers-together"></a>
</h4>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="sc">%%</span>R <span class="sc">-</span>w <span class="dv">800</span> <span class="sc">-</span>h <span class="dv">300</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>    movies, genres, <span class="at">name=</span><span class="st">'genre'</span>, <span class="at">width_ratio=</span><span class="fl">0.1</span>, <span class="at">min_size=</span><span class="dv">10</span>,</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">base_annotations=</span><span class="fu">list</span>(</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Intersection size'</span><span class="ot">=</span><span class="fu">intersection_size</span>(</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">text_mapping=</span><span class="fu">aes</span>(<span class="at">label=</span><span class="fu">paste0</span>(</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>                <span class="sc">!!</span><span class="fu">upset_text_percentage</span>(),</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>                <span class="st">'</span><span class="sc">\n</span><span class="st">'</span>,</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>                <span class="st">'('</span>,</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>                <span class="sc">!!</span><span class="fu">get_size_mode</span>(<span class="st">'exclusive_intersection'</span>),</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>                <span class="st">')'</span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>            )),</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">bar_number_threshold=</span><span class="dv">1</span>,</span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">text=</span><span class="fu">list</span>(<span class="at">vjust=</span><span class="fl">1.1</span>)</span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="Examples_Python_files/Examples_Python_86_0.png"></p>
</div>
<div class="section level4">
<h4 id="custom-positioning-on-barsbackground">3.8 Custom positioning on bars/background<a class="anchor" aria-label="anchor" href="#custom-positioning-on-barsbackground"></a>
</h4>
<p>If adjusting <code>bar_number_threshold</code> is not sufficient, you
can specify custom rules for placement of text on bars/background:</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="sc">%%</span>R <span class="sc">-</span>w <span class="dv">800</span> <span class="sc">-</span>h <span class="dv">300</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>size <span class="ot">=</span> <span class="fu">get_size_mode</span>(<span class="st">'exclusive_intersection'</span>)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>    movies, genres, <span class="at">name=</span><span class="st">'genre'</span>, <span class="at">width_ratio=</span><span class="fl">0.1</span>, <span class="at">min_size=</span><span class="dv">10</span>,</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">base_annotations=</span><span class="fu">list</span>(</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Intersection size'</span><span class="ot">=</span><span class="fu">intersection_size</span>(</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">text_mapping=</span><span class="fu">aes</span>(</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">label=</span><span class="fu">paste0</span>(</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>                    <span class="sc">!!</span><span class="fu">upset_text_percentage</span>(),</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'</span><span class="sc">\n</span><span class="st">('</span>, <span class="sc">!!</span>size, <span class="st">')'</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>                ),</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>                <span class="at">colour=</span><span class="fu">ifelse</span>(<span class="sc">!!</span>size <span class="sc">&gt;</span> <span class="dv">50</span>, <span class="st">'on_bar'</span>, <span class="st">'on_background'</span>),</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">y=</span><span class="fu">ifelse</span>(<span class="sc">!!</span>size <span class="sc">&gt;</span> <span class="dv">50</span>, <span class="sc">!!</span>size <span class="sc">-</span> <span class="dv">100</span>, <span class="sc">!!</span>size)</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="Examples_Python_files/Examples_Python_89_0.png"></p>
</div>
</div>
<div class="section level3">
<h3 id="further-adjustments-using-ggplot2-functions">3.8 Further adjustments using ggplot2 functions<a class="anchor" aria-label="anchor" href="#further-adjustments-using-ggplot2-functions"></a>
</h3>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="sc">%%</span>R  <span class="sc">-</span>w <span class="dv">800</span> <span class="sc">-</span>h <span class="dv">300</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>    movies, genres, <span class="at">width_ratio=</span><span class="fl">0.1</span>,</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">base_annotations =</span> <span class="fu">list</span>(</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Intersection size'</span><span class="ot">=</span>(</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>            <span class="fu">intersection_size</span>()</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>            <span class="sc">+</span> <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">700</span>))</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>            <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">plot.background=</span><span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">'#E5D3B3'</span>))</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>            <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">'# observations in intersection'</span>)</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_size=</span><span class="dv">10</span></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="Examples_Python_files/Examples_Python_91_0.png"></p>
</div>
</div>
<div class="section level2">
<h2 id="adjusting-set-size">4. Adjusting “set size”<a class="anchor" aria-label="anchor" href="#adjusting-set-size"></a>
</h2>
<p>When using thresholding or selection criteria (such as
<code>min_size</code> or <code>n_intersections</code>) the change in
number of elements in each set size is not reflected in the set sizes
plot by default. You can change this by providing
<code>filter_intersections=TRUE</code> to
<code>upset_set_size</code>.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="sc">%%</span>R <span class="sc">-</span>w <span class="dv">800</span> <span class="sc">-</span>h <span class="dv">250</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>    movies, genres,</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_size=</span><span class="dv">200</span>,</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">set_sizes=</span><span class="fu">upset_set_size</span>()</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|</span> <span class="fu">upset</span>(</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>    movies, genres,</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_size=</span><span class="dv">200</span>,</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">set_sizes=</span><span class="fu">upset_set_size</span>(<span class="at">filter_intersections=</span><span class="cn">TRUE</span>)</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="Examples_Python_files/Examples_Python_94_0.png"></p>
<div class="section level3">
<h3 id="rotate-labels">4.1 Rotate labels<a class="anchor" aria-label="anchor" href="#rotate-labels"></a>
</h3>
<p>To rotate the labels modify corresponding theme:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="sc">%%</span>R <span class="sc">-</span>w <span class="dv">400</span> <span class="sc">-</span>h <span class="dv">300</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>    movies, genres,</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_size=</span><span class="dv">100</span>,</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">width_ratio=</span><span class="fl">0.15</span>,</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">set_sizes=</span>(</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">upset_set_size</span>()</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>        <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.text.x=</span><span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">90</span>))</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="Examples_Python_files/Examples_Python_97_0.png"></p>
<p>To display the ticks:</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="sc">%%</span>R <span class="sc">-</span>w <span class="dv">400</span> <span class="sc">-</span>h <span class="dv">300</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>    movies, genres, <span class="at">width_ratio=</span><span class="fl">0.3</span>, <span class="at">min_size=</span><span class="dv">100</span>,</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">set_sizes=</span>(</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">upset_set_size</span>()</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>        <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.ticks.x=</span><span class="fu">element_line</span>())</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="Examples_Python_files/Examples_Python_99_0.png"></p>
</div>
<div class="section level3">
<h3 id="modify-geoms-and-other-layers">4.2 Modify geoms and other layers<a class="anchor" aria-label="anchor" href="#modify-geoms-and-other-layers"></a>
</h3>
<p>Arguments of the <code>geom_bar</code> can be adjusted in
<code>upset_set_size</code>; it can use a different geom, or be replaced
with a custom list of layers altogether:</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="sc">%%</span>R <span class="sc">-</span>w <span class="dv">800</span> <span class="sc">-</span>h <span class="dv">300</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">upset</span>(</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>        movies, genres, <span class="at">width_ratio=</span><span class="fl">0.5</span>, <span class="at">max_size=</span><span class="dv">100</span>, <span class="at">min_size=</span><span class="dv">15</span>, <span class="at">wrap=</span><span class="cn">TRUE</span>,</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">set_sizes=</span><span class="fu">upset_set_size</span>(</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">geom=</span><span class="fu">geom_bar</span>(<span class="at">width=</span><span class="fl">0.4</span>)</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">upset</span>(</span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>        movies, genres, <span class="at">width_ratio=</span><span class="fl">0.5</span>, <span class="at">max_size=</span><span class="dv">100</span>, <span class="at">min_size=</span><span class="dv">15</span>, <span class="at">wrap=</span><span class="cn">TRUE</span>,</span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">set_sizes=</span><span class="fu">upset_set_size</span>(</span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">geom=</span><span class="fu">geom_point</span>(</span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>                <span class="at">stat=</span><span class="st">'count'</span>,</span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>                <span class="at">color=</span><span class="st">'blue'</span></span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span></span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">upset</span>(</span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a>        movies, genres, <span class="at">width_ratio=</span><span class="fl">0.5</span>, <span class="at">max_size=</span><span class="dv">100</span>, <span class="at">min_size=</span><span class="dv">15</span>, <span class="at">wrap=</span><span class="cn">TRUE</span>,</span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">set_sizes=</span>(</span>
<span id="cb46-24"><a href="#cb46-24" aria-hidden="true" tabindex="-1"></a>            <span class="fu">upset_set_size</span>(</span>
<span id="cb46-25"><a href="#cb46-25" aria-hidden="true" tabindex="-1"></a>                <span class="at">geom=</span><span class="fu">geom_point</span>(<span class="at">stat=</span><span class="st">'count'</span>),</span>
<span id="cb46-26"><a href="#cb46-26" aria-hidden="true" tabindex="-1"></a>                <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">y=</span>..count..<span class="sc">/</span><span class="fu">max</span>(..count..)),</span>
<span id="cb46-27"><a href="#cb46-27" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb46-28"><a href="#cb46-28" aria-hidden="true" tabindex="-1"></a>            <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">'Size relative to the largest'</span>)</span>
<span id="cb46-29"><a href="#cb46-29" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb46-30"><a href="#cb46-30" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb46-31"><a href="#cb46-31" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="Examples_Python_files/Examples_Python_102_0.png"></p>
</div>
<div class="section level3">
<h3 id="logarithmic-scale">4.3 Logarithmic scale<a class="anchor" aria-label="anchor" href="#logarithmic-scale"></a>
</h3>
<p>In order to use a log scale we need to pass additional scale to in
<code>layers</code> argument. However, as the bars are on flipped
coordinates, we need a reversed log transformation. Appropriate
function, <code><a href="../reference/reverse_log_trans.html">reverse_log_trans()</a></code> is provided:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="sc">%%</span>R <span class="sc">-</span>w <span class="dv">500</span> <span class="sc">-</span>h <span class="dv">300</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>    movies, genres,</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">width_ratio=</span><span class="fl">0.1</span>,</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_size=</span><span class="dv">10</span>,</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">set_sizes=</span>(</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">upset_set_size</span>()</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>        <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.text.x=</span><span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">90</span>))</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>        <span class="sc">+</span> <span class="fu">scale_y_continuous</span>(<span class="at">trans=</span><span class="fu">reverse_log_trans</span>())</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">queries=</span><span class="fu">list</span>(<span class="fu">upset_query</span>(<span class="at">set=</span><span class="st">'Drama'</span>, <span class="at">fill=</span><span class="st">'blue'</span>))</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="Examples_Python_files/Examples_Python_105_0.png"></p>
<p>We can also modify the labels to display the logged values:</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="sc">%%</span>R <span class="sc">-</span>w <span class="dv">500</span> <span class="sc">-</span>h <span class="dv">300</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>    movies, genres,</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_size=</span><span class="dv">10</span>,</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">width_ratio=</span><span class="fl">0.2</span>,</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">set_sizes=</span><span class="fu">upset_set_size</span>()</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>        <span class="sc">+</span> <span class="fu">scale_y_continuous</span>(</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">trans=</span><span class="fu">reverse_log_trans</span>(),</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">labels=</span>log10</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>        <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">'log10(set size)'</span>)</span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="Examples_Python_files/Examples_Python_107_0.png"></p>
</div>
<div class="section level3">
<h3 id="display-counts">4.4 Display counts<a class="anchor" aria-label="anchor" href="#display-counts"></a>
</h3>
<p>To display the count add <code><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text()</a></code>:</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="sc">%%</span>R <span class="sc">-</span>w <span class="dv">500</span> <span class="sc">-</span>h <span class="dv">300</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>    movies, genres,</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_size=</span><span class="dv">10</span>,</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">width_ratio=</span><span class="fl">0.3</span>,</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">encode_sets=</span><span class="cn">FALSE</span>,  <span class="co"># for annotate() to select the set by name disable encoding</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">set_sizes=</span>(</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">upset_set_size</span>()</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>        <span class="sc">+</span> <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>..count..), <span class="at">hjust=</span><span class="fl">1.1</span>, <span class="at">stat=</span><span class="st">'count'</span>)</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>        <span class="co"># you can also add annotations on top of bars:</span></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>        <span class="sc">+</span> <span class="fu">annotate</span>(<span class="at">geom=</span><span class="st">'text'</span>, <span class="at">label=</span><span class="st">'@'</span>, <span class="at">x=</span><span class="st">'Drama'</span>, <span class="at">y=</span><span class="dv">850</span>, <span class="at">color=</span><span class="st">'white'</span>, <span class="at">size=</span><span class="dv">3</span>)</span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>        <span class="sc">+</span> <span class="fu">expand_limits</span>(<span class="at">y=</span><span class="dv">1100</span>)</span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>        <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.text.x=</span><span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">90</span>))</span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="Examples_Python_files/Examples_Python_110_0.png"></p>
</div>
<div class="section level3">
<h3 id="change-position-and-add-fill">4.5 Change position and add fill<a class="anchor" aria-label="anchor" href="#change-position-and-add-fill"></a>
</h3>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="sc">%%</span>R <span class="sc">-</span>w <span class="dv">500</span> <span class="sc">-</span>h <span class="dv">300</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>    movies, genres,</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_size=</span><span class="dv">10</span>,</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">width_ratio=</span><span class="fl">0.3</span>,</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">set_sizes=</span>(</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">upset_set_size</span>(</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">geom=</span><span class="fu">geom_bar</span>(</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">fill=</span>mpaa, <span class="at">x=</span>group),</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>                <span class="at">width=</span><span class="fl">0.8</span></span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>            ),</span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">position=</span><span class="st">'right'</span></span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># moves legends over the set sizes</span></span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">guides=</span><span class="st">'over'</span></span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="Examples_Python_files/Examples_Python_112_0.png"></p>
</div>
<div class="section level3">
<h3 id="hide-the-set-sizes-altogether">4.6 Hide the set sizes altogether<a class="anchor" aria-label="anchor" href="#hide-the-set-sizes-altogether"></a>
</h3>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="sc">%%</span>R <span class="sc">-</span>w <span class="dv">500</span> <span class="sc">-</span>h <span class="dv">300</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>    movies, genres,</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_size=</span><span class="dv">10</span>,</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">set_sizes=</span><span class="cn">FALSE</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="Examples_Python_files/Examples_Python_114_0.png"></p>
</div>
<div class="section level3">
<h3 id="change-the-label">4.7 Change the label<a class="anchor" aria-label="anchor" href="#change-the-label"></a>
</h3>
<p>For compatibility with older <code>ggplot2</code> versions,
<code>upset_set_size</code> generates a plot with flipped coordinates
and therefore <code>ylab</code> needs to be used instead of
<code>xlab</code> (and aesthetic <code>x</code> is used in examples
above in place of <code>y</code>. This wil change it in a future major
release of <code>ComplexUpset</code>.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="sc">%%</span>R <span class="sc">-</span>w <span class="dv">400</span> <span class="sc">-</span>h <span class="dv">300</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>    movies, genres, <span class="at">width_ratio=</span><span class="fl">0.3</span>, <span class="at">min_size=</span><span class="dv">100</span>,</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">set_sizes=</span>(</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">upset_set_size</span>()</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>        <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">'MY TITLE'</span>)</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="Examples_Python_files/Examples_Python_117_0.png"></p>
</div>
</div>
<div class="section level2">
<h2 id="adjusting-other-aesthetics">5. Adjusting other aesthetics<a class="anchor" aria-label="anchor" href="#adjusting-other-aesthetics"></a>
</h2>
<div class="section level3">
<h3 id="stripes">5.1 Stripes<a class="anchor" aria-label="anchor" href="#stripes"></a>
</h3>
<p>Change the colors:</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="sc">%%</span>R <span class="sc">-</span>w <span class="dv">600</span> <span class="sc">-</span>h <span class="dv">400</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>    movies,</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>    genres,</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_size=</span><span class="dv">10</span>,</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">width_ratio=</span><span class="fl">0.2</span>,</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripes=</span><span class="fu">c</span>(<span class="st">'cornsilk1'</span>, <span class="st">'deepskyblue1'</span>)</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="Examples_Python_files/Examples_Python_121_0.png"></p>
<p>You can use multiple colors:</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="sc">%%</span>R <span class="sc">-</span>w <span class="dv">600</span> <span class="sc">-</span>h <span class="dv">400</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>    movies,</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>    genres,</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_size=</span><span class="dv">10</span>,</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">width_ratio=</span><span class="fl">0.2</span>,</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripes=</span><span class="fu">c</span>(<span class="st">'cornsilk1'</span>, <span class="st">'deepskyblue1'</span>, <span class="st">'grey90'</span>)</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="Examples_Python_files/Examples_Python_123_0.png"></p>
<p>Or, set the color to white to effectively disable the stripes:</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="sc">%%</span>R <span class="sc">-</span>w <span class="dv">600</span> <span class="sc">-</span>h <span class="dv">400</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>    movies,</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>    genres,</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_size=</span><span class="dv">10</span>,</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">width_ratio=</span><span class="fl">0.2</span>,</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripes=</span><span class="st">'white'</span></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="Examples_Python_files/Examples_Python_125_0.png"></p>
<p>Advanced customization using <code><a href="../reference/upset_stripes.html">upset_stripes()</a></code>:</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="sc">%%</span>R <span class="sc">-</span>w <span class="dv">600</span> <span class="sc">-</span>h <span class="dv">400</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>    movies,</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>    genres,</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_size=</span><span class="dv">10</span>,</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">width_ratio=</span><span class="fl">0.2</span>,</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripes=</span><span class="fu">upset_stripes</span>(</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">geom=</span><span class="fu">geom_segment</span>(<span class="at">size=</span><span class="dv">5</span>),</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">colors=</span><span class="fu">c</span>(<span class="st">'cornsilk1'</span>, <span class="st">'deepskyblue1'</span>, <span class="st">'grey90'</span>)</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="Examples_Python_files/Examples_Python_127_0.png"></p>
<p>Mapping stripes attributes to data using
<code><a href="../reference/upset_stripes.html">upset_stripes()</a></code>:</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="sc">%%</span>R <span class="sc">-</span>w <span class="dv">600</span> <span class="sc">-</span>h <span class="dv">400</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>genre_metadata <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">set=</span><span class="fu">c</span>(<span class="st">'Action'</span>, <span class="st">'Animation'</span>, <span class="st">'Comedy'</span>, <span class="st">'Drama'</span>, <span class="st">'Documentary'</span>, <span class="st">'Romance'</span>, <span class="st">'Short'</span>),</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">shown_in_our_cinema=</span><span class="fu">c</span>(<span class="st">'no'</span>, <span class="st">'no'</span>, <span class="st">'on weekends'</span>, <span class="st">'yes'</span>, <span class="st">'yes'</span>, <span class="st">'on weekends'</span>, <span class="st">'no'</span>)</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>    movies,</span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>    genres,</span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_size=</span><span class="dv">10</span>,</span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">width_ratio=</span><span class="fl">0.2</span>,</span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripes=</span><span class="fu">upset_stripes</span>(</span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">color=</span>shown_in_our_cinema),</span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">colors=</span><span class="fu">c</span>(</span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a>            <span class="st">'yes'</span><span class="ot">=</span><span class="st">'green'</span>,</span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a>            <span class="st">'no'</span><span class="ot">=</span><span class="st">'red'</span>,</span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a>            <span class="st">'on weekends'</span><span class="ot">=</span><span class="st">'orange'</span></span>
<span id="cb57-18"><a href="#cb57-18" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb57-19"><a href="#cb57-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">data=</span>genre_metadata</span>
<span id="cb57-20"><a href="#cb57-20" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb57-21"><a href="#cb57-21" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="Examples_Python_files/Examples_Python_129_0.png"></p>
</div>
<div class="section level3">
<h3 id="adding-title">5.2 Adding title<a class="anchor" aria-label="anchor" href="#adding-title"></a>
</h3>
<p>Adding title with <code>ggtitle</code> with add it to the
intersection matrix:</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="sc">%%</span>R <span class="sc">-</span>w <span class="dv">600</span> <span class="sc">-</span>h <span class="dv">400</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(movies, genres, <span class="at">min_size=</span><span class="dv">10</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">'Intersection matrix title'</span>)</span></code></pre></div>
<p><img src="Examples_Python_files/Examples_Python_132_0.png"></p>
<p>In order to add a title for the entire plot, you need to wrap the
plot:</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="sc">%%</span>R <span class="sc">-</span>w <span class="dv">600</span> <span class="sc">-</span>h <span class="dv">400</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(movies, genres, <span class="at">min_size=</span><span class="dv">10</span>, <span class="at">wrap=</span><span class="cn">TRUE</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">'The overlap between genres'</span>)</span></code></pre></div>
<p><img src="Examples_Python_files/Examples_Python_134_0.png"></p>
</div>
<div class="section level3">
<h3 id="making-the-plot-transparent">5.3 Making the plot transparent<a class="anchor" aria-label="anchor" href="#making-the-plot-transparent"></a>
</h3>
<p>You need to set the plot background to transparent and adjust colors
of stripes to your liking:</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="sc">%%</span>R <span class="sc">-</span>w <span class="dv">600</span> <span class="sc">-</span>h <span class="dv">400</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">upset</span>(</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>        movies, genres, <span class="at">name=</span><span class="st">'genre'</span>, <span class="at">width_ratio=</span><span class="fl">0.1</span>, <span class="at">min_size=</span><span class="dv">10</span>,</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">stripes=</span><span class="fu">c</span>(<span class="fu">alpha</span>(<span class="st">'grey90'</span>, <span class="fl">0.45</span>), <span class="fu">alpha</span>(<span class="st">'white'</span>, <span class="fl">0.3</span>))</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>    <span class="sc">&amp;</span> <span class="fu">theme</span>(<span class="at">plot.background=</span><span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">'transparent'</span>, <span class="at">color=</span><span class="cn">NA</span>))</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="Examples_Python_files/Examples_Python_137_0.png"></p>
<p>Use <code>ggsave('upset.png', bg="transparent")</code> when exporting
to PNG.</p>
</div>
<div class="section level3">
<h3 id="adjusting-the-intersection-matrix">5.4 Adjusting the intersection matrix<a class="anchor" aria-label="anchor" href="#adjusting-the-intersection-matrix"></a>
</h3>
<p>Use <code><a href="../reference/intersection_matrix.html">intersection_matrix()</a></code> to modify the matrix
parameters:</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="sc">%%</span>R <span class="sc">-</span>w <span class="dv">800</span> <span class="sc">-</span>h <span class="dv">400</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>    movies, genres, <span class="at">name=</span><span class="st">'genre'</span>, <span class="at">min_size=</span><span class="dv">10</span>,</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">encode_sets=</span><span class="cn">FALSE</span>,  <span class="co"># for annotate() to select the set by name disable encoding</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">matrix=</span>(</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">intersection_matrix</span>(</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">geom=</span><span class="fu">geom_point</span>(</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">shape=</span><span class="st">'square'</span>,</span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">size=</span><span class="fl">3.5</span></span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>            ),</span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">segment=</span><span class="fu">geom_segment</span>(</span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>                <span class="at">linetype=</span><span class="st">'dotted'</span></span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>            ),</span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">outline_color=</span><span class="fu">list</span>(</span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a>                <span class="at">active=</span><span class="st">'darkorange3'</span>,</span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a>                <span class="at">inactive=</span><span class="st">'grey70'</span></span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb61-19"><a href="#cb61-19" aria-hidden="true" tabindex="-1"></a>        <span class="sc">+</span> <span class="fu">scale_color_manual</span>(</span>
<span id="cb61-20"><a href="#cb61-20" aria-hidden="true" tabindex="-1"></a>            <span class="at">values=</span><span class="fu">c</span>(<span class="st">'TRUE'</span><span class="ot">=</span><span class="st">'orange'</span>, <span class="st">'FALSE'</span><span class="ot">=</span><span class="st">'grey'</span>),</span>
<span id="cb61-21"><a href="#cb61-21" aria-hidden="true" tabindex="-1"></a>            <span class="at">labels=</span><span class="fu">c</span>(<span class="st">'TRUE'</span><span class="ot">=</span><span class="st">'yes'</span>, <span class="st">'FALSE'</span><span class="ot">=</span><span class="st">'no'</span>),</span>
<span id="cb61-22"><a href="#cb61-22" aria-hidden="true" tabindex="-1"></a>            <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">'TRUE'</span>, <span class="st">'FALSE'</span>),</span>
<span id="cb61-23"><a href="#cb61-23" aria-hidden="true" tabindex="-1"></a>            <span class="at">name=</span><span class="st">'Is intersection member?'</span></span>
<span id="cb61-24"><a href="#cb61-24" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb61-25"><a href="#cb61-25" aria-hidden="true" tabindex="-1"></a>        <span class="sc">+</span> <span class="fu">scale_y_discrete</span>(</span>
<span id="cb61-26"><a href="#cb61-26" aria-hidden="true" tabindex="-1"></a>            <span class="at">position=</span><span class="st">'right'</span></span>
<span id="cb61-27"><a href="#cb61-27" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb61-28"><a href="#cb61-28" aria-hidden="true" tabindex="-1"></a>        <span class="sc">+</span> <span class="fu">annotate</span>(</span>
<span id="cb61-29"><a href="#cb61-29" aria-hidden="true" tabindex="-1"></a>            <span class="at">geom=</span><span class="st">'text'</span>,</span>
<span id="cb61-30"><a href="#cb61-30" aria-hidden="true" tabindex="-1"></a>            <span class="at">label=</span><span class="st">'Look here →'</span>,</span>
<span id="cb61-31"><a href="#cb61-31" aria-hidden="true" tabindex="-1"></a>            <span class="at">x=</span><span class="st">'Comedy-Drama'</span>,</span>
<span id="cb61-32"><a href="#cb61-32" aria-hidden="true" tabindex="-1"></a>            <span class="at">y=</span><span class="st">'Drama'</span>,</span>
<span id="cb61-33"><a href="#cb61-33" aria-hidden="true" tabindex="-1"></a>            <span class="at">size=</span><span class="dv">5</span>,</span>
<span id="cb61-34"><a href="#cb61-34" aria-hidden="true" tabindex="-1"></a>            <span class="at">hjust=</span><span class="dv">1</span></span>
<span id="cb61-35"><a href="#cb61-35" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb61-36"><a href="#cb61-36" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb61-37"><a href="#cb61-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">queries=</span><span class="fu">list</span>(</span>
<span id="cb61-38"><a href="#cb61-38" aria-hidden="true" tabindex="-1"></a>        <span class="fu">upset_query</span>(</span>
<span id="cb61-39"><a href="#cb61-39" aria-hidden="true" tabindex="-1"></a>            <span class="at">intersect=</span><span class="fu">c</span>(<span class="st">'Drama'</span>, <span class="st">'Comedy'</span>),</span>
<span id="cb61-40"><a href="#cb61-40" aria-hidden="true" tabindex="-1"></a>            <span class="at">color=</span><span class="st">'red'</span>,</span>
<span id="cb61-41"><a href="#cb61-41" aria-hidden="true" tabindex="-1"></a>            <span class="at">fill=</span><span class="st">'red'</span>,</span>
<span id="cb61-42"><a href="#cb61-42" aria-hidden="true" tabindex="-1"></a>            <span class="at">only_components=</span><span class="fu">c</span>(<span class="st">'intersections_matrix'</span>, <span class="st">'Intersection size'</span>)</span>
<span id="cb61-43"><a href="#cb61-43" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb61-44"><a href="#cb61-44" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb61-45"><a href="#cb61-45" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="Examples_Python_files/Examples_Python_141_0.png"></p>
</div>
</div>
<div class="section level2">
<h2 id="themes">6. Themes<a class="anchor" aria-label="anchor" href="#themes"></a>
</h2>
<p>The themes for specific components are defined in
<code>upset_themes</code> list, which contains themes for:</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="sc">%%</span>R</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(upset_themes)</span></code></pre></div>
<pre><code>[1] "intersections_matrix" "Intersection size"    "overall_sizes"       
[4] "default"             </code></pre>
<p>You can substitute this list for your own using <code>themes</code>
argument. While you can specify a theme for every component, if you omit
one or more components those will be taken from the element named
<code>default</code>.</p>
<div class="section level3">
<h3 id="substituting-themes">6.1 Substituting themes<a class="anchor" aria-label="anchor" href="#substituting-themes"></a>
</h3>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="sc">%%</span>R <span class="sc">-</span>w <span class="dv">800</span> <span class="sc">-</span>h <span class="dv">400</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(movies, genres, <span class="at">min_size=</span><span class="dv">10</span>, <span class="at">themes=</span><span class="fu">list</span>(<span class="at">default=</span><span class="fu">theme</span>()))</span></code></pre></div>
<p><img src="Examples_Python_files/Examples_Python_147_0.png"></p>
<p>You can also add themes for your custom panels/annotations:</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="sc">%%</span>R <span class="sc">-</span>w <span class="dv">800</span> <span class="sc">-</span>h <span class="dv">800</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>    movies,</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>    genres,</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">annotations =</span> <span class="fu">list</span>(</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Length'</span><span class="ot">=</span><span class="fu">list</span>(</span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">aes=</span><span class="fu">aes</span>(<span class="at">x=</span>intersection, <span class="at">y=</span>length),</span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">geom=</span><span class="fu">geom_boxplot</span>(<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Rating'</span><span class="ot">=</span><span class="fu">list</span>(</span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">aes=</span><span class="fu">aes</span>(<span class="at">x=</span>intersection, <span class="at">y=</span>rating),</span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">geom=</span><span class="fu">list</span>(</span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a>                <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">color=</span><span class="fu">log10</span>(votes)), <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a>                <span class="fu">geom_violin</span>(<span class="at">alpha=</span><span class="fl">0.5</span>, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb65-16"><a href="#cb65-16" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb65-17"><a href="#cb65-17" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb65-18"><a href="#cb65-18" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb65-19"><a href="#cb65-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_size=</span><span class="dv">10</span>,</span>
<span id="cb65-20"><a href="#cb65-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">width_ratio=</span><span class="fl">0.1</span>,</span>
<span id="cb65-21"><a href="#cb65-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">themes=</span><span class="fu">modifyList</span>(</span>
<span id="cb65-22"><a href="#cb65-22" aria-hidden="true" tabindex="-1"></a>        upset_themes,</span>
<span id="cb65-23"><a href="#cb65-23" aria-hidden="true" tabindex="-1"></a>        <span class="fu">list</span>(<span class="at">Rating=</span><span class="fu">theme_void</span>(), <span class="at">Length=</span><span class="fu">theme</span>())</span>
<span id="cb65-24"><a href="#cb65-24" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb65-25"><a href="#cb65-25" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="Examples_Python_files/Examples_Python_149_0.png"></p>
</div>
<div class="section level3">
<h3 id="adjusting-the-default-themes">6.2 Adjusting the default themes<a class="anchor" aria-label="anchor" href="#adjusting-the-default-themes"></a>
</h3>
<p>Modify all the default themes as once with
<code><a href="../reference/upset_default_themes.html">upset_default_themes()</a></code>:</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="sc">%%</span>R <span class="sc">-</span>w <span class="dv">800</span> <span class="sc">-</span>h <span class="dv">400</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>    movies, genres, <span class="at">min_size=</span><span class="dv">10</span>, <span class="at">width_ratio=</span><span class="fl">0.1</span>,</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">themes=</span><span class="fu">upset_default_themes</span>(<span class="at">text=</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">'red'</span>))</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="Examples_Python_files/Examples_Python_152_0.png"></p>
<p>To modify only a subset of default themes use
<code><a href="../reference/upset_modify_themes.html">upset_modify_themes()</a></code>:</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="sc">%%</span>R <span class="sc">-</span>w <span class="dv">800</span> <span class="sc">-</span>h <span class="dv">400</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>    movies, genres,</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">base_annotations=</span><span class="fu">list</span>(<span class="st">'Intersection size'</span><span class="ot">=</span><span class="fu">intersection_size</span>(<span class="at">counts=</span><span class="cn">FALSE</span>)),</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_size=</span><span class="dv">100</span>,</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">width_ratio=</span><span class="fl">0.1</span>,</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">themes=</span><span class="fu">upset_modify_themes</span>(</span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">list</span>(</span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>            <span class="st">'intersections_matrix'</span><span class="ot">=</span><span class="fu">theme</span>(<span class="at">text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">20</span>)),</span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>            <span class="st">'overall_sizes'</span><span class="ot">=</span><span class="fu">theme</span>(<span class="at">axis.text.x=</span><span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">90</span>))</span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="Examples_Python_files/Examples_Python_154_0.png"></p>
</div>
</div>
<div class="section level2">
<h2 id="highlighting-queries">7. Highlighting (queries)<a class="anchor" aria-label="anchor" href="#highlighting-queries"></a>
</h2>
<p>Pass a list of lists generated with <code><a href="../reference/upset_query.html">upset_query()</a></code>
utility to the optional <code>queries</code> argument to selectively
modify aesthetics of specific intersections or sets.</p>
<p>Use one of the arguments: <code>set</code> or <code>intersect</code>
(not both) to specify what to highlight: - <code>set</code> will
highlight the bar of the set size, - <code>intersect</code> will
highlight an intersection on all components (by default), or on
components chosen with <code>only_components</code> - all other
parameters will be used to modify the geoms</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="sc">%%</span>R <span class="sc">-</span>w <span class="dv">800</span> <span class="sc">-</span>h <span class="dv">600</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>    movies, genres, <span class="at">name=</span><span class="st">'genre'</span>, <span class="at">width_ratio=</span><span class="fl">0.1</span>, <span class="at">min_size=</span><span class="dv">10</span>,</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">annotations =</span> <span class="fu">list</span>(</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Length'</span><span class="ot">=</span><span class="fu">list</span>(</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">aes=</span><span class="fu">aes</span>(<span class="at">x=</span>intersection, <span class="at">y=</span>length),</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">geom=</span><span class="fu">geom_boxplot</span>(<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">queries=</span><span class="fu">list</span>(</span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>        <span class="fu">upset_query</span>(</span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">intersect=</span><span class="fu">c</span>(<span class="st">'Drama'</span>, <span class="st">'Comedy'</span>),</span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">color=</span><span class="st">'red'</span>,</span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">fill=</span><span class="st">'red'</span>,</span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">only_components=</span><span class="fu">c</span>(<span class="st">'intersections_matrix'</span>, <span class="st">'Intersection size'</span>)</span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb68-18"><a href="#cb68-18" aria-hidden="true" tabindex="-1"></a>        <span class="fu">upset_query</span>(</span>
<span id="cb68-19"><a href="#cb68-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">set=</span><span class="st">'Drama'</span>,</span>
<span id="cb68-20"><a href="#cb68-20" aria-hidden="true" tabindex="-1"></a>            <span class="at">fill=</span><span class="st">'blue'</span></span>
<span id="cb68-21"><a href="#cb68-21" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb68-22"><a href="#cb68-22" aria-hidden="true" tabindex="-1"></a>        <span class="fu">upset_query</span>(</span>
<span id="cb68-23"><a href="#cb68-23" aria-hidden="true" tabindex="-1"></a>            <span class="at">intersect=</span><span class="fu">c</span>(<span class="st">'Romance'</span>, <span class="st">'Comedy'</span>),</span>
<span id="cb68-24"><a href="#cb68-24" aria-hidden="true" tabindex="-1"></a>            <span class="at">fill=</span><span class="st">'yellow'</span>,</span>
<span id="cb68-25"><a href="#cb68-25" aria-hidden="true" tabindex="-1"></a>            <span class="at">only_components=</span><span class="fu">c</span>(<span class="st">'Length'</span>)</span>
<span id="cb68-26"><a href="#cb68-26" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb68-27"><a href="#cb68-27" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb68-28"><a href="#cb68-28" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="Examples_Python_files/Examples_Python_157_0.png"></p>
</div>
<div class="section level2">
<h2 id="sorting">8. Sorting<a class="anchor" aria-label="anchor" href="#sorting"></a>
</h2>
<div class="section level3">
<h3 id="sorting-intersections">8.1 Sorting intersections<a class="anchor" aria-label="anchor" href="#sorting-intersections"></a>
</h3>
<p>By degree:</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="sc">%%</span>R <span class="sc">-</span>w <span class="dv">800</span> <span class="sc">-</span>h <span class="dv">300</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(movies, genres, <span class="at">width_ratio=</span><span class="fl">0.1</span>, <span class="at">sort_intersections_by=</span><span class="st">'degree'</span>)</span></code></pre></div>
<p><img src="Examples_Python_files/Examples_Python_161_0.png"></p>
<p>By ratio:</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="sc">%%</span>R <span class="sc">-</span>w <span class="dv">800</span> <span class="sc">-</span>h <span class="dv">400</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>    movies, genres, <span class="at">name=</span><span class="st">'genre'</span>, <span class="at">width_ratio=</span><span class="fl">0.1</span>, <span class="at">min_size=</span><span class="dv">10</span>,</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">sort_intersections_by=</span><span class="st">'ratio'</span>,</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">base_annotations=</span><span class="fu">list</span>(</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Intersection size'</span><span class="ot">=</span><span class="fu">intersection_size</span>(<span class="at">text_mapping=</span><span class="fu">aes</span>(<span class="at">label=</span><span class="sc">!!</span><span class="fu">upset_text_percentage</span>())),</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Intersection ratio'</span><span class="ot">=</span><span class="fu">intersection_ratio</span>(<span class="at">text_mapping=</span><span class="fu">aes</span>(<span class="at">label=</span><span class="sc">!!</span><span class="fu">upset_text_percentage</span>()))</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="Examples_Python_files/Examples_Python_163_0.png"></p>
<p>The other way around:</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="sc">%%</span>R <span class="sc">-</span>w <span class="dv">800</span> <span class="sc">-</span>h <span class="dv">300</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(movies, genres, <span class="at">width_ratio=</span><span class="fl">0.1</span>, <span class="at">sort_intersections=</span><span class="st">'ascending'</span>)</span></code></pre></div>
<p><img src="Examples_Python_files/Examples_Python_165_0.png"></p>
<p>Without any sorting:</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="sc">%%</span>R <span class="sc">-</span>w <span class="dv">800</span> <span class="sc">-</span>h <span class="dv">300</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(movies, genres, <span class="at">width_ratio=</span><span class="fl">0.1</span>, <span class="at">sort_intersections=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="Examples_Python_files/Examples_Python_167_0.png"></p>
<p>First by degree then by cardinality:</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="sc">%%</span>R <span class="sc">-</span>w <span class="dv">800</span> <span class="sc">-</span>h <span class="dv">300</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(movies, genres, <span class="at">width_ratio=</span><span class="fl">0.1</span>, <span class="at">sort_intersections_by=</span><span class="fu">c</span>(<span class="st">'degree'</span>, <span class="st">'cardinality'</span>))</span></code></pre></div>
<p><img src="Examples_Python_files/Examples_Python_169_0.png"></p>
<p>User-specified order:</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="sc">%%</span>R <span class="sc">-</span>w <span class="dv">600</span> <span class="sc">-</span>h <span class="dv">300</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>    movies,</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>    genres,</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">width_ratio=</span><span class="fl">0.1</span>,</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">sort_intersections=</span><span class="cn">FALSE</span>,</span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">intersections=</span><span class="fu">list</span>(</span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Comedy'</span>,</span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Drama'</span>,</span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(<span class="st">'Comedy'</span>, <span class="st">'Romance'</span>),</span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(<span class="st">'Romance'</span>, <span class="st">'Drama'</span>),</span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Outside of known sets'</span>,</span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Action'</span></span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb74-15"><a href="#cb74-15" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="Examples_Python_files/Examples_Python_171_0.png"></p>
</div>
<div class="section level3">
<h3 id="sorting-sets">8.2 Sorting sets<a class="anchor" aria-label="anchor" href="#sorting-sets"></a>
</h3>
<p>Ascending:</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="sc">%%</span>R <span class="sc">-</span>w <span class="dv">800</span> <span class="sc">-</span>h <span class="dv">300</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(movies, genres, <span class="at">width_ratio=</span><span class="fl">0.1</span>, <span class="at">sort_sets=</span><span class="st">'ascending'</span>)</span></code></pre></div>
<p><img src="Examples_Python_files/Examples_Python_174_0.png"></p>
<p>Without sorting - preserving the order as in genres:</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>genres</span></code></pre></div>
<pre><code>['Action', 'Animation', 'Comedy', 'Drama', 'Documentary', 'Romance', 'Short']</code></pre>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="sc">%%</span>R <span class="sc">-</span>w <span class="dv">800</span> <span class="sc">-</span>h <span class="dv">300</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(movies, genres, <span class="at">width_ratio=</span><span class="fl">0.1</span>, <span class="at">sort_sets=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="Examples_Python_files/Examples_Python_177_0.png"></p>
</div>
</div>
<div class="section level2">
<h2 id="grouping">9. Grouping<a class="anchor" aria-label="anchor" href="#grouping"></a>
</h2>
<div class="section level3">
<h3 id="grouping-intersections">9.1 Grouping intersections<a class="anchor" aria-label="anchor" href="#grouping-intersections"></a>
</h3>
<p>Use <code>group_by='sets'</code> to group intersections by set. If
needed, the intersections will be repeated so that they appear in each
set group. Use <code><a href="../reference/upset_query.html">upset_query()</a></code> with <code>group</code>
argument to color the intersection matrix accordingly.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="sc">%%</span>R <span class="sc">-</span>w <span class="dv">800</span> <span class="sc">-</span>h <span class="dv">300</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>    movies, <span class="fu">c</span>(<span class="st">"Action"</span>, <span class="st">"Comedy"</span>, <span class="st">"Drama"</span>),</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">width_ratio=</span><span class="fl">0.2</span>,</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">group_by=</span><span class="st">'sets'</span>,</span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">queries=</span><span class="fu">list</span>(</span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">upset_query</span>(</span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">intersect=</span><span class="fu">c</span>(<span class="st">'Drama'</span>, <span class="st">'Comedy'</span>),</span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">color=</span><span class="st">'red'</span>,</span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">fill=</span><span class="st">'red'</span>,</span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">only_components=</span><span class="fu">c</span>(<span class="st">'intersections_matrix'</span>, <span class="st">'Intersection size'</span>)</span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a>        <span class="fu">upset_query</span>(<span class="at">group=</span><span class="st">'Drama'</span>, <span class="at">color=</span><span class="st">'blue'</span>),</span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a>        <span class="fu">upset_query</span>(<span class="at">group=</span><span class="st">'Comedy'</span>, <span class="at">color=</span><span class="st">'orange'</span>),</span>
<span id="cb79-16"><a href="#cb79-16" aria-hidden="true" tabindex="-1"></a>        <span class="fu">upset_query</span>(<span class="at">group=</span><span class="st">'Action'</span>, <span class="at">color=</span><span class="st">'purple'</span>),</span>
<span id="cb79-17"><a href="#cb79-17" aria-hidden="true" tabindex="-1"></a>        <span class="fu">upset_query</span>(<span class="at">set=</span><span class="st">'Drama'</span>, <span class="at">fill=</span><span class="st">'blue'</span>),</span>
<span id="cb79-18"><a href="#cb79-18" aria-hidden="true" tabindex="-1"></a>        <span class="fu">upset_query</span>(<span class="at">set=</span><span class="st">'Comedy'</span>, <span class="at">fill=</span><span class="st">'orange'</span>),</span>
<span id="cb79-19"><a href="#cb79-19" aria-hidden="true" tabindex="-1"></a>        <span class="fu">upset_query</span>(<span class="at">set=</span><span class="st">'Action'</span>, <span class="at">fill=</span><span class="st">'purple'</span>)</span>
<span id="cb79-20"><a href="#cb79-20" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb79-21"><a href="#cb79-21" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="Examples_Python_files/Examples_Python_181_0.png"></p>
</div>
</div>
<div class="section level2">
<h2 id="display-percentages">10. Display percentages<a class="anchor" aria-label="anchor" href="#display-percentages"></a>
</h2>
<p>Use <code><a href="../reference/aes_percentage.html">aes_percentage()</a></code> utility preceded with
<code>!!</code> syntax to easily display percentages. In the examples
below only percentages for the movies with R rating are shown to avoid
visual clutter.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="sc">%%</span>R</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>rating_scale <span class="ot">=</span> <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'R'</span><span class="ot">=</span><span class="st">'#E41A1C'</span>, <span class="st">'PG'</span><span class="ot">=</span><span class="st">'#377EB8'</span>,</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'PG-13'</span><span class="ot">=</span><span class="st">'#4DAF4A'</span>, <span class="st">'NC-17'</span><span class="ot">=</span><span class="st">'#FF7F00'</span></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>show_hide_scale <span class="ot">=</span> <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">'show'</span><span class="ot">=</span><span class="st">'black'</span>, <span class="st">'hide'</span><span class="ot">=</span><span class="st">'transparent'</span>), <span class="at">guide=</span><span class="st">'none'</span>)</span></code></pre></div>
<div class="section level3">
<h3 id="within-intersection">10.1 Within intersection<a class="anchor" aria-label="anchor" href="#within-intersection"></a>
</h3>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="sc">%%</span>R <span class="sc">-</span>w <span class="dv">800</span> <span class="sc">-</span>h <span class="dv">500</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>    movies, genres, <span class="at">name=</span><span class="st">'genre'</span>, <span class="at">width_ratio=</span><span class="fl">0.1</span>, <span class="at">min_size=</span><span class="dv">100</span>,</span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">annotations =</span><span class="fu">list</span>(</span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">'MPAA Rating'</span><span class="ot">=</span><span class="fu">list</span>(</span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">aes=</span><span class="fu">aes</span>(<span class="at">x=</span>intersection, <span class="at">fill=</span>mpaa),</span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">geom=</span><span class="fu">list</span>(</span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>                <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'count'</span>, <span class="at">position=</span><span class="st">'fill'</span>, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a>                <span class="fu">geom_text</span>(</span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">aes</span>(</span>
<span id="cb81-12"><a href="#cb81-12" aria-hidden="true" tabindex="-1"></a>                        <span class="at">label=</span><span class="sc">!!</span><span class="fu">aes_percentage</span>(<span class="at">relative_to=</span><span class="st">'intersection'</span>),</span>
<span id="cb81-13"><a href="#cb81-13" aria-hidden="true" tabindex="-1"></a>                        <span class="at">color=</span><span class="fu">ifelse</span>(mpaa <span class="sc">==</span> <span class="st">'R'</span>, <span class="st">'show'</span>, <span class="st">'hide'</span>)</span>
<span id="cb81-14"><a href="#cb81-14" aria-hidden="true" tabindex="-1"></a>                    ),</span>
<span id="cb81-15"><a href="#cb81-15" aria-hidden="true" tabindex="-1"></a>                    <span class="at">stat=</span><span class="st">'count'</span>,</span>
<span id="cb81-16"><a href="#cb81-16" aria-hidden="true" tabindex="-1"></a>                    <span class="at">position=</span><span class="fu">position_fill</span>(<span class="at">vjust =</span> .<span class="dv">5</span>)</span>
<span id="cb81-17"><a href="#cb81-17" aria-hidden="true" tabindex="-1"></a>                ),</span>
<span id="cb81-18"><a href="#cb81-18" aria-hidden="true" tabindex="-1"></a>                <span class="fu">scale_y_continuous</span>(<span class="at">labels=</span>scales<span class="sc">::</span><span class="fu">percent_format</span>()),</span>
<span id="cb81-19"><a href="#cb81-19" aria-hidden="true" tabindex="-1"></a>                show_hide_scale,</span>
<span id="cb81-20"><a href="#cb81-20" aria-hidden="true" tabindex="-1"></a>                rating_scale</span>
<span id="cb81-21"><a href="#cb81-21" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb81-22"><a href="#cb81-22" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb81-23"><a href="#cb81-23" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb81-24"><a href="#cb81-24" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="Examples_Python_files/Examples_Python_186_0.png"></p>
</div>
<div class="section level3">
<h3 id="relative-to-the-group">10.2 Relative to the group<a class="anchor" aria-label="anchor" href="#relative-to-the-group"></a>
</h3>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="sc">%%</span>R <span class="sc">-</span>w <span class="dv">800</span> <span class="sc">-</span>h <span class="dv">500</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>    movies, genres, <span class="at">name=</span><span class="st">'genre'</span>, <span class="at">width_ratio=</span><span class="fl">0.1</span>, <span class="at">min_size=</span><span class="dv">100</span>,</span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">annotations =</span><span class="fu">list</span>(</span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">'MPAA Rating'</span><span class="ot">=</span><span class="fu">list</span>(</span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">aes=</span><span class="fu">aes</span>(<span class="at">x=</span>intersection, <span class="at">fill=</span>mpaa),</span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">geom=</span><span class="fu">list</span>(</span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>                <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'count'</span>, <span class="at">position=</span><span class="st">'fill'</span>, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a>                <span class="fu">geom_text</span>(</span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">aes</span>(</span>
<span id="cb82-12"><a href="#cb82-12" aria-hidden="true" tabindex="-1"></a>                        <span class="at">label=</span><span class="sc">!!</span><span class="fu">aes_percentage</span>(<span class="at">relative_to=</span><span class="st">'group'</span>),</span>
<span id="cb82-13"><a href="#cb82-13" aria-hidden="true" tabindex="-1"></a>                        <span class="at">group=</span>mpaa,</span>
<span id="cb82-14"><a href="#cb82-14" aria-hidden="true" tabindex="-1"></a>                        <span class="at">color=</span><span class="fu">ifelse</span>(mpaa <span class="sc">==</span> <span class="st">'R'</span>, <span class="st">'show'</span>, <span class="st">'hide'</span>)</span>
<span id="cb82-15"><a href="#cb82-15" aria-hidden="true" tabindex="-1"></a>                    ),</span>
<span id="cb82-16"><a href="#cb82-16" aria-hidden="true" tabindex="-1"></a>                    <span class="at">stat=</span><span class="st">'count'</span>,</span>
<span id="cb82-17"><a href="#cb82-17" aria-hidden="true" tabindex="-1"></a>                    <span class="at">position=</span><span class="fu">position_fill</span>(<span class="at">vjust =</span> .<span class="dv">5</span>)</span>
<span id="cb82-18"><a href="#cb82-18" aria-hidden="true" tabindex="-1"></a>                ),</span>
<span id="cb82-19"><a href="#cb82-19" aria-hidden="true" tabindex="-1"></a>                <span class="fu">scale_y_continuous</span>(<span class="at">labels=</span>scales<span class="sc">::</span><span class="fu">percent_format</span>()),</span>
<span id="cb82-20"><a href="#cb82-20" aria-hidden="true" tabindex="-1"></a>                show_hide_scale,</span>
<span id="cb82-21"><a href="#cb82-21" aria-hidden="true" tabindex="-1"></a>                rating_scale</span>
<span id="cb82-22"><a href="#cb82-22" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb82-23"><a href="#cb82-23" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb82-24"><a href="#cb82-24" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb82-25"><a href="#cb82-25" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="Examples_Python_files/Examples_Python_188_0.png"></p>
</div>
<div class="section level3">
<h3 id="relative-to-all-observed-values">10.3 Relative to all observed values<a class="anchor" aria-label="anchor" href="#relative-to-all-observed-values"></a>
</h3>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="sc">%%</span>R <span class="sc">-</span>w <span class="dv">800</span> <span class="sc">-</span>h <span class="dv">500</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>    movies, genres, <span class="at">name=</span><span class="st">'genre'</span>, <span class="at">width_ratio=</span><span class="fl">0.1</span>, <span class="at">min_size=</span><span class="dv">100</span>,</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">annotations =</span><span class="fu">list</span>(</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">'MPAA Rating'</span><span class="ot">=</span><span class="fu">list</span>(</span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">aes=</span><span class="fu">aes</span>(<span class="at">x=</span>intersection, <span class="at">fill=</span>mpaa),</span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">geom=</span><span class="fu">list</span>(</span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a>                <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'count'</span>, <span class="at">position=</span><span class="st">'fill'</span>, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a>                <span class="fu">geom_text</span>(</span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">aes</span>(</span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true" tabindex="-1"></a>                        <span class="at">label=</span><span class="sc">!!</span><span class="fu">aes_percentage</span>(<span class="at">relative_to=</span><span class="st">'all'</span>),</span>
<span id="cb83-13"><a href="#cb83-13" aria-hidden="true" tabindex="-1"></a>                        <span class="at">color=</span><span class="fu">ifelse</span>(mpaa <span class="sc">==</span> <span class="st">'R'</span>, <span class="st">'show'</span>, <span class="st">'hide'</span>)</span>
<span id="cb83-14"><a href="#cb83-14" aria-hidden="true" tabindex="-1"></a>                    ),</span>
<span id="cb83-15"><a href="#cb83-15" aria-hidden="true" tabindex="-1"></a>                    <span class="at">stat=</span><span class="st">'count'</span>,</span>
<span id="cb83-16"><a href="#cb83-16" aria-hidden="true" tabindex="-1"></a>                    <span class="at">position=</span><span class="fu">position_fill</span>(<span class="at">vjust =</span> .<span class="dv">5</span>)</span>
<span id="cb83-17"><a href="#cb83-17" aria-hidden="true" tabindex="-1"></a>                ),</span>
<span id="cb83-18"><a href="#cb83-18" aria-hidden="true" tabindex="-1"></a>                <span class="fu">scale_y_continuous</span>(<span class="at">labels=</span>scales<span class="sc">::</span><span class="fu">percent_format</span>()),</span>
<span id="cb83-19"><a href="#cb83-19" aria-hidden="true" tabindex="-1"></a>                show_hide_scale,</span>
<span id="cb83-20"><a href="#cb83-20" aria-hidden="true" tabindex="-1"></a>                rating_scale</span>
<span id="cb83-21"><a href="#cb83-21" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb83-22"><a href="#cb83-22" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb83-23"><a href="#cb83-23" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb83-24"><a href="#cb83-24" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="Examples_Python_files/Examples_Python_190_0.png"></p>
</div>
</div>
<div class="section level2">
<h2 id="advanced-usage-examples">11. Advanced usage examples<a class="anchor" aria-label="anchor" href="#advanced-usage-examples"></a>
</h2>
<div class="section level3">
<h3 id="display-text-on-some-bars-only">11.1 Display text on some bars only<a class="anchor" aria-label="anchor" href="#display-text-on-some-bars-only"></a>
</h3>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="sc">%%</span>R <span class="sc">-</span>w <span class="dv">800</span> <span class="sc">-</span>h <span class="dv">500</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>    movies, genres, <span class="at">name=</span><span class="st">'genre'</span>, <span class="at">width_ratio=</span><span class="fl">0.1</span>, <span class="at">min_size=</span><span class="dv">100</span>,</span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">annotations =</span><span class="fu">list</span>(</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">'MPAA Rating'</span><span class="ot">=</span><span class="fu">list</span>(</span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">aes=</span><span class="fu">aes</span>(<span class="at">x=</span>intersection, <span class="at">fill=</span>mpaa),</span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">geom=</span><span class="fu">list</span>(</span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>                <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'count'</span>, <span class="at">position=</span><span class="st">'fill'</span>, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a>                <span class="fu">geom_text</span>(</span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">aes</span>(<span class="at">label=</span><span class="fu">ifelse</span>(mpaa <span class="sc">==</span> <span class="st">'R'</span>, <span class="st">'R'</span>, <span class="cn">NA</span>)),</span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a>                    <span class="at">stat=</span><span class="st">'count'</span>,</span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a>                    <span class="at">position=</span><span class="fu">position_fill</span>(<span class="at">vjust =</span> .<span class="dv">5</span>),</span>
<span id="cb84-14"><a href="#cb84-14" aria-hidden="true" tabindex="-1"></a>                    <span class="at">na.rm=</span><span class="cn">TRUE</span></span>
<span id="cb84-15"><a href="#cb84-15" aria-hidden="true" tabindex="-1"></a>                ),</span>
<span id="cb84-16"><a href="#cb84-16" aria-hidden="true" tabindex="-1"></a>                show_hide_scale,</span>
<span id="cb84-17"><a href="#cb84-17" aria-hidden="true" tabindex="-1"></a>                rating_scale</span>
<span id="cb84-18"><a href="#cb84-18" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb84-19"><a href="#cb84-19" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb84-20"><a href="#cb84-20" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb84-21"><a href="#cb84-21" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="Examples_Python_files/Examples_Python_193_0.png"></p>
</div>
<div class="section level3">
<h3 id="combine-multiple-plots-together">11.2 Combine multiple plots together<a class="anchor" aria-label="anchor" href="#combine-multiple-plots-together"></a>
</h3>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="sc">%%</span>R <span class="sc">-</span>w <span class="dv">800</span> <span class="sc">-</span>h <span class="dv">500</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>annotations <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'MPAA Rating'</span><span class="ot">=</span><span class="fu">list</span>(</span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">aes=</span><span class="fu">aes</span>(<span class="at">x=</span>intersection, <span class="at">fill=</span>mpaa),</span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">geom=</span><span class="fu">list</span>(</span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a>            <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'count'</span>, <span class="at">position=</span><span class="st">'fill'</span>)</span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb85-12"><a href="#cb85-12" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)    <span class="co"># for replicable example only</span></span>
<span id="cb85-13"><a href="#cb85-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-14"><a href="#cb85-14" aria-hidden="true" tabindex="-1"></a>data_1 <span class="ot">=</span> movies[<span class="fu">sample</span>(<span class="fu">nrow</span>(movies), <span class="dv">100</span>), ]</span>
<span id="cb85-15"><a href="#cb85-15" aria-hidden="true" tabindex="-1"></a>data_2 <span class="ot">=</span> movies[<span class="fu">sample</span>(<span class="fu">nrow</span>(movies), <span class="dv">100</span>), ]</span>
<span id="cb85-16"><a href="#cb85-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-17"><a href="#cb85-17" aria-hidden="true" tabindex="-1"></a>u1 <span class="ot">=</span> <span class="fu">upset</span>(data_1, genres, <span class="at">min_size=</span><span class="dv">5</span>, <span class="at">base_annotations=</span>annotations)</span>
<span id="cb85-18"><a href="#cb85-18" aria-hidden="true" tabindex="-1"></a>u2 <span class="ot">=</span> <span class="fu">upset</span>(data_2, genres, <span class="at">min_size=</span><span class="dv">5</span>, <span class="at">base_annotations=</span>annotations)</span>
<span id="cb85-19"><a href="#cb85-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-20"><a href="#cb85-20" aria-hidden="true" tabindex="-1"></a>(u1 <span class="sc">|</span> u2) <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">guides=</span><span class="st">'collect'</span>)</span></code></pre></div>
<p><img src="Examples_Python_files/Examples_Python_195_0.png"></p>
</div>
<div class="section level3">
<h3 id="change-height-of-the-annotations">11.3 Change height of the annotations<a class="anchor" aria-label="anchor" href="#change-height-of-the-annotations"></a>
</h3>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="sc">%%</span>R <span class="sc">-</span>w <span class="dv">800</span> <span class="sc">-</span>h <span class="dv">350</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>    movies, genres, <span class="at">name=</span><span class="st">'genre'</span>, <span class="at">width_ratio=</span><span class="fl">0.1</span>, <span class="at">min_size=</span><span class="dv">100</span>,</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">annotations =</span><span class="fu">list</span>(</span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">'MPAA Rating'</span><span class="ot">=</span><span class="fu">list</span>(</span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">aes=</span><span class="fu">aes</span>(<span class="at">x=</span>intersection, <span class="at">fill=</span>mpaa),</span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">geom=</span><span class="fu">list</span>(</span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a>                <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'count'</span>, <span class="at">position=</span><span class="st">'fill'</span>),</span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a>                <span class="fu">scale_y_continuous</span>(<span class="at">labels=</span>scales<span class="sc">::</span><span class="fu">percent_format</span>())</span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb86-11"><a href="#cb86-11" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb86-12"><a href="#cb86-12" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb86-13"><a href="#cb86-13" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> patchwork<span class="sc">::</span><span class="fu">plot_layout</span>(<span class="at">heights=</span><span class="fu">c</span>(<span class="fl">0.5</span>, <span class="dv">1</span>, <span class="fl">0.5</span>))</span></code></pre></div>
<p><img src="Examples_Python_files/Examples_Python_197_0.png"></p>
</div>
</div>
<div class="section level2">
<h2 id="venn-diagrams">12. Venn diagrams<a class="anchor" aria-label="anchor" href="#venn-diagrams"></a>
</h2>
<p>Simple implementation of Venn diagrams is provided, taking the same
input format as <code><a href="../reference/upset.html">upset()</a></code> but only supporting up to three
sets.</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="sc">%%</span>R</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>movies_subset <span class="ot">=</span> <span class="fu">head</span>(movies, <span class="dv">300</span>)</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>genres_subset <span class="ot">=</span> <span class="fu">c</span>(<span class="st">'Comedy'</span>, <span class="st">'Drama'</span>, <span class="st">'Action'</span>)</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>movies_subset<span class="sc">$</span>good_rating <span class="ot">=</span> movies_subset<span class="sc">$</span>rating <span class="sc">&gt;</span> <span class="fu">mean</span>(movies_subset<span class="sc">$</span>rating)</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>arranged <span class="ot">=</span> <span class="fu">arrange_venn</span>(movies_subset, <span class="at">sets=</span>genres_subset)</span></code></pre></div>
<div class="section level3">
<h3 id="highlight-specific-elements">12.1 Highlight specific elements<a class="anchor" aria-label="anchor" href="#highlight-specific-elements"></a>
</h3>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="sc">%%</span>R <span class="sc">-</span>w <span class="dv">800</span> <span class="sc">-</span>h <span class="dv">550</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(arranged)</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> <span class="fu">theme_void</span>()</span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> <span class="fu">coord_fixed</span>()</span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y, <span class="at">color=</span>region, <span class="at">shape=</span>good_rating, <span class="at">fill=</span>length), <span class="at">size=</span><span class="fl">2.7</span>)</span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> <span class="fu">geom_venn_circle</span>(movies_subset, <span class="at">sets=</span>genres_subset, <span class="at">size=</span><span class="dv">1</span>)</span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> <span class="fu">geom_venn_label_set</span>(movies_subset, <span class="at">sets=</span>genres_subset, <span class="fu">aes</span>(<span class="at">label=</span>region), <span class="at">outwards_adjust=</span><span class="fl">2.6</span>)</span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> <span class="fu">geom_venn_label_region</span>(movies_subset, <span class="at">sets=</span>genres_subset, <span class="fu">aes</span>(<span class="at">label=</span>size), <span class="at">position=</span><span class="fu">position_nudge</span>(<span class="at">y=</span><span class="fl">0.15</span>))</span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> <span class="fu">geom_curve</span>(</span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">data=</span>arranged[<span class="fu">which.min</span>(arranged<span class="sc">$</span>length), ],</span>
<span id="cb88-12"><a href="#cb88-12" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">xend=</span>x<span class="fl">+0.01</span>, <span class="at">yend=</span>y<span class="fl">+0.01</span>), <span class="at">x=</span><span class="fl">1.5</span>, <span class="at">y=</span><span class="fl">2.5</span>, <span class="at">curvature=</span>.<span class="dv">2</span>,</span>
<span id="cb88-13"><a href="#cb88-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.015</span>, <span class="st">"npc"</span>))</span>
<span id="cb88-14"><a href="#cb88-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb88-15"><a href="#cb88-15" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> <span class="fu">annotate</span>(</span>
<span id="cb88-16"><a href="#cb88-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">geom=</span><span class="st">'text'</span>, <span class="at">x=</span><span class="fl">1.9</span>, <span class="at">y=</span><span class="fl">2.6</span>, <span class="at">size=</span><span class="dv">6</span>,</span>
<span id="cb88-17"><a href="#cb88-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">label=</span><span class="fu">paste</span>(<span class="fu">substr</span>(arranged[<span class="fu">which.min</span>(arranged<span class="sc">$</span>length), ]<span class="sc">$</span>title, <span class="dv">0</span>, <span class="dv">9</span>), <span class="st">'is the shortest'</span>)</span>
<span id="cb88-18"><a href="#cb88-18" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb88-19"><a href="#cb88-19" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> <span class="fu">scale_color_venn_mix</span>(movies, <span class="at">sets=</span>genres_subset, <span class="at">guide=</span><span class="st">'none'</span>)</span>
<span id="cb88-20"><a href="#cb88-20" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> <span class="fu">scale_shape_manual</span>(</span>
<span id="cb88-21"><a href="#cb88-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">values=</span><span class="fu">c</span>(</span>
<span id="cb88-22"><a href="#cb88-22" aria-hidden="true" tabindex="-1"></a>            <span class="st">'TRUE'</span><span class="ot">=</span><span class="st">'triangle filled'</span>,</span>
<span id="cb88-23"><a href="#cb88-23" aria-hidden="true" tabindex="-1"></a>            <span class="st">'FALSE'</span><span class="ot">=</span><span class="st">'triangle down filled'</span></span>
<span id="cb88-24"><a href="#cb88-24" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb88-25"><a href="#cb88-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">labels=</span><span class="fu">c</span>(</span>
<span id="cb88-26"><a href="#cb88-26" aria-hidden="true" tabindex="-1"></a>            <span class="st">'TRUE'</span><span class="ot">=</span><span class="st">'above average'</span>,</span>
<span id="cb88-27"><a href="#cb88-27" aria-hidden="true" tabindex="-1"></a>            <span class="st">'FALSE'</span><span class="ot">=</span><span class="st">'below average'</span></span>
<span id="cb88-28"><a href="#cb88-28" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb88-29"><a href="#cb88-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">name=</span><span class="st">'Rating'</span></span>
<span id="cb88-30"><a href="#cb88-30" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb88-31"><a href="#cb88-31" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> <span class="fu">scale_fill_gradient</span>(<span class="at">low=</span><span class="st">'white'</span>, <span class="at">high=</span><span class="st">'black'</span>, <span class="at">name=</span><span class="st">'Length (minutes)'</span>)</span>
<span id="cb88-32"><a href="#cb88-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-33"><a href="#cb88-33" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="Examples_Python_files/Examples_Python_202_0.png"></p>
</div>
<div class="section level3">
<h3 id="highlight-all-regions">12.2 Highlight all regions<a class="anchor" aria-label="anchor" href="#highlight-all-regions"></a>
</h3>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="sc">%%</span>R <span class="sc">-</span>w <span class="dv">800</span> <span class="sc">-</span>h <span class="dv">550</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(arranged)</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> <span class="fu">theme_void</span>()</span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> <span class="fu">coord_fixed</span>()</span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> <span class="fu">geom_venn_region</span>(movies_subset, <span class="at">sets=</span>genres_subset, <span class="at">alpha=</span><span class="fl">0.1</span>)</span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y, <span class="at">color=</span>region), <span class="at">size=</span><span class="fl">2.5</span>)</span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> <span class="fu">geom_venn_circle</span>(movies_subset, <span class="at">sets=</span>genres_subset, <span class="at">size=</span><span class="fl">1.5</span>)</span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> <span class="fu">geom_venn_label_set</span>(movies_subset, <span class="at">sets=</span>genres_subset, <span class="fu">aes</span>(<span class="at">label=</span>region), <span class="at">outwards_adjust=</span><span class="fl">2.6</span>)</span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> <span class="fu">geom_venn_label_region</span>(movies_subset, <span class="at">sets=</span>genres_subset, <span class="fu">aes</span>(<span class="at">label=</span>size), <span class="at">position=</span><span class="fu">position_nudge</span>(<span class="at">y=</span><span class="fl">0.15</span>))</span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> <span class="fu">scale_color_venn_mix</span>(movies, <span class="at">sets=</span>genres_subset, <span class="at">guide=</span><span class="st">'none'</span>)</span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> <span class="fu">scale_fill_venn_mix</span>(movies, <span class="at">sets=</span>genres_subset, <span class="at">guide=</span><span class="st">'none'</span>)</span>
<span id="cb89-13"><a href="#cb89-13" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="Examples_Python_files/Examples_Python_204_0.png"></p>
</div>
<div class="section level3">
<h3 id="highlight-specific-regions">12.3 Highlight specific regions<a class="anchor" aria-label="anchor" href="#highlight-specific-regions"></a>
</h3>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="sc">%%</span>R <span class="sc">-</span>w <span class="dv">800</span> <span class="sc">-</span>h <span class="dv">550</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(arranged)</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> <span class="fu">theme_void</span>()</span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> <span class="fu">coord_fixed</span>()</span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> <span class="fu">geom_venn_region</span>(movies_subset, <span class="at">sets=</span>genres_subset, <span class="at">alpha=</span><span class="fl">0.2</span>)</span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y, <span class="at">color=</span>region), <span class="at">size=</span><span class="fl">1.5</span>)</span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> <span class="fu">geom_venn_circle</span>(movies_subset, <span class="at">sets=</span>genres_subset, <span class="at">size=</span><span class="dv">2</span>)</span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> <span class="fu">geom_venn_label_set</span>(movies_subset, <span class="at">sets=</span>genres_subset, <span class="fu">aes</span>(<span class="at">label=</span>region), <span class="at">outwards_adjust=</span><span class="fl">2.6</span>)</span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> <span class="fu">scale_color_venn_mix</span>(movies, <span class="at">sets=</span>genres_subset, <span class="at">guide=</span><span class="st">'none'</span>)</span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> <span class="fu">scale_fill_venn_mix</span>(movies, <span class="at">sets=</span>genres_subset, <span class="at">guide=</span><span class="st">'none'</span>, <span class="at">highlight=</span><span class="fu">c</span>(<span class="st">'Comedy-Action'</span>, <span class="st">'Drama'</span>), <span class="at">inactive_color=</span><span class="st">'white'</span>)</span>
<span id="cb90-13"><a href="#cb90-13" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="Examples_Python_files/Examples_Python_206_0.png"></p>
</div>
<div class="section level3">
<h3 id="two-sets-venn">12.4 Two sets Venn<a class="anchor" aria-label="anchor" href="#two-sets-venn"></a>
</h3>
<p>The density of the points grid is determined in such a way that the
all the points from the set with the largest space restrictions are fit
into the available area. In case of the diagram below, its the
observations that do not belong to any set that define the grid
density:</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="sc">%%</span>R <span class="sc">-</span>w <span class="dv">600</span> <span class="sc">-</span>h <span class="dv">450</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>genres_subset <span class="ot">=</span> <span class="fu">c</span>(<span class="st">'Action'</span>, <span class="st">'Drama'</span>)</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">arrange_venn</span>(movies_subset, <span class="at">sets=</span>genres_subset))</span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> <span class="fu">theme_void</span>()</span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> <span class="fu">coord_fixed</span>()</span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y, <span class="at">color=</span>region), <span class="at">size=</span><span class="dv">2</span>)</span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> <span class="fu">geom_venn_circle</span>(movies_subset, <span class="at">sets=</span>genres_subset, <span class="at">size=</span><span class="dv">2</span>)</span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> <span class="fu">geom_venn_label_set</span>(movies_subset, <span class="at">sets=</span>genres_subset, <span class="fu">aes</span>(<span class="at">label=</span>region), <span class="at">outwards_adjust=</span><span class="fl">2.6</span>)</span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> <span class="fu">scale_color_venn_mix</span>(movies, <span class="at">sets=</span>genres_subset, <span class="at">guide=</span><span class="st">'none'</span>)</span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="Examples_Python_files/Examples_Python_209_0.png"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Michał Krassowski.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
