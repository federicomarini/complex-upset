<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Examples - R • ComplexUpset</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Examples - R">
<meta property="og:description" content="ComplexUpset">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:creator" content="@krassowski">
<meta name="twitter:site" content="@krassowski">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ComplexUpset</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.2.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Examples_Python.html">Examples - Python</a>
    </li>
    <li>
      <a href="../articles/Examples_R.html">Examples - R</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/krassowski/complex-upset/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Examples_R_files/header-attrs-2.7/header-attrs.js"></script><script src="Examples_R_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Examples - R</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/krassowski/complex-upset/blob/master/vignettes/Examples_R.Rmd"><code>vignettes/Examples_R.Rmd</code></a></small>
      <div class="hidden name"><code>Examples_R.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/krassowski/complex-upset">ComplexUpset</a></span><span class="op">)</span></code></pre></div>
<div id="prepare-the-datasets" class="section level2">
<h2 class="hasAnchor">
<a href="#prepare-the-datasets" class="anchor"></a>Prepare the datasets</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">movies</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu">ggplot2movies</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/ggplot2movies/man/movies.html">movies</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">movies</span>, <span class="fl">3</span><span class="op">)</span></code></pre></div>
<table class="table dataframe">
<caption>
A data.frame: 3 × 24
</caption>
<thead>
<tr>
<th>
</th>
<th scope="col">
title
</th>
<th scope="col">
year
</th>
<th scope="col">
length
</th>
<th scope="col">
budget
</th>
<th scope="col">
rating
</th>
<th scope="col">
votes
</th>
<th scope="col">
r1
</th>
<th scope="col">
r2
</th>
<th scope="col">
r3
</th>
<th scope="col">
r4
</th>
<th scope="col">
⋯
</th>
<th scope="col">
r9
</th>
<th scope="col">
r10
</th>
<th scope="col">
mpaa
</th>
<th scope="col">
Action
</th>
<th scope="col">
Animation
</th>
<th scope="col">
Comedy
</th>
<th scope="col">
Drama
</th>
<th scope="col">
Documentary
</th>
<th scope="col">
Romance
</th>
<th scope="col">
Short
</th>
</tr>
<tr>
<th>
</th>
<th scope="col">
&lt;chr&gt;
</th>
<th scope="col">
&lt;int&gt;
</th>
<th scope="col">
&lt;int&gt;
</th>
<th scope="col">
&lt;int&gt;
</th>
<th scope="col">
&lt;dbl&gt;
</th>
<th scope="col">
&lt;int&gt;
</th>
<th scope="col">
&lt;dbl&gt;
</th>
<th scope="col">
&lt;dbl&gt;
</th>
<th scope="col">
&lt;dbl&gt;
</th>
<th scope="col">
&lt;dbl&gt;
</th>
<th scope="col">
⋯
</th>
<th scope="col">
&lt;dbl&gt;
</th>
<th scope="col">
&lt;dbl&gt;
</th>
<th scope="col">
&lt;chr&gt;
</th>
<th scope="col">
&lt;int&gt;
</th>
<th scope="col">
&lt;int&gt;
</th>
<th scope="col">
&lt;int&gt;
</th>
<th scope="col">
&lt;int&gt;
</th>
<th scope="col">
&lt;int&gt;
</th>
<th scope="col">
&lt;int&gt;
</th>
<th scope="col">
&lt;int&gt;
</th>
</tr>
</thead>
<tbody>
<tr>
<th scope="row">
1
</th>
<td>
$
</td>
<td>
1971
</td>
<td>
121
</td>
<td>
NA
</td>
<td>
6.4
</td>
<td>
348
</td>
<td>
4.5
</td>
<td>
4.5
</td>
<td>
4.5
</td>
<td>
4.5
</td>
<td>
⋯
</td>
<td>
4.5
</td>
<td>
4.5
</td>
<td>
</td>
<td>
0
</td>
<td>
0
</td>
<td>
1
</td>
<td>
1
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
</tr>
<tr>
<th scope="row">
2
</th>
<td>
$1000 a Touchdown
</td>
<td>
1939
</td>
<td>
71
</td>
<td>
NA
</td>
<td>
6.0
</td>
<td>
20
</td>
<td>
0.0
</td>
<td>
14.5
</td>
<td>
4.5
</td>
<td>
24.5
</td>
<td>
⋯
</td>
<td>
4.5
</td>
<td>
14.5
</td>
<td>
</td>
<td>
0
</td>
<td>
0
</td>
<td>
1
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
</tr>
<tr>
<th scope="row">
3
</th>
<td>
$21 a Day Once a Month
</td>
<td>
1941
</td>
<td>
7
</td>
<td>
NA
</td>
<td>
8.2
</td>
<td>
5
</td>
<td>
0.0
</td>
<td>
0.0
</td>
<td>
0.0
</td>
<td>
0.0
</td>
<td>
⋯
</td>
<td>
24.5
</td>
<td>
24.5
</td>
<td>
</td>
<td>
0
</td>
<td>
1
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
1
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">genres</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">movies</span><span class="op">)</span><span class="op">[</span><span class="fl">18</span><span class="op">:</span><span class="fl">24</span><span class="op">]</span>
<span class="va">genres</span></code></pre></div>
<style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class="list-inline">
<li>
‘Action’
</li>
<li>
‘Animation’
</li>
<li>
‘Comedy’
</li>
<li>
‘Drama’
</li>
<li>
‘Documentary’
</li>
<li>
‘Romance’
</li>
<li>
‘Short’
</li>
</ol>
<p>Convert the genre indicator columns to use boolean values:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">movies</span><span class="op">[</span><span class="va">genres</span><span class="op">]</span> <span class="op">=</span> <span class="va">movies</span><span class="op">[</span><span class="va">genres</span><span class="op">]</span> <span class="op">==</span> <span class="fl">1</span>
<span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">movies</span><span class="op">[</span><span class="va">genres</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<table class="table dataframe">
<caption>
A matrix: 7 × 3 of type lgl
</caption>
<thead><tr>
<th>
</th>
<th scope="col">
1
</th>
<th scope="col">
2
</th>
<th scope="col">
3
</th>
</tr></thead>
<tbody>
<tr>
<th scope="row">
Action
</th>
<td>
FALSE
</td>
<td>
FALSE
</td>
<td>
FALSE
</td>
</tr>
<tr>
<th scope="row">
Animation
</th>
<td>
FALSE
</td>
<td>
FALSE
</td>
<td>
TRUE
</td>
</tr>
<tr>
<th scope="row">
Comedy
</th>
<td>
TRUE
</td>
<td>
TRUE
</td>
<td>
FALSE
</td>
</tr>
<tr>
<th scope="row">
Drama
</th>
<td>
TRUE
</td>
<td>
FALSE
</td>
<td>
FALSE
</td>
</tr>
<tr>
<th scope="row">
Documentary
</th>
<td>
FALSE
</td>
<td>
FALSE
</td>
<td>
FALSE
</td>
</tr>
<tr>
<th scope="row">
Romance
</th>
<td>
FALSE
</td>
<td>
FALSE
</td>
<td>
FALSE
</td>
</tr>
<tr>
<th scope="row">
Short
</th>
<td>
FALSE
</td>
<td>
FALSE
</td>
<td>
TRUE
</td>
</tr>
</tbody>
</table>
<p>To keep the examples fast to compile we will operate on a subset of the movies with complete data:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">movies</span><span class="op">[</span><span class="va">movies</span><span class="op">$</span><span class="va">mpaa</span> <span class="op">==</span> <span class="st">''</span>, <span class="st">'mpaa'</span><span class="op">]</span> <span class="op">=</span> <span class="cn">NA</span>
<span class="va">movies</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="va">movies</span><span class="op">)</span></code></pre></div>
<p>Utility for changing output parameters in Jupyter notebooks (<a href="https://github.com/IRkernel/IRkernel">IRKernel kernel</a>), not relevant if using RStudio or scripting R from terminal:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">set_size</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">w</span>, <span class="va">h</span>, <span class="va">factor</span><span class="op">=</span><span class="fl">1.5</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">s</span> <span class="op">=</span> <span class="fl">1</span> <span class="op">*</span> <span class="va">factor</span>
    <span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>
        repr.plot.width<span class="op">=</span><span class="va">w</span> <span class="op">*</span> <span class="va">s</span>,
        repr.plot.height<span class="op">=</span><span class="va">h</span> <span class="op">*</span> <span class="va">s</span>,
        repr.plot.res<span class="op">=</span><span class="fl">100</span> <span class="op">/</span> <span class="va">factor</span>,
        jupyter.plot_mimetypes<span class="op">=</span><span class="st">'image/png'</span>,
        jupyter.plot_scale<span class="op">=</span><span class="fl">1</span>
    <span class="op">)</span>
<span class="op">}</span></code></pre></div>
</div>
<div id="basic-usage" class="section level2">
<h2 class="hasAnchor">
<a href="#basic-usage" class="anchor"></a>0. Basic usage</h2>
<p>There are two required arguments:</p>
<ul>
<li>the first argument is expected to be a dataframe with both group indicator variables and covariates,</li>
<li>the second argument specifies a list with names of column which indicate the group membership.</li>
</ul>
<p>Additional arguments can be provided, such as <code>name</code> (specifies <code><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab()</a></code> for intersection matrix) or <code>width_ratio</code> (specifies how much space should be occupied by the set size panel). Other such arguments are discussed at length later in this document.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">8</span>, <span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span><span class="va">movies</span>, <span class="va">genres</span>, name<span class="op">=</span><span class="st">'genre'</span>, width_ratio<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_12_0.png"></p>
<div id="selecting-intersections" class="section level3">
<h3 class="hasAnchor">
<a href="#selecting-intersections" class="anchor"></a>0.1 Selecting intersections</h3>
<p>We will focus on the intersections with at least ten members <code>(min_size=10)</code> and on a few variables which are significantly different between the intersections (see 2. Running statistical tests).</p>
<p>When using <code>min_size</code>, the empty groups will be skipped by default (e.g. <em>Short</em> movies would have no overlap with size of 10). To keep all groups pass <code>keep_empty_groups=TRUE</code>:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">8</span>, <span class="fl">3</span><span class="op">)</span>
<span class="op">(</span>
    <span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span><span class="va">movies</span>, <span class="va">genres</span>, name<span class="op">=</span><span class="st">'genre'</span>, width_ratio<span class="op">=</span><span class="fl">0.1</span>, min_size<span class="op">=</span><span class="fl">10</span>, wrap<span class="op">=</span><span class="cn">TRUE</span>, set_sizes<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
    <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">'Without empty groups (Short dropped)'</span><span class="op">)</span>
    <span class="op">+</span>    <span class="co"># adding plots is possible thanks to patchwork</span>
    <span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span><span class="va">movies</span>, <span class="va">genres</span>, name<span class="op">=</span><span class="st">'genre'</span>, width_ratio<span class="op">=</span><span class="fl">0.1</span>, min_size<span class="op">=</span><span class="fl">10</span>, keep_empty_groups<span class="op">=</span><span class="cn">TRUE</span>, wrap<span class="op">=</span><span class="cn">TRUE</span>, set_sizes<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
    <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">'With empty groups'</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_15_0.png"></p>
<p>When empty columns are detected a warning will be issued. The silence it, pass <code>warn_when_dropping_groups=FALSE</code>. Complimentary <code>max_size</code> can be used in tandem.</p>
<p>You can also select intersections by degree (<code>min_degree</code> and <code>max_degree</code>):</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">8</span>, <span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
    <span class="va">movies</span>, <span class="va">genres</span>, width_ratio<span class="op">=</span><span class="fl">0.1</span>,
    min_degree<span class="op">=</span><span class="fl">3</span>,
<span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_18_0.png"></p>
<p>Or request a constant number of intersections with <code>n_intersections</code>:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">8</span>, <span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
    <span class="va">movies</span>, <span class="va">genres</span>, width_ratio<span class="op">=</span><span class="fl">0.1</span>,
    n_intersections<span class="op">=</span><span class="fl">15</span>
<span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_20_0.png"></p>
</div>
<div id="region-selection-modes" class="section level3">
<h3 class="hasAnchor">
<a href="#region-selection-modes" class="anchor"></a>0.2 Region selection modes</h3>
<p>There are three modes defining the regions of interest on corresponding Venn diagram:</p>
<ul>
<li>
<code>exclusive_intersection</code> intersection region: intersection elements that belong to the sets defining the intersection but not to any other set (alias: <em>distinct</em>), <strong>default</strong>
</li>
<li>
<code>inclusive_intersection</code> intersection region: intersection elements that belong to the sets defining the intersection including overlaps with other sets (alias: <em>intersect</em>)</li>
<li>
<code>exclusive_union</code> region: union elements that belong to the sets defining the union, <em>excluding</em> those overlapping with any other set</li>
<li>
<code>inclusive_union</code> region: union elements that belong to the sets defining the union, <em>including</em> those overlapping with any other set (alias: <em>union</em>)</li>
</ul>
<p>Example: given three sets <span class="math inline">\(A\)</span>, <span class="math inline">\(B\)</span> and <span class="math inline">\(C\)</span> with number of elements defined by the Venn diagram below</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">abc_data</span> <span class="op">=</span> <span class="fu"><a href="../reference/create_upset_abc_example.html">create_upset_abc_example</a></span><span class="op">(</span><span class="op">)</span>

<span class="va">abc_venn</span> <span class="op">=</span> <span class="op">(</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="../reference/arrange_venn.html">arrange_venn</a></span><span class="op">(</span><span class="va">abc_data</span><span class="op">)</span><span class="op">)</span>
    <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_fixed</a></span><span class="op">(</span><span class="op">)</span>
    <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void</a></span><span class="op">(</span><span class="op">)</span>
    <span class="op">+</span> <span class="fu"><a href="../reference/scale_color_venn_mix.html">scale_color_venn_mix</a></span><span class="op">(</span><span class="va">abc_data</span><span class="op">)</span>
<span class="op">)</span>

<span class="op">(</span>
    <span class="va">abc_venn</span>
    <span class="op">+</span> <span class="fu"><a href="../reference/geom_venn_region.html">geom_venn_region</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">abc_data</span>, alpha<span class="op">=</span><span class="fl">0.05</span><span class="op">)</span>
    <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span>, y<span class="op">=</span><span class="va">y</span>, color<span class="op">=</span><span class="va">region</span><span class="op">)</span>, size<span class="op">=</span><span class="fl">1</span><span class="op">)</span>
    <span class="op">+</span> <span class="fu"><a href="../reference/geom_venn_circle.html">geom_venn_circle</a></span><span class="op">(</span><span class="va">abc_data</span><span class="op">)</span>
    <span class="op">+</span> <span class="fu"><a href="../reference/geom_venn_label_set.html">geom_venn_label_set</a></span><span class="op">(</span><span class="va">abc_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label<span class="op">=</span><span class="va">region</span><span class="op">)</span><span class="op">)</span>
    <span class="op">+</span> <span class="fu"><a href="../reference/geom_venn_label_region.html">geom_venn_label_region</a></span><span class="op">(</span>
        <span class="va">abc_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label<span class="op">=</span><span class="va">size</span><span class="op">)</span>,
        outwards_adjust<span class="op">=</span><span class="fl">1.75</span>,
        position<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_nudge.html">position_nudge</a></span><span class="op">(</span>y<span class="op">=</span><span class="fl">0.2</span><span class="op">)</span>
    <span class="op">)</span>
    <span class="op">+</span> <span class="fu"><a href="../reference/scale_fill_venn_mix.html">scale_fill_venn_mix</a></span><span class="op">(</span><span class="va">abc_data</span>, guide<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_24_0.png"></p>
<p>For the above sets <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> the region selection modes correspond to region of Venn diagram defined as follows:</p>
<ul>
<li>exclusive intersection: <span class="math inline">\((A \cap B) \setminus C\)</span>
</li>
<li>inclusive intersection: <span class="math inline">\(A \cap B\)</span>
</li>
<li>exclusive union: <span class="math inline">\((A \cup B) \setminus C\)</span>
</li>
<li>inclusive union: <span class="math inline">\(A \cup B\)</span>
</li>
</ul>
<p>and have the total number of elements as in the table below:</p>
<table class="table">
<thead><tr class="header">
<th>members  mode</th>
<th>exclusive int.</th>
<th>inclusive int.</th>
<th>exclusive union</th>
<th>inclusive union</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>(A, B)</td>
<td>10</td>
<td>11</td>
<td>110</td>
<td>123</td>
</tr>
<tr class="even">
<td>(A, C) == (B, C)</td>
<td>6</td>
<td>7</td>
<td>256</td>
<td>273</td>
</tr>
<tr class="odd">
<td>(A) == (B)</td>
<td>50</td>
<td>67</td>
<td>50</td>
<td>67</td>
</tr>
<tr class="even">
<td>(C)</td>
<td>200</td>
<td>213</td>
<td>200</td>
<td>213</td>
</tr>
<tr class="odd">
<td>(A, B, C)</td>
<td>1</td>
<td>1</td>
<td>323</td>
<td>323</td>
</tr>
<tr class="even">
<td>()</td>
<td>2</td>
<td>2</td>
<td>2</td>
<td>2</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">6</span>, <span class="fl">6.5</span><span class="op">)</span>
<span class="va">simple_venn</span> <span class="op">=</span> <span class="op">(</span>
    <span class="va">abc_venn</span>
    <span class="op">+</span> <span class="fu"><a href="../reference/geom_venn_region.html">geom_venn_region</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">abc_data</span>, alpha<span class="op">=</span><span class="fl">0.3</span><span class="op">)</span>
    <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span>, y<span class="op">=</span><span class="va">y</span><span class="op">)</span>, size<span class="op">=</span><span class="fl">0.75</span>, alpha<span class="op">=</span><span class="fl">0.3</span><span class="op">)</span>
    <span class="op">+</span> <span class="fu"><a href="../reference/geom_venn_circle.html">geom_venn_circle</a></span><span class="op">(</span><span class="va">abc_data</span><span class="op">)</span>
    <span class="op">+</span> <span class="fu"><a href="../reference/geom_venn_label_set.html">geom_venn_label_set</a></span><span class="op">(</span><span class="va">abc_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label<span class="op">=</span><span class="va">region</span><span class="op">)</span>, outwards_adjust<span class="op">=</span><span class="fl">2.55</span><span class="op">)</span>
<span class="op">)</span>
<span class="va">highlight</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">regions</span><span class="op">)</span> <span class="fu"><a href="../reference/scale_fill_venn_mix.html">scale_fill_venn_mix</a></span><span class="op">(</span>
    <span class="va">abc_data</span>, guide<span class="op">=</span><span class="cn">FALSE</span>, highlight<span class="op">=</span><span class="va">regions</span>, inactive_color<span class="op">=</span><span class="st">'NA'</span>
<span class="op">)</span>

<span class="op">(</span>
    <span class="op">(</span>
        <span class="va">simple_venn</span> <span class="op">+</span> <span class="fu">highlight</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'A-B'</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title<span class="op">=</span><span class="st">'Exclusive intersection of A and B'</span><span class="op">)</span>
        <span class="op">|</span> <span class="va">simple_venn</span> <span class="op">+</span> <span class="fu">highlight</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'A-B'</span>, <span class="st">'A-B-C'</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title<span class="op">=</span><span class="st">'Inclusive intersection of A and B'</span><span class="op">)</span>
    <span class="op">)</span> <span class="op">/</span>
    <span class="op">(</span>
        <span class="va">simple_venn</span> <span class="op">+</span> <span class="fu">highlight</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'A-B'</span>, <span class="st">'A'</span>, <span class="st">'B'</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title<span class="op">=</span><span class="st">'Exclusive union of A and B'</span><span class="op">)</span>
        <span class="op">|</span> <span class="va">simple_venn</span> <span class="op">+</span> <span class="fu">highlight</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'A-B'</span>, <span class="st">'A-B-C'</span>, <span class="st">'A'</span>, <span class="st">'B'</span>, <span class="st">'A-C'</span>, <span class="st">'B-C'</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title<span class="op">=</span><span class="st">'Inclusive union of A and B'</span><span class="op">)</span>
    <span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_27_0.png"></p>
<p>When customizing the <code><a href="../reference/intersection_size.html">intersection_size()</a></code> it is important to adjust the mode accordingly, as it defaults to <code>exclusive_intersection</code> and cannot be automatically deduced when user customizations are being applied:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">8</span>, <span class="fl">4.5</span><span class="op">)</span>
<span class="va">abc_upset</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">mode</span><span class="op">)</span> <span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
    <span class="va">abc_data</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'A'</span>, <span class="st">'B'</span>, <span class="st">'C'</span><span class="op">)</span>, mode<span class="op">=</span><span class="va">mode</span>, set_sizes<span class="op">=</span><span class="cn">FALSE</span>,
    encode_sets<span class="op">=</span><span class="cn">FALSE</span>,
    queries<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="../reference/upset_query.html">upset_query</a></span><span class="op">(</span>intersect<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'A'</span>, <span class="st">'B'</span><span class="op">)</span>, color<span class="op">=</span><span class="st">'orange'</span><span class="op">)</span><span class="op">)</span>,
    base_annotations<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
        <span class="st">'Size'</span><span class="op">=</span><span class="op">(</span>
            <span class="fu"><a href="../reference/intersection_size.html">intersection_size</a></span><span class="op">(</span>
                mode<span class="op">=</span><span class="va">mode</span>,
                mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill<span class="op">=</span><span class="va">exclusive_intersection</span><span class="op">)</span>,
                size<span class="op">=</span><span class="fl">0</span>,
                text<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>check_overlap<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
            <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="../reference/scale_fill_venn_mix.html">scale_fill_venn_mix</a></span><span class="op">(</span>
                data<span class="op">=</span><span class="va">abc_data</span>,
                guide<span class="op">=</span><span class="cn">FALSE</span>,
                colors<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'A'</span><span class="op">=</span><span class="st">'red'</span>, <span class="st">'B'</span><span class="op">=</span><span class="st">'blue'</span>, <span class="st">'C'</span><span class="op">=</span><span class="st">'green3'</span><span class="op">)</span>
            <span class="op">)</span>
        <span class="op">)</span>
    <span class="op">)</span>
<span class="op">)</span>

<span class="op">(</span>
    <span class="op">(</span><span class="fu">abc_upset</span><span class="op">(</span><span class="st">'exclusive_intersection'</span><span class="op">)</span> <span class="op">|</span> <span class="fu">abc_upset</span><span class="op">(</span><span class="st">'inclusive_intersection'</span><span class="op">)</span><span class="op">)</span>
    <span class="op">/</span>
    <span class="op">(</span><span class="fu">abc_upset</span><span class="op">(</span><span class="st">'exclusive_union'</span><span class="op">)</span> <span class="op">|</span> <span class="fu">abc_upset</span><span class="op">(</span><span class="st">'inclusive_union'</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_29_0.png"></p>
</div>
<div id="displaying-all-intersections" class="section level3">
<h3 class="hasAnchor">
<a href="#displaying-all-intersections" class="anchor"></a>0.3 Displaying all intersections</h3>
<p>To display all possible intersections (rather than only the observed ones) use <code>intersections='all'</code>.</p>
<p><strong>Note 1</strong>: it is usually desired to filter all the possible intersections down with <code>max_degree</code> and/or <code>min_degree</code> to avoid generating all combinations as those can easily use up all available RAM memory when dealing with multiple sets (e.g. all human genes) due to sheer number of possible combinations</p>
<p><strong>Note 2</strong>: using <code>intersections='all'</code> is only reasonable for mode different from the default <em>exclusive intersection</em>.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">8</span>, <span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
    <span class="va">movies</span>, <span class="va">genres</span>,
    width_ratio<span class="op">=</span><span class="fl">0.1</span>,
    min_size<span class="op">=</span><span class="fl">10</span>,
    mode<span class="op">=</span><span class="st">'inclusive_union'</span>,
    base_annotations<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">'Size'</span><span class="op">=</span><span class="op">(</span><span class="fu"><a href="../reference/intersection_size.html">intersection_size</a></span><span class="op">(</span>counts<span class="op">=</span><span class="cn">FALSE</span>, mode<span class="op">=</span><span class="st">'inclusive_union'</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
    intersections<span class="op">=</span><span class="st">'all'</span>,
    max_degree<span class="op">=</span><span class="fl">3</span>
<span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_32_0.png"></p>
</div>
</div>
<div id="adding-components" class="section level2">
<h2 class="hasAnchor">
<a href="#adding-components" class="anchor"></a>1. Adding components</h2>
<p>We can add multiple annotation components (also called panels) using one of the three methods demonstrated below:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">8</span>, <span class="fl">8</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span>   <span class="co"># keep the same jitter for identical plots</span>

<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
    <span class="va">movies</span>,
    <span class="va">genres</span>,
    annotations <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
        <span class="co"># 1st method - passing list:</span>
        <span class="st">'Length'</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
            aes<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">intersection</span>, y<span class="op">=</span><span class="va">length</span><span class="op">)</span>,
            <span class="co"># provide a list if you wish to add several geoms</span>
            geom<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
        <span class="op">)</span>,
        <span class="co"># 2nd method - using ggplot</span>
        <span class="st">'Rating'</span><span class="op">=</span><span class="op">(</span>
            <span class="co"># note that aes(x=intersection) is supplied by default and can be skipped</span>
            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">rating</span><span class="op">)</span><span class="op">)</span>
            <span class="co"># checkout ggbeeswarm::geom_quasirandom for better results!</span>
            <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html">geom_jitter</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">votes</span><span class="op">)</span><span class="op">)</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
            <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_violin.html">geom_violin</a></span><span class="op">(</span>alpha<span class="op">=</span><span class="fl">0.5</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
        <span class="op">)</span>,
        <span class="co"># 3rd method - using `upset_annotate` shorthand</span>
        <span class="st">'Budget'</span><span class="op">=</span><span class="fu"><a href="../reference/upset_annotate.html">upset_annotate</a></span><span class="op">(</span><span class="st">'budget'</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
    <span class="op">)</span>,
    min_size<span class="op">=</span><span class="fl">10</span>,
    width_ratio<span class="op">=</span><span class="fl">0.1</span>
<span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_35_0.png"></p>
<p>You can also use barplots to demonstrate differences in proportions of categorical variables:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">8</span>, <span class="fl">5</span><span class="op">)</span>

<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
    <span class="va">movies</span>,
    <span class="va">genres</span>,
    annotations <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
        <span class="st">'MPAA Rating'</span><span class="op">=</span><span class="op">(</span>
            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill<span class="op">=</span><span class="va">mpaa</span><span class="op">)</span><span class="op">)</span>
            <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>stat<span class="op">=</span><span class="st">'count'</span>, position<span class="op">=</span><span class="st">'fill'</span><span class="op">)</span>
            <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>labels<span class="op">=</span><span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_percent.html">percent_format</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
            <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
                <span class="st">'R'</span><span class="op">=</span><span class="st">'#E41A1C'</span>, <span class="st">'PG'</span><span class="op">=</span><span class="st">'#377EB8'</span>,
                <span class="st">'PG-13'</span><span class="op">=</span><span class="st">'#4DAF4A'</span>, <span class="st">'NC-17'</span><span class="op">=</span><span class="st">'#FF7F00'</span>
            <span class="op">)</span><span class="op">)</span>
            <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">'MPAA Rating'</span><span class="op">)</span>
        <span class="op">)</span>
    <span class="op">)</span>,
    width_ratio<span class="op">=</span><span class="fl">0.1</span>
<span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_37_0.png"></p>
<div id="changing-modes-in-annotations" class="section level3">
<h3 class="hasAnchor">
<a href="#changing-modes-in-annotations" class="anchor"></a>1.1. Changing modes in annotations</h3>
<p>Use <code>upset_mode</code> to change the mode of the annotation:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">8</span>, <span class="fl">8</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span>
<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
    <span class="va">movies</span>,
    <span class="va">genres</span>,
    mode<span class="op">=</span><span class="st">'inclusive_intersection'</span>,
    annotations <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
        <span class="co"># if not specified, the mode will follow the mode set in `upset()` call (here: `inclusive_intersection`)</span>
        <span class="st">'Length (inclusive intersection)'</span><span class="op">=</span><span class="op">(</span>
            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">length</span><span class="op">)</span><span class="op">)</span>
            <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html">geom_jitter</a></span><span class="op">(</span>alpha<span class="op">=</span><span class="fl">0.2</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
        <span class="op">)</span>,
        <span class="st">'Length (exclusive intersection)'</span><span class="op">=</span><span class="op">(</span>
            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">length</span><span class="op">)</span><span class="op">)</span>
            <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html">geom_jitter</a></span><span class="op">(</span>alpha<span class="op">=</span><span class="fl">0.2</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
            <span class="op">+</span> <span class="fu"><a href="../reference/upset_mode.html">upset_mode</a></span><span class="op">(</span><span class="st">'exclusive_intersection'</span><span class="op">)</span>
        <span class="op">)</span>,
        <span class="st">'Length (inclusive union)'</span><span class="op">=</span><span class="op">(</span>
            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">length</span><span class="op">)</span><span class="op">)</span>
            <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html">geom_jitter</a></span><span class="op">(</span>alpha<span class="op">=</span><span class="fl">0.2</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
            <span class="op">+</span> <span class="fu"><a href="../reference/upset_mode.html">upset_mode</a></span><span class="op">(</span><span class="st">'inclusive_union'</span><span class="op">)</span>
        <span class="op">)</span>
    <span class="op">)</span>,
    min_size<span class="op">=</span><span class="fl">10</span>,
    width_ratio<span class="op">=</span><span class="fl">0.1</span>
<span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_40_0.png"></p>
</div>
</div>
<div id="running-statistical-tests" class="section level2">
<h2 class="hasAnchor">
<a href="#running-statistical-tests" class="anchor"></a>2. Running statistical tests</h2>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/upset_test.html">upset_test</a></span><span class="op">(</span><span class="va">movies</span>, <span class="va">genres</span><span class="op">)</span></code></pre></div>
<pre><code>[1] "year, length, budget, rating, votes, r1, r2, r3, r4, r5, r6, r7, r8, r9, r10, mpaa differ significantly between intersections"</code></pre>
<table class="table dataframe">
<caption>
A data.frame: 17 × 5
</caption>
<thead>
<tr>
<th>
</th>
<th scope="col">
variable
</th>
<th scope="col">
p.value
</th>
<th scope="col">
statistic
</th>
<th scope="col">
test
</th>
<th scope="col">
fdr
</th>
</tr>
<tr>
<th>
</th>
<th scope="col">
&lt;chr&gt;
</th>
<th scope="col">
&lt;dbl&gt;
</th>
<th scope="col">
&lt;dbl&gt;
</th>
<th scope="col">
&lt;chr&gt;
</th>
<th scope="col">
&lt;dbl&gt;
</th>
</tr>
</thead>
<tbody>
<tr>
<th scope="row">
length
</th>
<td>
length
</td>
<td>
6.511525e-71
</td>
<td>
422.88444
</td>
<td>
Kruskal-Wallis rank sum test
</td>
<td>
1.106959e-69
</td>
</tr>
<tr>
<th scope="row">
rating
</th>
<td>
rating
</td>
<td>
1.209027e-46
</td>
<td>
301.72764
</td>
<td>
Kruskal-Wallis rank sum test
</td>
<td>
1.027673e-45
</td>
</tr>
<tr>
<th scope="row">
budget
</th>
<td>
budget
</td>
<td>
3.899860e-44
</td>
<td>
288.97476
</td>
<td>
Kruskal-Wallis rank sum test
</td>
<td>
2.209921e-43
</td>
</tr>
<tr>
<th scope="row">
r8
</th>
<td>
r8
</td>
<td>
9.900004e-39
</td>
<td>
261.28815
</td>
<td>
Kruskal-Wallis rank sum test
</td>
<td>
4.207502e-38
</td>
</tr>
<tr>
<th scope="row">
mpaa
</th>
<td>
mpaa
</td>
<td>
3.732200e-35
</td>
<td>
242.77939
</td>
<td>
Kruskal-Wallis rank sum test
</td>
<td>
1.268948e-34
</td>
</tr>
<tr>
<th scope="row">
r9
</th>
<td>
r9
</td>
<td>
1.433256e-30
</td>
<td>
218.78160
</td>
<td>
Kruskal-Wallis rank sum test
</td>
<td>
4.060891e-30
</td>
</tr>
<tr>
<th scope="row">
r1
</th>
<td>
r1
</td>
<td>
2.211600e-23
</td>
<td>
180.32740
</td>
<td>
Kruskal-Wallis rank sum test
</td>
<td>
5.371029e-23
</td>
</tr>
<tr>
<th scope="row">
r4
</th>
<td>
r4
</td>
<td>
1.008119e-18
</td>
<td>
154.62772
</td>
<td>
Kruskal-Wallis rank sum test
</td>
<td>
2.142254e-18
</td>
</tr>
<tr>
<th scope="row">
r3
</th>
<td>
r3
</td>
<td>
2.568227e-17
</td>
<td>
146.70217
</td>
<td>
Kruskal-Wallis rank sum test
</td>
<td>
4.851095e-17
</td>
</tr>
<tr>
<th scope="row">
r5
</th>
<td>
r5
</td>
<td>
9.823827e-16
</td>
<td>
137.66310
</td>
<td>
Kruskal-Wallis rank sum test
</td>
<td>
1.670051e-15
</td>
</tr>
<tr>
<th scope="row">
r7
</th>
<td>
r7
</td>
<td>
9.201549e-14
</td>
<td>
126.19243
</td>
<td>
Kruskal-Wallis rank sum test
</td>
<td>
1.422058e-13
</td>
</tr>
<tr>
<th scope="row">
r2
</th>
<td>
r2
</td>
<td>
2.159955e-13
</td>
<td>
124.00604
</td>
<td>
Kruskal-Wallis rank sum test
</td>
<td>
3.059936e-13
</td>
</tr>
<tr>
<th scope="row">
r10
</th>
<td>
r10
</td>
<td>
1.283470e-11
</td>
<td>
113.38113
</td>
<td>
Kruskal-Wallis rank sum test
</td>
<td>
1.678384e-11
</td>
</tr>
<tr>
<th scope="row">
votes
</th>
<td>
votes
</td>
<td>
2.209085e-10
</td>
<td>
105.79588
</td>
<td>
Kruskal-Wallis rank sum test
</td>
<td>
2.682460e-10
</td>
</tr>
<tr>
<th scope="row">
r6
</th>
<td>
r6
</td>
<td>
3.779129e-05
</td>
<td>
70.80971
</td>
<td>
Kruskal-Wallis rank sum test
</td>
<td>
4.283013e-05
</td>
</tr>
<tr>
<th scope="row">
year
</th>
<td>
year
</td>
<td>
2.745818e-02
</td>
<td>
46.55972
</td>
<td>
Kruskal-Wallis rank sum test
</td>
<td>
2.917431e-02
</td>
</tr>
<tr>
<th scope="row">
title
</th>
<td>
title
</td>
<td>
2.600003e-01
</td>
<td>
34.53375
</td>
<td>
Kruskal-Wallis rank sum test
</td>
<td>
2.600003e-01
</td>
</tr>
</tbody>
</table>
<p><code>Kruskal-Wallis rank sum test</code> is not always the best choice.</p>
<p>You can either change the test for:</p>
<ul>
<li>all the variables (<code>test=your.test</code>), or</li>
<li>specific variables (using <code>tests=list(variable=some.test)</code> argument)</li>
</ul>
<p>The tests are called with <code>(formula=variable ~ intersection, data)</code> signature, such as accepted by <code>kruskal.test</code>. The result is expected to be a list with following members:</p>
<ul>
<li><code>p.value</code></li>
<li><code>statistic</code></li>
<li><code>method</code></li>
</ul>
<p>It is easy to adapt tests which do not obey this signature/output convention; for example the Chi-squared test and anova can be wrapped with two-line functions as follows:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">chisq_from_formula</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">formula</span>, <span class="va">data</span><span class="op">)</span> <span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/r/stats/chisq.test.html">chisq.test</a></span><span class="op">(</span>
        <span class="fu"><a href="https://rdrr.io/r/stats/ftable.html">ftable</a></span><span class="op">(</span><span class="va">formula</span>, <span class="va">data</span><span class="op">)</span>
    <span class="op">)</span>
<span class="op">}</span>

<span class="va">anova_single</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">formula</span>, <span class="va">data</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">result</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">formula</span>, <span class="va">data</span><span class="op">)</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
        p.value<span class="op">=</span><span class="va">result</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">'Pr(&gt;F)'</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,
        method<span class="op">=</span><span class="st">'Analysis of variance Pr(&gt;F)'</span>,
        statistic<span class="op">=</span><span class="va">result</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">'F value'</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>
    <span class="op">)</span>
<span class="op">}</span>

<span class="va">custom_tests</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
    mpaa<span class="op">=</span><span class="va">chisq_from_formula</span>,
    budget<span class="op">=</span><span class="va">anova_single</span>
<span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu"><a href="../reference/upset_test.html">upset_test</a></span><span class="op">(</span><span class="va">movies</span>, <span class="va">genres</span>, tests<span class="op">=</span><span class="va">custom_tests</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>Warning message in chisq.test(ftable(formula, data)):
“Chi-squared approximation may be incorrect”


[1] "year, length, budget, rating, votes, r1, r2, r3, r4, r5, r6, r7, r8, r9, r10, mpaa differ significantly between intersections"</code></pre>
<table class="table dataframe">
<caption>
A data.frame: 6 × 5
</caption>
<thead>
<tr>
<th>
</th>
<th scope="col">
variable
</th>
<th scope="col">
p.value
</th>
<th scope="col">
statistic
</th>
<th scope="col">
test
</th>
<th scope="col">
fdr
</th>
</tr>
<tr>
<th>
</th>
<th scope="col">
&lt;chr&gt;
</th>
<th scope="col">
&lt;dbl&gt;
</th>
<th scope="col">
&lt;dbl&gt;
</th>
<th scope="col">
&lt;chr&gt;
</th>
<th scope="col">
&lt;dbl&gt;
</th>
</tr>
</thead>
<tbody>
<tr>
<th scope="row">
length
</th>
<td>
length
</td>
<td>
6.511525e-71
</td>
<td>
422.88444
</td>
<td>
Kruskal-Wallis rank sum test
</td>
<td>
1.106959e-69
</td>
</tr>
<tr>
<th scope="row">
budget
</th>
<td>
budget
</td>
<td>
1.348209e-60
</td>
<td>
13.66395
</td>
<td>
Analysis of variance Pr(&gt;F)
</td>
<td>
1.145977e-59
</td>
</tr>
<tr>
<th scope="row">
rating
</th>
<td>
rating
</td>
<td>
1.209027e-46
</td>
<td>
301.72764
</td>
<td>
Kruskal-Wallis rank sum test
</td>
<td>
6.851151e-46
</td>
</tr>
<tr>
<th scope="row">
mpaa
</th>
<td>
mpaa
</td>
<td>
9.799097e-42
</td>
<td>
406.33814
</td>
<td>
Pearson’s Chi-squared test
</td>
<td>
4.164616e-41
</td>
</tr>
<tr>
<th scope="row">
r8
</th>
<td>
r8
</td>
<td>
9.900004e-39
</td>
<td>
261.28815
</td>
<td>
Kruskal-Wallis rank sum test
</td>
<td>
3.366002e-38
</td>
</tr>
<tr>
<th scope="row">
r9
</th>
<td>
r9
</td>
<td>
1.433256e-30
</td>
<td>
218.78160
</td>
<td>
Kruskal-Wallis rank sum test
</td>
<td>
4.060891e-30
</td>
</tr>
</tbody>
</table>
<p>Many tests will require at least two observations in each group. You can skip intersections with less than two members with <code>min_size=2</code>.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bartlett_results</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/warning.html">suppressWarnings</a></span><span class="op">(</span><span class="fu"><a href="../reference/upset_test.html">upset_test</a></span><span class="op">(</span><span class="va">movies</span>, <span class="va">genres</span>, test<span class="op">=</span><span class="va">bartlett.test</span>, min_size<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">tail</a></span><span class="op">(</span><span class="va">bartlett_results</span><span class="op">)</span></code></pre></div>
<pre><code>[1] "NA, year, length, budget, rating, votes, r1, r2, r3, r4, r5, r6, r7, r8, r9, r10, NA differ significantly between intersections"</code></pre>
<table class="table dataframe">
<caption>
A data.frame: 6 × 5
</caption>
<thead>
<tr>
<th>
</th>
<th scope="col">
variable
</th>
<th scope="col">
p.value
</th>
<th scope="col">
statistic
</th>
<th scope="col">
test
</th>
<th scope="col">
fdr
</th>
</tr>
<tr>
<th>
</th>
<th scope="col">
&lt;chr&gt;
</th>
<th scope="col">
&lt;dbl&gt;
</th>
<th scope="col">
&lt;dbl&gt;
</th>
<th scope="col">
&lt;chr&gt;
</th>
<th scope="col">
&lt;dbl&gt;
</th>
</tr>
</thead>
<tbody>
<tr>
<th scope="row">
year
</th>
<td>
year
</td>
<td>
1.041955e-67
</td>
<td>
386.53699
</td>
<td>
Bartlett test of homogeneity of variances
</td>
<td>
1.302444e-67
</td>
</tr>
<tr>
<th scope="row">
length
</th>
<td>
length
</td>
<td>
3.982729e-67
</td>
<td>
383.70148
</td>
<td>
Bartlett test of homogeneity of variances
</td>
<td>
4.595457e-67
</td>
</tr>
<tr>
<th scope="row">
budget
</th>
<td>
budget
</td>
<td>
7.637563e-50
</td>
<td>
298.89911
</td>
<td>
Bartlett test of homogeneity of variances
</td>
<td>
8.183103e-50
</td>
</tr>
<tr>
<th scope="row">
rating
</th>
<td>
rating
</td>
<td>
3.980194e-06
</td>
<td>
66.63277
</td>
<td>
Bartlett test of homogeneity of variances
</td>
<td>
3.980194e-06
</td>
</tr>
<tr>
<th scope="row">
title
</th>
<td>
title
</td>
<td>
NA
</td>
<td>
NA
</td>
<td>
Bartlett test of homogeneity of variances
</td>
<td>
NA
</td>
</tr>
<tr>
<th scope="row">
mpaa
</th>
<td>
mpaa
</td>
<td>
NA
</td>
<td>
NA
</td>
<td>
Bartlett test of homogeneity of variances
</td>
<td>
NA
</td>
</tr>
</tbody>
</table>
<div id="ignore-specific-variables" class="section level3">
<h3 class="hasAnchor">
<a href="#ignore-specific-variables" class="anchor"></a>2.1 Ignore specific variables</h3>
<p>You may want to exclude variables which are:</p>
<ul>
<li>highly correlated and therefore interfering with the FDR calculation, or</li>
<li>simply irrelevant</li>
</ul>
<p>In the movies example, the title variable is not a reasonable thing to compare. We can ignore it using:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># note: title no longer present</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="fu"><a href="../reference/upset_test.html">upset_test</a></span><span class="op">(</span><span class="va">movies</span>, <span class="va">genres</span>, ignore<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'title'</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>[1] "year, length, budget, rating, votes, r1, r2, r3, r4, r5, r6, r7, r8, r9, r10, mpaa differ significantly between intersections"</code></pre>
<style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class="list-inline">
<li>
‘length’
</li>
<li>
‘rating’
</li>
<li>
‘budget’
</li>
<li>
‘r8’
</li>
<li>
‘mpaa’
</li>
<li>
‘r9’
</li>
<li>
‘r1’
</li>
<li>
‘r4’
</li>
<li>
‘r3’
</li>
<li>
‘r5’
</li>
<li>
‘r7’
</li>
<li>
‘r2’
</li>
<li>
‘r10’
</li>
<li>
‘votes’
</li>
<li>
‘r6’
</li>
<li>
‘year’
</li>
</ol>
</div>
</div>
<div id="adjusting-intersection-size" class="section level2">
<h2 class="hasAnchor">
<a href="#adjusting-intersection-size" class="anchor"></a>3. Adjusting “Intersection size”</h2>
<div id="counts" class="section level3">
<h3 class="hasAnchor">
<a href="#counts" class="anchor"></a>3.1 Counts</h3>
<p>The counts over the bars can be disabled:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">8</span>, <span class="fl">3</span><span class="op">)</span>

<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
    <span class="va">movies</span>,
    <span class="va">genres</span>,
    base_annotations<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
        <span class="st">'Intersection size'</span><span class="op">=</span><span class="fu"><a href="../reference/intersection_size.html">intersection_size</a></span><span class="op">(</span>counts<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
    <span class="op">)</span>,
    min_size<span class="op">=</span><span class="fl">10</span>,
    width_ratio<span class="op">=</span><span class="fl">0.1</span>
<span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_55_0.png"></p>
<p>The colors can be changed, and additional annotations added:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">8</span>, <span class="fl">3</span><span class="op">)</span>

<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
    <span class="va">movies</span>,
    <span class="va">genres</span>,
    base_annotations<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
        <span class="st">'Intersection size'</span><span class="op">=</span><span class="fu"><a href="../reference/intersection_size.html">intersection_size</a></span><span class="op">(</span>
            text_colors<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
                on_background<span class="op">=</span><span class="st">'brown'</span>, on_bar<span class="op">=</span><span class="st">'yellow'</span>
            <span class="op">)</span>
        <span class="op">)</span>
        <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span>
            geom<span class="op">=</span><span class="st">'text'</span>, x<span class="op">=</span><span class="cn">Inf</span>, y<span class="op">=</span><span class="cn">Inf</span>,
            label<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">'Total:'</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">movies</span><span class="op">)</span><span class="op">)</span>,
            vjust<span class="op">=</span><span class="fl">1</span>, hjust<span class="op">=</span><span class="fl">1</span>
        <span class="op">)</span>
        <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">'Intersection size'</span><span class="op">)</span>
    <span class="op">)</span>,
    min_size<span class="op">=</span><span class="fl">10</span>,
    width_ratio<span class="op">=</span><span class="fl">0.1</span>
<span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_57_0.png"></p>
<p>Any parameter supported by <code>geom_text</code> can be passed in <code>text</code> list:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">8</span>, <span class="fl">3</span><span class="op">)</span>

<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
    <span class="va">movies</span>,
    <span class="va">genres</span>,
    base_annotations<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
        <span class="st">'Intersection size'</span><span class="op">=</span><span class="fu"><a href="../reference/intersection_size.html">intersection_size</a></span><span class="op">(</span>
            text<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
                vjust<span class="op">=</span><span class="op">-</span><span class="fl">0.1</span>,
                hjust<span class="op">=</span><span class="op">-</span><span class="fl">0.1</span>,
                angle<span class="op">=</span><span class="fl">45</span>
            <span class="op">)</span>
        <span class="op">)</span>
    <span class="op">)</span>,
    min_size<span class="op">=</span><span class="fl">10</span>,
    width_ratio<span class="op">=</span><span class="fl">0.1</span>
<span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_59_0.png"></p>
</div>
<div id="fill-the-bars" class="section level3">
<h3 class="hasAnchor">
<a href="#fill-the-bars" class="anchor"></a>3.2 Fill the bars</h3>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">8</span>, <span class="fl">3</span><span class="op">)</span>

<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
    <span class="va">movies</span>,
    <span class="va">genres</span>,
    base_annotations<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
        <span class="st">'Intersection size'</span><span class="op">=</span><span class="fu"><a href="../reference/intersection_size.html">intersection_size</a></span><span class="op">(</span>
            counts<span class="op">=</span><span class="cn">FALSE</span>,
            mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill<span class="op">=</span><span class="va">mpaa</span><span class="op">)</span>
        <span class="op">)</span>
    <span class="op">)</span>,
    width_ratio<span class="op">=</span><span class="fl">0.1</span>
<span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_61_0.png"></p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">8</span>, <span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
    <span class="va">movies</span>,
    <span class="va">genres</span>,
    base_annotations<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
        <span class="st">'Intersection size'</span><span class="op">=</span><span class="fu"><a href="../reference/intersection_size.html">intersection_size</a></span><span class="op">(</span>
            counts<span class="op">=</span><span class="cn">FALSE</span>,
            mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill<span class="op">=</span><span class="va">mpaa</span><span class="op">)</span>
        <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
            <span class="st">'R'</span><span class="op">=</span><span class="st">'#E41A1C'</span>, <span class="st">'PG'</span><span class="op">=</span><span class="st">'#377EB8'</span>,
            <span class="st">'PG-13'</span><span class="op">=</span><span class="st">'#4DAF4A'</span>, <span class="st">'NC-17'</span><span class="op">=</span><span class="st">'#FF7F00'</span>
        <span class="op">)</span><span class="op">)</span>
    <span class="op">)</span>,
    width_ratio<span class="op">=</span><span class="fl">0.1</span>
<span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_62_0.png"></p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">8</span>, <span class="fl">3</span><span class="op">)</span>

<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
    <span class="va">movies</span>,
    <span class="va">genres</span>,
    base_annotations<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
        <span class="st">'Intersection size'</span><span class="op">=</span><span class="fu"><a href="../reference/intersection_size.html">intersection_size</a></span><span class="op">(</span>
            counts<span class="op">=</span><span class="cn">FALSE</span>,
            mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill<span class="op">=</span><span class="st">'bars_color'</span><span class="op">)</span>
        <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'bars_color'</span><span class="op">=</span><span class="st">'blue'</span><span class="op">)</span>, guide<span class="op">=</span><span class="st">'none'</span><span class="op">)</span>
    <span class="op">)</span>,
    width_ratio<span class="op">=</span><span class="fl">0.1</span>
<span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_63_0.png"></p>
</div>
<div id="adjusting-the-height-ratio" class="section level3">
<h3 class="hasAnchor">
<a href="#adjusting-the-height-ratio" class="anchor"></a>3.3 Adjusting the height ratio</h3>
<p>Setting <code>height_ratio=1</code> will cause the intersection matrix and the intersection size to have an equal height:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">8</span>, <span class="fl">3</span><span class="op">)</span>

<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
    <span class="va">movies</span>,
    <span class="va">genres</span>,
    height_ratio<span class="op">=</span><span class="fl">1</span>,
    width_ratio<span class="op">=</span><span class="fl">0.1</span>
<span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_66_0.png"></p>
</div>
<div id="hiding-intersection-size" class="section level3">
<h3 class="hasAnchor">
<a href="#hiding-intersection-size" class="anchor"></a>3.5 Hiding intersection size</h3>
<p>You can always disable the intersection size altogether:</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">8</span>, <span class="fl">1.6</span><span class="op">)</span>
<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
    <span class="va">movies</span>,
    <span class="va">genres</span>,
    base_annotations<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="op">)</span>,
    min_size<span class="op">=</span><span class="fl">10</span>,
    width_ratio<span class="op">=</span><span class="fl">0.1</span>
<span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_69_0.png"></p>
</div>
<div id="showing-intersection-sizeunion-size-ratio" class="section level3">
<h3 class="hasAnchor">
<a href="#showing-intersection-sizeunion-size-ratio" class="anchor"></a>3.6 Showing intersection size/union size ratio</h3>
<p>It can be useful to visualise which intersections are larger than expected by chance (assuming equal probability of belonging to multiple sets); this can be achieved using the intersection size/union size ratio.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">8</span>, <span class="fl">6</span><span class="op">)</span>
<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
    <span class="va">movies</span>, <span class="va">genres</span>, name<span class="op">=</span><span class="st">'genre'</span>, width_ratio<span class="op">=</span><span class="fl">0.1</span>, min_size<span class="op">=</span><span class="fl">10</span>,
    base_annotations<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
        <span class="st">'Intersection size'</span><span class="op">=</span><span class="fu"><a href="../reference/intersection_size.html">intersection_size</a></span><span class="op">(</span><span class="op">)</span>,
        <span class="st">'Intersection ratio'</span><span class="op">=</span><span class="fu"><a href="../reference/intersection_ratio.html">intersection_ratio</a></span><span class="op">(</span><span class="op">)</span>
    <span class="op">)</span>
<span class="op">)</span></code></pre></div>
<pre><code>Warning message:
“Removed 62 rows containing missing values (position_stack).”</code></pre>
<p><img src="Examples_R_files/Examples_R_72_1.png"></p>
<p>The plot above tells us that the analysed documentary movies are almost always (in over 60% of cases) documentaries (and nothing more!), while comedies more often include elements of other genres (e.g. drama, romance) rather than being comedies alone (like stand-up shows).</p>
</div>
<div id="showing-percentages" class="section level3">
<h3 class="hasAnchor">
<a href="#showing-percentages" class="anchor"></a>3.7 Showing percentages</h3>
<p><code>text_mapping</code> can be used to manipulate the aesthetics of the labels. Using the <code>intersection_size</code> and <code>union_size</code> one can calculate percentage of items in the intersection (relative to the potential size of the intersection). A <code><a href="../reference/upset_text_percentage.html">upset_text_percentage(digits=0, sep='')</a></code> shorthand is provided for convenience:</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">8</span>, <span class="fl">6</span><span class="op">)</span>
<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
    <span class="va">movies</span>, <span class="va">genres</span>, name<span class="op">=</span><span class="st">'genre'</span>, width_ratio<span class="op">=</span><span class="fl">0.1</span>, min_size<span class="op">=</span><span class="fl">10</span>,
    base_annotations<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
        <span class="co"># with manual aes specification:</span>
        <span class="st">'Intersection size'</span><span class="op">=</span><span class="fu"><a href="../reference/intersection_size.html">intersection_size</a></span><span class="op">(</span>text_mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span>
            <span class="op">!</span><span class="op">!</span><span class="fu"><a href="../reference/get_size_mode.html">get_size_mode</a></span><span class="op">(</span><span class="st">'exclusive_intersection'</span><span class="op">)</span><span class="op">/</span><span class="op">!</span><span class="op">!</span><span class="fu"><a href="../reference/get_size_mode.html">get_size_mode</a></span><span class="op">(</span><span class="st">'inclusive_union'</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>
        <span class="op">)</span>, <span class="st">'%'</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
        <span class="co"># using shorthand:</span>
        <span class="st">'Intersection ratio'</span><span class="op">=</span><span class="fu"><a href="../reference/intersection_ratio.html">intersection_ratio</a></span><span class="op">(</span>text_mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label<span class="op">=</span><span class="op">!</span><span class="op">!</span><span class="fu"><a href="../reference/upset_text_percentage.html">upset_text_percentage</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
    <span class="op">)</span>
<span class="op">)</span></code></pre></div>
<pre><code>Warning message:
“Removed 62 rows containing missing values (position_stack).”</code></pre>
<p><img src="Examples_R_files/Examples_R_76_1.png"></p>
<p>Also see <a href="#10-display-percentages">10. Display percentages</a>.</p>
</div>
<div id="further-adjustments-using-ggplot2-functions" class="section level3">
<h3 class="hasAnchor">
<a href="#further-adjustments-using-ggplot2-functions" class="anchor"></a>3.8 Further adjustments using ggplot2 functions</h3>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">8</span>, <span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
    <span class="va">movies</span>, <span class="va">genres</span>, width_ratio<span class="op">=</span><span class="fl">0.1</span>,
    base_annotations <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
        <span class="st">'Intersection size'</span><span class="op">=</span><span class="op">(</span>
            <span class="fu"><a href="../reference/intersection_size.html">intersection_size</a></span><span class="op">(</span><span class="op">)</span>
            <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">ylim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">700</span><span class="op">)</span><span class="op">)</span>
            <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>plot.background<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_rect</a></span><span class="op">(</span>fill<span class="op">=</span><span class="st">'#E5D3B3'</span><span class="op">)</span><span class="op">)</span>
            <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">'# observations in intersection'</span><span class="op">)</span>
        <span class="op">)</span>
    <span class="op">)</span>,
    min_size<span class="op">=</span><span class="fl">10</span>
<span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_79_0.png"></p>
</div>
</div>
<div id="adjusting-set-size" class="section level2">
<h2 class="hasAnchor">
<a href="#adjusting-set-size" class="anchor"></a>4. Adjusting “set size”</h2>
<p>When using thresholding or selection criteria (such as <code>min_size</code> or <code>n_intersections</code>) the change in number of elements in each set size is not reflected in the set sizes plot by default. You can change this by providing <code>filter_intersections=TRUE</code> to <code>upset_set_size</code>.</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">8</span>, <span class="fl">2.5</span><span class="op">)</span>
<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
    <span class="va">movies</span>, <span class="va">genres</span>,
    min_size<span class="op">=</span><span class="fl">200</span>,
    set_sizes<span class="op">=</span><span class="fu"><a href="../reference/upset_set_size.html">upset_set_size</a></span><span class="op">(</span><span class="op">)</span>
<span class="op">)</span> <span class="op">|</span> <span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
    <span class="va">movies</span>, <span class="va">genres</span>,
    min_size<span class="op">=</span><span class="fl">200</span>,
    set_sizes<span class="op">=</span><span class="fu"><a href="../reference/upset_set_size.html">upset_set_size</a></span><span class="op">(</span>filter_intersections<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_82_0.png"></p>
<div id="rotate-labels" class="section level3">
<h3 class="hasAnchor">
<a href="#rotate-labels" class="anchor"></a>4.1 Rotate labels</h3>
<p>To rotate the labels modify corresponding theme:</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">4</span>, <span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
    <span class="va">movies</span>, <span class="va">genres</span>,
    min_size<span class="op">=</span><span class="fl">100</span>,
    width_ratio<span class="op">=</span><span class="fl">0.15</span>,
    set_sizes<span class="op">=</span><span class="op">(</span>
        <span class="fu"><a href="../reference/upset_set_size.html">upset_set_size</a></span><span class="op">(</span><span class="op">)</span>
        <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.x<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>angle<span class="op">=</span><span class="fl">90</span><span class="op">)</span><span class="op">)</span>
    <span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_85_0.png"></p>
<p>To display the ticks:</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">4</span>, <span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
    <span class="va">movies</span>, <span class="va">genres</span>, width_ratio<span class="op">=</span><span class="fl">0.3</span>, min_size<span class="op">=</span><span class="fl">100</span>, wrap<span class="op">=</span><span class="cn">TRUE</span>,
    set_sizes<span class="op">=</span><span class="op">(</span>
        <span class="fu"><a href="../reference/upset_set_size.html">upset_set_size</a></span><span class="op">(</span><span class="op">)</span>
        <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.ticks.x<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_line</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
    <span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_87_0.png"></p>
</div>
<div id="modify-geoms-and-other-layers" class="section level3">
<h3 class="hasAnchor">
<a href="#modify-geoms-and-other-layers" class="anchor"></a>4.2 Modify geoms and other layers</h3>
<p>Arguments of the <code>geom_bar</code> can be adjusted in <code>upset_set_size</code>; it can use a different geom, or be replaced with a custom list of layers altogether:</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">8</span>, <span class="fl">3</span><span class="op">)</span>

<span class="op">(</span>
    <span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
        <span class="va">movies</span>, <span class="va">genres</span>, width_ratio<span class="op">=</span><span class="fl">0.5</span>, max_size<span class="op">=</span><span class="fl">100</span>, min_size<span class="op">=</span><span class="fl">15</span>, wrap<span class="op">=</span><span class="cn">TRUE</span>,
        set_sizes<span class="op">=</span><span class="fu"><a href="../reference/upset_set_size.html">upset_set_size</a></span><span class="op">(</span>
            geom<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>width<span class="op">=</span><span class="fl">0.4</span><span class="op">)</span>
        <span class="op">)</span>
    <span class="op">)</span>
    <span class="op">+</span>
    <span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
        <span class="va">movies</span>, <span class="va">genres</span>, width_ratio<span class="op">=</span><span class="fl">0.5</span>, max_size<span class="op">=</span><span class="fl">100</span>, min_size<span class="op">=</span><span class="fl">15</span>, wrap<span class="op">=</span><span class="cn">TRUE</span>,
        set_sizes<span class="op">=</span><span class="fu"><a href="../reference/upset_set_size.html">upset_set_size</a></span><span class="op">(</span>
            geom<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>
                stat<span class="op">=</span><span class="st">'count'</span>,
                color<span class="op">=</span><span class="st">'blue'</span>
            <span class="op">)</span>
        <span class="op">)</span>
    <span class="op">)</span>
    <span class="op">+</span>
    <span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
        <span class="va">movies</span>, <span class="va">genres</span>, width_ratio<span class="op">=</span><span class="fl">0.5</span>, max_size<span class="op">=</span><span class="fl">100</span>, min_size<span class="op">=</span><span class="fl">15</span>, wrap<span class="op">=</span><span class="cn">TRUE</span>,
        set_sizes<span class="op">=</span><span class="op">(</span>
            <span class="fu"><a href="../reference/upset_set_size.html">upset_set_size</a></span><span class="op">(</span>
                geom<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>stat<span class="op">=</span><span class="st">'count'</span><span class="op">)</span>,
                mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">..count..</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">..count..</span><span class="op">)</span><span class="op">)</span>,
            <span class="op">)</span>
            <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">'Size relative to the largest'</span><span class="op">)</span>
        <span class="op">)</span>
    <span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_90_0.png"></p>
</div>
<div id="logarithmic-scale" class="section level3">
<h3 class="hasAnchor">
<a href="#logarithmic-scale" class="anchor"></a>4.3 Logarithmic scale</h3>
<p>In order to use a log scale we need to pass additional scale to in <code>layers</code> argument. However, as the bars are on flipped coordinates, we need a reversed log transformation. Appropriate function, <code><a href="../reference/reverse_log_trans.html">reverse_log_trans()</a></code> is provided:</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">5</span>, <span class="fl">3</span><span class="op">)</span>

<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
    <span class="va">movies</span>, <span class="va">genres</span>,
    width_ratio<span class="op">=</span><span class="fl">0.1</span>,
    min_size<span class="op">=</span><span class="fl">10</span>,
    set_sizes<span class="op">=</span><span class="op">(</span>
        <span class="fu"><a href="../reference/upset_set_size.html">upset_set_size</a></span><span class="op">(</span><span class="op">)</span>
        <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.x<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>angle<span class="op">=</span><span class="fl">90</span><span class="op">)</span><span class="op">)</span>
        <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>trans<span class="op">=</span><span class="fu"><a href="../reference/reverse_log_trans.html">reverse_log_trans</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
    <span class="op">)</span>,
    queries<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="../reference/upset_query.html">upset_query</a></span><span class="op">(</span>set<span class="op">=</span><span class="st">'Drama'</span>, fill<span class="op">=</span><span class="st">'blue'</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_93_0.png"></p>
<p>We can also modify the labels to display the logged values:</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">5</span>, <span class="fl">3</span><span class="op">)</span>

<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
    <span class="va">movies</span>, <span class="va">genres</span>,
    min_size<span class="op">=</span><span class="fl">10</span>,
    width_ratio<span class="op">=</span><span class="fl">0.2</span>,
    set_sizes<span class="op">=</span><span class="fu"><a href="../reference/upset_set_size.html">upset_set_size</a></span><span class="op">(</span><span class="op">)</span>
        <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>
            trans<span class="op">=</span><span class="fu"><a href="../reference/reverse_log_trans.html">reverse_log_trans</a></span><span class="op">(</span><span class="op">)</span>,
            labels<span class="op">=</span><span class="va">log10</span>
        <span class="op">)</span>
        <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">'log10(set size)'</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_95_0.png"></p>
</div>
<div id="display-counts" class="section level3">
<h3 class="hasAnchor">
<a href="#display-counts" class="anchor"></a>4.4 Display counts</h3>
<p>To display the count add <code><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text()</a></code>:</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">5</span>, <span class="fl">3</span><span class="op">)</span>

<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
    <span class="va">movies</span>, <span class="va">genres</span>,
    min_size<span class="op">=</span><span class="fl">10</span>,
    width_ratio<span class="op">=</span><span class="fl">0.3</span>,
    encode_sets<span class="op">=</span><span class="cn">FALSE</span>,  <span class="co"># for annotate() to select the set by name disable encoding</span>
    set_sizes<span class="op">=</span><span class="op">(</span>
        <span class="fu"><a href="../reference/upset_set_size.html">upset_set_size</a></span><span class="op">(</span><span class="op">)</span>
        <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label<span class="op">=</span><span class="va">..count..</span><span class="op">)</span>, hjust<span class="op">=</span><span class="fl">1.1</span>, stat<span class="op">=</span><span class="st">'count'</span><span class="op">)</span>
        <span class="co"># you can also add annotations on top of bars:</span>
        <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span>geom<span class="op">=</span><span class="st">'text'</span>, label<span class="op">=</span><span class="st">'@'</span>, x<span class="op">=</span><span class="st">'Drama'</span>, y<span class="op">=</span><span class="fl">850</span>, color<span class="op">=</span><span class="st">'white'</span>, size<span class="op">=</span><span class="fl">3</span><span class="op">)</span>
        <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expand_limits.html">expand_limits</a></span><span class="op">(</span>y<span class="op">=</span><span class="fl">1100</span><span class="op">)</span>
        <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.x<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>angle<span class="op">=</span><span class="fl">90</span><span class="op">)</span><span class="op">)</span>
    <span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_98_0.png"></p>
</div>
<div id="change-position-and-add-fill" class="section level3">
<h3 class="hasAnchor">
<a href="#change-position-and-add-fill" class="anchor"></a>4.5 Change position and add fill</h3>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">5</span>, <span class="fl">3</span><span class="op">)</span>

<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
    <span class="va">movies</span>, <span class="va">genres</span>,
    min_size<span class="op">=</span><span class="fl">10</span>,
    width_ratio<span class="op">=</span><span class="fl">0.3</span>,
    set_sizes<span class="op">=</span><span class="op">(</span>
        <span class="fu"><a href="../reference/upset_set_size.html">upset_set_size</a></span><span class="op">(</span>
            geom<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>
                <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill<span class="op">=</span><span class="va">mpaa</span>, x<span class="op">=</span><span class="va">group</span><span class="op">)</span>,
                width<span class="op">=</span><span class="fl">0.8</span>
            <span class="op">)</span>,
            position<span class="op">=</span><span class="st">'right'</span>
        <span class="op">)</span>
    <span class="op">)</span>,
    <span class="co"># moves legends over the set sizes</span>
    guides<span class="op">=</span><span class="st">'over'</span>
<span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_100_0.png"></p>
</div>
<div id="hide-the-set-sizes-altogether" class="section level3">
<h3 class="hasAnchor">
<a href="#hide-the-set-sizes-altogether" class="anchor"></a>4.6 Hide the set sizes altogether</h3>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">5</span>, <span class="fl">3</span><span class="op">)</span>

<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
    <span class="va">movies</span>, <span class="va">genres</span>,
    min_size<span class="op">=</span><span class="fl">10</span>,
    set_sizes<span class="op">=</span><span class="cn">FALSE</span>
<span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_102_0.png"></p>
</div>
</div>
<div id="adjusting-other-aesthetics" class="section level2">
<h2 class="hasAnchor">
<a href="#adjusting-other-aesthetics" class="anchor"></a>5. Adjusting other aesthetics</h2>
<div id="stripes" class="section level3">
<h3 class="hasAnchor">
<a href="#stripes" class="anchor"></a>5.1 Stripes</h3>
<p>Change the colors:</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">6</span>, <span class="fl">4</span><span class="op">)</span>
<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
    <span class="va">movies</span>,
    <span class="va">genres</span>,
    min_size<span class="op">=</span><span class="fl">10</span>,
    width_ratio<span class="op">=</span><span class="fl">0.2</span>,
    stripes<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'cornsilk1'</span>, <span class="st">'deepskyblue1'</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_106_0.png"></p>
<p>You can use multiple colors:</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">6</span>, <span class="fl">4</span><span class="op">)</span>
<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
    <span class="va">movies</span>,
    <span class="va">genres</span>,
    min_size<span class="op">=</span><span class="fl">10</span>,
    width_ratio<span class="op">=</span><span class="fl">0.2</span>,
    stripes<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'cornsilk1'</span>, <span class="st">'deepskyblue1'</span>, <span class="st">'grey90'</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_108_0.png"></p>
<p>Or, set the color to white to effectively disable the stripes:</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">6</span>, <span class="fl">4</span><span class="op">)</span>
<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
    <span class="va">movies</span>,
    <span class="va">genres</span>,
    min_size<span class="op">=</span><span class="fl">10</span>,
    width_ratio<span class="op">=</span><span class="fl">0.2</span>,
    stripes<span class="op">=</span><span class="st">'white'</span>
<span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_110_0.png"></p>
<p>Advanced customization using <code><a href="../reference/upset_stripes.html">upset_stripes()</a></code>:</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">6</span>, <span class="fl">4</span><span class="op">)</span>
<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
    <span class="va">movies</span>,
    <span class="va">genres</span>,
    min_size<span class="op">=</span><span class="fl">10</span>,
    width_ratio<span class="op">=</span><span class="fl">0.2</span>,
    stripes<span class="op">=</span><span class="fu"><a href="../reference/upset_stripes.html">upset_stripes</a></span><span class="op">(</span>
        geom<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">5</span><span class="op">)</span>,
        colors<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'cornsilk1'</span>, <span class="st">'deepskyblue1'</span>, <span class="st">'grey90'</span><span class="op">)</span>
    <span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_112_0.png"></p>
<p>Mapping stripes attributes to data using <code><a href="../reference/upset_stripes.html">upset_stripes()</a></code>:</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">6</span>, <span class="fl">4</span><span class="op">)</span>
<span class="va">genre_metadata</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
    set<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Action'</span>, <span class="st">'Animation'</span>, <span class="st">'Comedy'</span>, <span class="st">'Drama'</span>, <span class="st">'Documentary'</span>, <span class="st">'Romance'</span>, <span class="st">'Short'</span><span class="op">)</span>,
    shown_in_our_cinema<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'no'</span>, <span class="st">'no'</span>, <span class="st">'on weekends'</span>, <span class="st">'yes'</span>, <span class="st">'yes'</span>, <span class="st">'on weekends'</span>, <span class="st">'no'</span><span class="op">)</span>
<span class="op">)</span>

<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
    <span class="va">movies</span>,
    <span class="va">genres</span>,
    min_size<span class="op">=</span><span class="fl">10</span>,
    width_ratio<span class="op">=</span><span class="fl">0.2</span>,
    stripes<span class="op">=</span><span class="fu"><a href="../reference/upset_stripes.html">upset_stripes</a></span><span class="op">(</span>
        mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color<span class="op">=</span><span class="va">shown_in_our_cinema</span><span class="op">)</span>,
        colors<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
            <span class="st">'yes'</span><span class="op">=</span><span class="st">'green'</span>,
            <span class="st">'no'</span><span class="op">=</span><span class="st">'red'</span>,
            <span class="st">'on weekends'</span><span class="op">=</span><span class="st">'orange'</span>
        <span class="op">)</span>,
        data<span class="op">=</span><span class="va">genre_metadata</span>
    <span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_114_0.png"></p>
</div>
<div id="adding-title" class="section level3">
<h3 class="hasAnchor">
<a href="#adding-title" class="anchor"></a>5.2 Adding title</h3>
<p>Adding title with <code>ggtitle</code> with add it to the intersection matrix:</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">6</span>, <span class="fl">4</span><span class="op">)</span>
<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span><span class="va">movies</span>, <span class="va">genres</span>, min_size<span class="op">=</span><span class="fl">10</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">'Intersection matrix title'</span><span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_117_0.png"></p>
<p>In order to add a title for the entire plot, you need to wrap the plot:</p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">6</span>, <span class="fl">4</span><span class="op">)</span>
<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span><span class="va">movies</span>, <span class="va">genres</span>, min_size<span class="op">=</span><span class="fl">10</span>, wrap<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">'The overlap between genres'</span><span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_119_0.png"></p>
</div>
<div id="making-the-plot-transparent" class="section level3">
<h3 class="hasAnchor">
<a href="#making-the-plot-transparent" class="anchor"></a>5.3 Making the plot transparent</h3>
<p>You need to set the plot background to transparent and adjust colors of stripes to your liking:</p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">6</span>, <span class="fl">4</span><span class="op">)</span>
<span class="op">(</span>
    <span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
        <span class="va">movies</span>, <span class="va">genres</span>, name<span class="op">=</span><span class="st">'genre'</span>, width_ratio<span class="op">=</span><span class="fl">0.1</span>, min_size<span class="op">=</span><span class="fl">10</span>,
        stripes<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://scales.r-lib.org/reference/alpha.html">alpha</a></span><span class="op">(</span><span class="st">'grey90'</span>, <span class="fl">0.45</span><span class="op">)</span>, <span class="fu"><a href="https://scales.r-lib.org/reference/alpha.html">alpha</a></span><span class="op">(</span><span class="st">'white'</span>, <span class="fl">0.3</span><span class="op">)</span><span class="op">)</span>
    <span class="op">)</span>
    <span class="op">&amp;</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>plot.background<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_rect</a></span><span class="op">(</span>fill<span class="op">=</span><span class="st">'transparent'</span>, color<span class="op">=</span><span class="cn">NA</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_122_0.png"></p>
<p>Use <code><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave('upset.png', bg="transparent")</a></code> when exporting to PNG.</p>
</div>
<div id="adjusting-the-intersection-matrix" class="section level3">
<h3 class="hasAnchor">
<a href="#adjusting-the-intersection-matrix" class="anchor"></a>5.4 Adjusting the intersection matrix</h3>
<p>Use <code><a href="../reference/intersection_matrix.html">intersection_matrix()</a></code> to modify the matrix parameters:</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">8</span>, <span class="fl">4</span><span class="op">)</span>
<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
    <span class="va">movies</span>, <span class="va">genres</span>, name<span class="op">=</span><span class="st">'genre'</span>, min_size<span class="op">=</span><span class="fl">10</span>,
    encode_sets<span class="op">=</span><span class="cn">FALSE</span>,  <span class="co"># for annotate() to select the set by name disable encoding</span>
    matrix<span class="op">=</span><span class="op">(</span>
        <span class="fu"><a href="../reference/intersection_matrix.html">intersection_matrix</a></span><span class="op">(</span>
            geom<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>
                shape<span class="op">=</span><span class="st">'square'</span>,
                size<span class="op">=</span><span class="fl">3.5</span>
            <span class="op">)</span>,
            segment<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span><span class="op">(</span>
                linetype<span class="op">=</span><span class="st">'dotted'</span>
            <span class="op">)</span>,
            outline_color<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
                active<span class="op">=</span><span class="st">'darkorange3'</span>,
                inactive<span class="op">=</span><span class="st">'grey70'</span>
            <span class="op">)</span>
        <span class="op">)</span>
        <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>
            values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'TRUE'</span><span class="op">=</span><span class="st">'orange'</span>, <span class="st">'FALSE'</span><span class="op">=</span><span class="st">'grey'</span><span class="op">)</span>,
            labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'TRUE'</span><span class="op">=</span><span class="st">'yes'</span>, <span class="st">'FALSE'</span><span class="op">=</span><span class="st">'no'</span><span class="op">)</span>,
            breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'TRUE'</span>, <span class="st">'FALSE'</span><span class="op">)</span>,
            name<span class="op">=</span><span class="st">'Is intersection member?'</span>
        <span class="op">)</span>
        <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html">scale_y_discrete</a></span><span class="op">(</span>
            position<span class="op">=</span><span class="st">'right'</span>
        <span class="op">)</span>
        <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span>
            geom<span class="op">=</span><span class="st">'text'</span>,
            label<span class="op">=</span><span class="st">'Look here →'</span>,
            x<span class="op">=</span><span class="st">'Comedy-Drama'</span>,
            y<span class="op">=</span><span class="st">'Drama'</span>,
            size<span class="op">=</span><span class="fl">5</span>,
            hjust<span class="op">=</span><span class="fl">1</span>
        <span class="op">)</span>
    <span class="op">)</span>,
    queries<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
        <span class="fu"><a href="../reference/upset_query.html">upset_query</a></span><span class="op">(</span>
            intersect<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Drama'</span>, <span class="st">'Comedy'</span><span class="op">)</span>,
            color<span class="op">=</span><span class="st">'red'</span>,
            fill<span class="op">=</span><span class="st">'red'</span>,
            only_components<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'intersections_matrix'</span>, <span class="st">'Intersection size'</span><span class="op">)</span>
        <span class="op">)</span>
    <span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_126_0.png"></p>
</div>
</div>
<div id="themes" class="section level2">
<h2 class="hasAnchor">
<a href="#themes" class="anchor"></a>6. Themes</h2>
<p>The themes for specific components are defined in <code>upset_themes</code> list, which contains themes for:</p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">upset_themes</span><span class="op">)</span></code></pre></div>
<style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class="list-inline">
<li>
‘intersections_matrix’
</li>
<li>
‘Intersection size’
</li>
<li>
‘overall_sizes’
</li>
<li>
‘default’
</li>
</ol>
<p>You can substitute this list for your own using <code>themes</code> argument. While you can specify a theme for every component, if you omit one or more components those will be taken from the element named <code>default</code>.</p>
<div id="substituting-themes" class="section level3">
<h3 class="hasAnchor">
<a href="#substituting-themes" class="anchor"></a>6.1 Substituting themes</h3>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">8</span>, <span class="fl">4</span><span class="op">)</span>
<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span><span class="va">movies</span>, <span class="va">genres</span>, min_size<span class="op">=</span><span class="fl">10</span>, themes<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>default<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_132_0.png"></p>
<p>You can also add themes for your custom panels/annotations:</p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">8</span>, <span class="fl">8</span><span class="op">)</span>

<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
    <span class="va">movies</span>,
    <span class="va">genres</span>,
    annotations <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
        <span class="st">'Length'</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
            aes<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">intersection</span>, y<span class="op">=</span><span class="va">length</span><span class="op">)</span>,
            geom<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
        <span class="op">)</span>,
        <span class="st">'Rating'</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
            aes<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">intersection</span>, y<span class="op">=</span><span class="va">rating</span><span class="op">)</span>,
            geom<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
                <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html">geom_jitter</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">votes</span><span class="op">)</span><span class="op">)</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,
                <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_violin.html">geom_violin</a></span><span class="op">(</span>alpha<span class="op">=</span><span class="fl">0.5</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
            <span class="op">)</span>
        <span class="op">)</span>
    <span class="op">)</span>,
    min_size<span class="op">=</span><span class="fl">10</span>,
    width_ratio<span class="op">=</span><span class="fl">0.1</span>,
    themes<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/utils/modifyList.html">modifyList</a></span><span class="op">(</span>
        <span class="va">upset_themes</span>,
        <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>Rating<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void</a></span><span class="op">(</span><span class="op">)</span>, Length<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
    <span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_134_0.png"></p>
</div>
<div id="adjusting-the-default-themes" class="section level3">
<h3 class="hasAnchor">
<a href="#adjusting-the-default-themes" class="anchor"></a>6.2 Adjusting the default themes</h3>
<p>Modify all the default themes as once with <code><a href="../reference/upset_default_themes.html">upset_default_themes()</a></code>:</p>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">8</span>, <span class="fl">4</span><span class="op">)</span>

<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
    <span class="va">movies</span>, <span class="va">genres</span>, min_size<span class="op">=</span><span class="fl">10</span>, width_ratio<span class="op">=</span><span class="fl">0.1</span>,
    themes<span class="op">=</span><span class="fu"><a href="../reference/upset_default_themes.html">upset_default_themes</a></span><span class="op">(</span>text<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">'red'</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_137_0.png"></p>
<p>To modify only a subset of default themes use <code><a href="../reference/upset_modify_themes.html">upset_modify_themes()</a></code>:</p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">8</span>, <span class="fl">4</span><span class="op">)</span>

<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
    <span class="va">movies</span>, <span class="va">genres</span>,
    base_annotations<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">'Intersection size'</span><span class="op">=</span><span class="fu"><a href="../reference/intersection_size.html">intersection_size</a></span><span class="op">(</span>counts<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span>,
    min_size<span class="op">=</span><span class="fl">100</span>,
    width_ratio<span class="op">=</span><span class="fl">0.1</span>,
    themes<span class="op">=</span><span class="fu"><a href="../reference/upset_modify_themes.html">upset_modify_themes</a></span><span class="op">(</span>
        <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
            <span class="st">'intersections_matrix'</span><span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>text<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">20</span><span class="op">)</span><span class="op">)</span>,
            <span class="st">'overall_sizes'</span><span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.x<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>angle<span class="op">=</span><span class="fl">90</span><span class="op">)</span><span class="op">)</span>
        <span class="op">)</span>
    <span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_139_0.png"></p>
</div>
</div>
<div id="highlighting-queries" class="section level2">
<h2 class="hasAnchor">
<a href="#highlighting-queries" class="anchor"></a>7. Highlighting (queries)</h2>
<p>Pass a list of lists generated with <code><a href="../reference/upset_query.html">upset_query()</a></code> utility to the optional <code>queries</code> argument to selectively modify aesthetics of specific intersections or sets.</p>
<p>Use one of the arguments: <code>set</code> or <code>intersect</code> (not both) to specify what to highlight: - <code>set</code> will highlight the bar of the set size, - <code>intersect</code> will highlight an intersection on all components (by default), or on components chosen with <code>only_components</code> - all other parameters will be used to modify the geoms</p>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">8</span>, <span class="fl">6</span><span class="op">)</span>

<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
    <span class="va">movies</span>, <span class="va">genres</span>, name<span class="op">=</span><span class="st">'genre'</span>, width_ratio<span class="op">=</span><span class="fl">0.1</span>, min_size<span class="op">=</span><span class="fl">10</span>,
    annotations <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
        <span class="st">'Length'</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
            aes<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">intersection</span>, y<span class="op">=</span><span class="va">length</span><span class="op">)</span>,
            geom<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
        <span class="op">)</span>
    <span class="op">)</span>,
    queries<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
        <span class="fu"><a href="../reference/upset_query.html">upset_query</a></span><span class="op">(</span>
            intersect<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Drama'</span>, <span class="st">'Comedy'</span><span class="op">)</span>,
            color<span class="op">=</span><span class="st">'red'</span>,
            fill<span class="op">=</span><span class="st">'red'</span>,
            only_components<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'intersections_matrix'</span>, <span class="st">'Intersection size'</span><span class="op">)</span>
        <span class="op">)</span>,
        <span class="fu"><a href="../reference/upset_query.html">upset_query</a></span><span class="op">(</span>
            set<span class="op">=</span><span class="st">'Drama'</span>,
            fill<span class="op">=</span><span class="st">'blue'</span>
        <span class="op">)</span>,
        <span class="fu"><a href="../reference/upset_query.html">upset_query</a></span><span class="op">(</span>
            intersect<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Romance'</span>, <span class="st">'Comedy'</span><span class="op">)</span>,
            fill<span class="op">=</span><span class="st">'yellow'</span>,
            only_components<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Length'</span><span class="op">)</span>
        <span class="op">)</span>
    <span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_142_0.png"></p>
</div>
<div id="sorting" class="section level2">
<h2 class="hasAnchor">
<a href="#sorting" class="anchor"></a>8. Sorting</h2>
<div id="sorting-intersections" class="section level3">
<h3 class="hasAnchor">
<a href="#sorting-intersections" class="anchor"></a>8.1 Sorting intersections</h3>
<p>By degree:</p>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">8</span>, <span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span><span class="va">movies</span>, <span class="va">genres</span>, width_ratio<span class="op">=</span><span class="fl">0.1</span>, sort_intersections_by<span class="op">=</span><span class="st">'degree'</span><span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_146_0.png"></p>
<p>By ratio:</p>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">8</span>, <span class="fl">4</span><span class="op">)</span>
<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
    <span class="va">movies</span>, <span class="va">genres</span>, name<span class="op">=</span><span class="st">'genre'</span>, width_ratio<span class="op">=</span><span class="fl">0.1</span>, min_size<span class="op">=</span><span class="fl">10</span>,
    sort_intersections_by<span class="op">=</span><span class="st">'ratio'</span>,
    base_annotations<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
        <span class="st">'Intersection size'</span><span class="op">=</span><span class="fu"><a href="../reference/intersection_size.html">intersection_size</a></span><span class="op">(</span>text_mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label<span class="op">=</span><span class="op">!</span><span class="op">!</span><span class="fu"><a href="../reference/upset_text_percentage.html">upset_text_percentage</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
        <span class="st">'Intersection ratio'</span><span class="op">=</span><span class="fu"><a href="../reference/intersection_ratio.html">intersection_ratio</a></span><span class="op">(</span>text_mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label<span class="op">=</span><span class="op">!</span><span class="op">!</span><span class="fu"><a href="../reference/upset_text_percentage.html">upset_text_percentage</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
    <span class="op">)</span>
<span class="op">)</span></code></pre></div>
<pre><code>Warning message:
“Removed 62 rows containing missing values (position_stack).”</code></pre>
<p><img src="Examples_R_files/Examples_R_148_1.png"></p>
<p>The other way around:</p>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">8</span>, <span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span><span class="va">movies</span>, <span class="va">genres</span>, width_ratio<span class="op">=</span><span class="fl">0.1</span>, sort_intersections<span class="op">=</span><span class="st">'ascending'</span><span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_150_0.png"></p>
<p>Without any sorting:</p>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">8</span>, <span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span><span class="va">movies</span>, <span class="va">genres</span>, width_ratio<span class="op">=</span><span class="fl">0.1</span>, sort_intersections<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_152_0.png"></p>
<p>First by degree then by cardinality:</p>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">8</span>, <span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span><span class="va">movies</span>, <span class="va">genres</span>, width_ratio<span class="op">=</span><span class="fl">0.1</span>, sort_intersections_by<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'degree'</span>, <span class="st">'cardinality'</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_154_0.png"></p>
<p>User-specified order:</p>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">6</span>, <span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
    <span class="va">movies</span>,
    <span class="va">genres</span>,
    width_ratio<span class="op">=</span><span class="fl">0.1</span>,
    sort_intersections<span class="op">=</span><span class="cn">FALSE</span>,
    intersections<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
        <span class="st">'Comedy'</span>,
        <span class="st">'Drama'</span>,
        <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Comedy'</span>, <span class="st">'Romance'</span><span class="op">)</span>,
        <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Romance'</span>, <span class="st">'Drama'</span><span class="op">)</span>,
        <span class="st">'Outside of known sets'</span>,
        <span class="st">'Action'</span>
    <span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_156_0.png"></p>
</div>
<div id="sorting-sets" class="section level3">
<h3 class="hasAnchor">
<a href="#sorting-sets" class="anchor"></a>8.2 Sorting sets</h3>
<p>Ascending:</p>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">8</span>, <span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span><span class="va">movies</span>, <span class="va">genres</span>, width_ratio<span class="op">=</span><span class="fl">0.1</span>, sort_sets<span class="op">=</span><span class="st">'ascending'</span><span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_159_0.png"></p>
<p>Without sorting - preserving the order as in genres:</p>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">genres</span></code></pre></div>
<style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class="list-inline">
<li>
‘Action’
</li>
<li>
‘Animation’
</li>
<li>
‘Comedy’
</li>
<li>
‘Drama’
</li>
<li>
‘Documentary’
</li>
<li>
‘Romance’
</li>
<li>
‘Short’
</li>
</ol>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">8</span>, <span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span><span class="va">movies</span>, <span class="va">genres</span>, width_ratio<span class="op">=</span><span class="fl">0.1</span>, sort_sets<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_162_0.png"></p>
</div>
</div>
<div id="grouping" class="section level2">
<h2 class="hasAnchor">
<a href="#grouping" class="anchor"></a>9. Grouping</h2>
<div id="grouping-intersections" class="section level3">
<h3 class="hasAnchor">
<a href="#grouping-intersections" class="anchor"></a>9.1 Grouping intersections</h3>
<p>Use <code>group_by='sets'</code> to group intersections by set. If needed, the intersections will be repeated so that they appear in each set group. Use <code><a href="../reference/upset_query.html">upset_query()</a></code> with <code>group</code> argument to color the intersection matrix accordingly.</p>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">8</span>, <span class="fl">3</span><span class="op">)</span>

<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
    <span class="va">movies</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Action"</span>, <span class="st">"Comedy"</span>, <span class="st">"Drama"</span><span class="op">)</span>,
    width_ratio<span class="op">=</span><span class="fl">0.2</span>,
    group_by<span class="op">=</span><span class="st">'sets'</span>,
    queries<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
        <span class="fu"><a href="../reference/upset_query.html">upset_query</a></span><span class="op">(</span>
            intersect<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Drama'</span>, <span class="st">'Comedy'</span><span class="op">)</span>,
            color<span class="op">=</span><span class="st">'red'</span>,
            fill<span class="op">=</span><span class="st">'red'</span>,
            only_components<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'intersections_matrix'</span>, <span class="st">'Intersection size'</span><span class="op">)</span>
        <span class="op">)</span>,
        <span class="fu"><a href="../reference/upset_query.html">upset_query</a></span><span class="op">(</span>group<span class="op">=</span><span class="st">'Drama'</span>, color<span class="op">=</span><span class="st">'blue'</span><span class="op">)</span>,
        <span class="fu"><a href="../reference/upset_query.html">upset_query</a></span><span class="op">(</span>group<span class="op">=</span><span class="st">'Comedy'</span>, color<span class="op">=</span><span class="st">'orange'</span><span class="op">)</span>,
        <span class="fu"><a href="../reference/upset_query.html">upset_query</a></span><span class="op">(</span>group<span class="op">=</span><span class="st">'Action'</span>, color<span class="op">=</span><span class="st">'purple'</span><span class="op">)</span>,
        <span class="fu"><a href="../reference/upset_query.html">upset_query</a></span><span class="op">(</span>set<span class="op">=</span><span class="st">'Drama'</span>, fill<span class="op">=</span><span class="st">'blue'</span><span class="op">)</span>,
        <span class="fu"><a href="../reference/upset_query.html">upset_query</a></span><span class="op">(</span>set<span class="op">=</span><span class="st">'Comedy'</span>, fill<span class="op">=</span><span class="st">'orange'</span><span class="op">)</span>,
        <span class="fu"><a href="../reference/upset_query.html">upset_query</a></span><span class="op">(</span>set<span class="op">=</span><span class="st">'Action'</span>, fill<span class="op">=</span><span class="st">'purple'</span><span class="op">)</span>
    <span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_166_0.png"></p>
</div>
</div>
<div id="display-percentages" class="section level2">
<h2 class="hasAnchor">
<a href="#display-percentages" class="anchor"></a>10. Display percentages</h2>
<p>Use <code><a href="../reference/aes_percentage.html">aes_percentage()</a></code> utility preceded with <code>!!</code> syntax to easily display percentages. In the examples below only percentages for the movies with R rating are shown to avoid visual clutter.</p>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rating_scale</span> <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
    <span class="st">'R'</span><span class="op">=</span><span class="st">'#E41A1C'</span>, <span class="st">'PG'</span><span class="op">=</span><span class="st">'#377EB8'</span>,
    <span class="st">'PG-13'</span><span class="op">=</span><span class="st">'#4DAF4A'</span>, <span class="st">'NC-17'</span><span class="op">=</span><span class="st">'#FF7F00'</span>
<span class="op">)</span><span class="op">)</span>
<span class="va">show_hide_scale</span> <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'show'</span><span class="op">=</span><span class="st">'black'</span>, <span class="st">'hide'</span><span class="op">=</span><span class="st">'transparent'</span><span class="op">)</span>, guide<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<div id="within-intersection" class="section level3">
<h3 class="hasAnchor">
<a href="#within-intersection" class="anchor"></a>10.1 Within intersection</h3>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">8</span>, <span class="fl">5</span><span class="op">)</span>

<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
    <span class="va">movies</span>, <span class="va">genres</span>, name<span class="op">=</span><span class="st">'genre'</span>, width_ratio<span class="op">=</span><span class="fl">0.1</span>, min_size<span class="op">=</span><span class="fl">100</span>,
    annotations <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
        <span class="st">'MPAA Rating'</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
            aes<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">intersection</span>, fill<span class="op">=</span><span class="va">mpaa</span><span class="op">)</span>,
            geom<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
                <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>stat<span class="op">=</span><span class="st">'count'</span>, position<span class="op">=</span><span class="st">'fill'</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,
                <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span>
                    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>
                        label<span class="op">=</span><span class="op">!</span><span class="op">!</span><span class="fu"><a href="../reference/aes_percentage.html">aes_percentage</a></span><span class="op">(</span>relative_to<span class="op">=</span><span class="st">'intersection'</span><span class="op">)</span>,
                        color<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">mpaa</span> <span class="op">==</span> <span class="st">'R'</span>, <span class="st">'show'</span>, <span class="st">'hide'</span><span class="op">)</span>
                    <span class="op">)</span>,
                    stat<span class="op">=</span><span class="st">'count'</span>,
                    position<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_stack.html">position_fill</a></span><span class="op">(</span>vjust <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span>
                <span class="op">)</span>,
                <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>labels<span class="op">=</span><span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_percent.html">percent_format</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,
                <span class="va">show_hide_scale</span>,
                <span class="va">rating_scale</span>
            <span class="op">)</span>
        <span class="op">)</span>
    <span class="op">)</span>
<span class="op">)</span></code></pre></div>
<pre><code>Warning message:
“Removed 262 rows containing non-finite values (stat_count).”</code></pre>
<p><img src="Examples_R_files/Examples_R_171_1.png"></p>
</div>
<div id="relative-to-the-group" class="section level3">
<h3 class="hasAnchor">
<a href="#relative-to-the-group" class="anchor"></a>10.2 Relative to the group</h3>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">8</span>, <span class="fl">5</span><span class="op">)</span>

<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
    <span class="va">movies</span>, <span class="va">genres</span>, name<span class="op">=</span><span class="st">'genre'</span>, width_ratio<span class="op">=</span><span class="fl">0.1</span>, min_size<span class="op">=</span><span class="fl">100</span>,
    annotations <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
        <span class="st">'MPAA Rating'</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
            aes<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">intersection</span>, fill<span class="op">=</span><span class="va">mpaa</span><span class="op">)</span>,
            geom<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
                <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>stat<span class="op">=</span><span class="st">'count'</span>, position<span class="op">=</span><span class="st">'fill'</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,
                <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span>
                    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>
                        label<span class="op">=</span><span class="op">!</span><span class="op">!</span><span class="fu"><a href="../reference/aes_percentage.html">aes_percentage</a></span><span class="op">(</span>relative_to<span class="op">=</span><span class="st">'group'</span><span class="op">)</span>,
                        group<span class="op">=</span><span class="va">mpaa</span>,
                        color<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">mpaa</span> <span class="op">==</span> <span class="st">'R'</span>, <span class="st">'show'</span>, <span class="st">'hide'</span><span class="op">)</span>
                    <span class="op">)</span>,
                    stat<span class="op">=</span><span class="st">'count'</span>,
                    position<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_stack.html">position_fill</a></span><span class="op">(</span>vjust <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span>
                <span class="op">)</span>,
                <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>labels<span class="op">=</span><span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_percent.html">percent_format</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,
                <span class="va">show_hide_scale</span>,
                <span class="va">rating_scale</span>
            <span class="op">)</span>
        <span class="op">)</span>
    <span class="op">)</span>
<span class="op">)</span></code></pre></div>
<pre><code>Warning message:
“Removed 262 rows containing non-finite values (stat_count).”</code></pre>
<p><img src="Examples_R_files/Examples_R_173_1.png"></p>
</div>
<div id="relative-to-all-observed-values" class="section level3">
<h3 class="hasAnchor">
<a href="#relative-to-all-observed-values" class="anchor"></a>10.3 Relative to all observed values</h3>
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">8</span>, <span class="fl">5</span><span class="op">)</span>

<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
    <span class="va">movies</span>, <span class="va">genres</span>, name<span class="op">=</span><span class="st">'genre'</span>, width_ratio<span class="op">=</span><span class="fl">0.1</span>, min_size<span class="op">=</span><span class="fl">100</span>,
    annotations <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
        <span class="st">'MPAA Rating'</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
            aes<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">intersection</span>, fill<span class="op">=</span><span class="va">mpaa</span><span class="op">)</span>,
            geom<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
                <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>stat<span class="op">=</span><span class="st">'count'</span>, position<span class="op">=</span><span class="st">'fill'</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,
                <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span>
                    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>
                        label<span class="op">=</span><span class="op">!</span><span class="op">!</span><span class="fu"><a href="../reference/aes_percentage.html">aes_percentage</a></span><span class="op">(</span>relative_to<span class="op">=</span><span class="st">'all'</span><span class="op">)</span>,
                        color<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">mpaa</span> <span class="op">==</span> <span class="st">'R'</span>, <span class="st">'show'</span>, <span class="st">'hide'</span><span class="op">)</span>
                    <span class="op">)</span>,
                    stat<span class="op">=</span><span class="st">'count'</span>,
                    position<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_stack.html">position_fill</a></span><span class="op">(</span>vjust <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span>
                <span class="op">)</span>,
                <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>labels<span class="op">=</span><span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_percent.html">percent_format</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,
                <span class="va">show_hide_scale</span>,
                <span class="va">rating_scale</span>
            <span class="op">)</span>
        <span class="op">)</span>
    <span class="op">)</span>
<span class="op">)</span></code></pre></div>
<pre><code>Warning message:
“Removed 262 rows containing non-finite values (stat_count).”</code></pre>
<p><img src="Examples_R_files/Examples_R_175_1.png"></p>
</div>
</div>
<div id="advanced-usage-examples" class="section level2">
<h2 class="hasAnchor">
<a href="#advanced-usage-examples" class="anchor"></a>11. Advanced usage examples</h2>
<div id="display-text-on-some-bars-only" class="section level3">
<h3 class="hasAnchor">
<a href="#display-text-on-some-bars-only" class="anchor"></a>11.1 Display text on some bars only</h3>
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">8</span>, <span class="fl">5</span><span class="op">)</span>

<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
    <span class="va">movies</span>, <span class="va">genres</span>, name<span class="op">=</span><span class="st">'genre'</span>, width_ratio<span class="op">=</span><span class="fl">0.1</span>, min_size<span class="op">=</span><span class="fl">100</span>,
    annotations <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
        <span class="st">'MPAA Rating'</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
            aes<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">intersection</span>, fill<span class="op">=</span><span class="va">mpaa</span><span class="op">)</span>,
            geom<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
                <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>stat<span class="op">=</span><span class="st">'count'</span>, position<span class="op">=</span><span class="st">'fill'</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,
                <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span>
                    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">mpaa</span> <span class="op">==</span> <span class="st">'R'</span>, <span class="st">'R'</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span>,
                    stat<span class="op">=</span><span class="st">'count'</span>,
                    position<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_stack.html">position_fill</a></span><span class="op">(</span>vjust <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span>,
                    na.rm<span class="op">=</span><span class="cn">TRUE</span>
                <span class="op">)</span>,
                <span class="va">show_hide_scale</span>,
                <span class="va">rating_scale</span>
            <span class="op">)</span>
        <span class="op">)</span>
    <span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_178_0.png"></p>
</div>
<div id="combine-multiple-plots-together" class="section level3">
<h3 class="hasAnchor">
<a href="#combine-multiple-plots-together" class="anchor"></a>11.2 Combine multiple plots together</h3>
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">8</span>, <span class="fl">5</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op">)</span>

<span class="va">annotations</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
    <span class="st">'MPAA Rating'</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
        aes<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">intersection</span>, fill<span class="op">=</span><span class="va">mpaa</span><span class="op">)</span>,
        geom<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>stat<span class="op">=</span><span class="st">'count'</span>, position<span class="op">=</span><span class="st">'fill'</span><span class="op">)</span>
        <span class="op">)</span>
    <span class="op">)</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span>    <span class="co"># for replicable example only</span>

<span class="va">data_1</span> <span class="op">=</span> <span class="va">movies</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">movies</span><span class="op">)</span>, <span class="fl">100</span><span class="op">)</span>, <span class="op">]</span>
<span class="va">data_2</span> <span class="op">=</span> <span class="va">movies</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">movies</span><span class="op">)</span>, <span class="fl">100</span><span class="op">)</span>, <span class="op">]</span>

<span class="va">u1</span> <span class="op">=</span> <span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span><span class="va">data_1</span>, <span class="va">genres</span>, min_size<span class="op">=</span><span class="fl">5</span>, base_annotations<span class="op">=</span><span class="va">annotations</span><span class="op">)</span>
<span class="va">u2</span> <span class="op">=</span> <span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span><span class="va">data_2</span>, <span class="va">genres</span>, min_size<span class="op">=</span><span class="fl">5</span>, base_annotations<span class="op">=</span><span class="va">annotations</span><span class="op">)</span>

<span class="op">(</span><span class="va">u1</span> <span class="op">|</span> <span class="va">u2</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html">plot_layout</a></span><span class="op">(</span>guides<span class="op">=</span><span class="st">'collect'</span><span class="op">)</span></code></pre></div>
<pre><code>Warning message:
“Removed 16 rows containing non-finite values (stat_count).”
Warning message:
“Removed 15 rows containing non-finite values (stat_count).”</code></pre>
<p><img src="Examples_R_files/Examples_R_180_1.png"></p>
</div>
<div id="change-height-of-the-annotations" class="section level3">
<h3 class="hasAnchor">
<a href="#change-height-of-the-annotations" class="anchor"></a>11.3 Change height of the annotations</h3>
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">8</span>, <span class="fl">3.5</span><span class="op">)</span>
<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
    <span class="va">movies</span>, <span class="va">genres</span>, name<span class="op">=</span><span class="st">'genre'</span>, width_ratio<span class="op">=</span><span class="fl">0.1</span>, min_size<span class="op">=</span><span class="fl">100</span>,
    annotations <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
        <span class="st">'MPAA Rating'</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
            aes<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">intersection</span>, fill<span class="op">=</span><span class="va">mpaa</span><span class="op">)</span>,
            geom<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
                <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>stat<span class="op">=</span><span class="st">'count'</span>, position<span class="op">=</span><span class="st">'fill'</span><span class="op">)</span>,
                <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>labels<span class="op">=</span><span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_percent.html">percent_format</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
            <span class="op">)</span>
        <span class="op">)</span>
    <span class="op">)</span>
<span class="op">)</span> <span class="op">+</span> <span class="fu">patchwork</span><span class="fu">::</span><span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html">plot_layout</a></span><span class="op">(</span>heights<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>Warning message:
“Removed 262 rows containing non-finite values (stat_count).”</code></pre>
<p><img src="Examples_R_files/Examples_R_182_1.png"></p>
</div>
</div>
<div id="venn-diagrams" class="section level2">
<h2 class="hasAnchor">
<a href="#venn-diagrams" class="anchor"></a>12. Venn diagrams</h2>
<p>Simple implementation of Venn diagrams is provided, taking the same input format as <code><a href="../reference/upset.html">upset()</a></code> but only supporting up to three sets.</p>
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">movies_subset</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">movies</span>, <span class="fl">300</span><span class="op">)</span>
<span class="va">genres_subset</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Comedy'</span>, <span class="st">'Drama'</span>, <span class="st">'Action'</span><span class="op">)</span>

<span class="va">movies_subset</span><span class="op">$</span><span class="va">good_rating</span> <span class="op">=</span> <span class="va">movies_subset</span><span class="op">$</span><span class="va">rating</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">movies_subset</span><span class="op">$</span><span class="va">rating</span><span class="op">)</span>
<span class="va">arranged</span> <span class="op">=</span> <span class="fu"><a href="../reference/arrange_venn.html">arrange_venn</a></span><span class="op">(</span><span class="va">movies_subset</span>, sets<span class="op">=</span><span class="va">genres_subset</span><span class="op">)</span></code></pre></div>
<div id="highlight-specific-elements" class="section level3">
<h3 class="hasAnchor">
<a href="#highlight-specific-elements" class="anchor"></a>12.1 Highlight specific elements</h3>
<div class="sourceCode" id="cb88"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">8</span>, <span class="fl">5.5</span><span class="op">)</span>
<span class="op">(</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">arranged</span><span class="op">)</span>
    <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void</a></span><span class="op">(</span><span class="op">)</span>
    <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_fixed</a></span><span class="op">(</span><span class="op">)</span>
    <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span>, y<span class="op">=</span><span class="va">y</span>, color<span class="op">=</span><span class="va">region</span>, shape<span class="op">=</span><span class="va">good_rating</span>, fill<span class="op">=</span><span class="va">length</span><span class="op">)</span>, size<span class="op">=</span><span class="fl">2.7</span><span class="op">)</span>
    <span class="op">+</span> <span class="fu"><a href="../reference/geom_venn_circle.html">geom_venn_circle</a></span><span class="op">(</span><span class="va">movies_subset</span>, sets<span class="op">=</span><span class="va">genres_subset</span>, size<span class="op">=</span><span class="fl">1</span><span class="op">)</span>
    <span class="op">+</span> <span class="fu"><a href="../reference/geom_venn_label_set.html">geom_venn_label_set</a></span><span class="op">(</span><span class="va">movies_subset</span>, sets<span class="op">=</span><span class="va">genres_subset</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label<span class="op">=</span><span class="va">region</span><span class="op">)</span>, outwards_adjust<span class="op">=</span><span class="fl">2.6</span><span class="op">)</span>
    <span class="op">+</span> <span class="fu"><a href="../reference/geom_venn_label_region.html">geom_venn_label_region</a></span><span class="op">(</span><span class="va">movies_subset</span>, sets<span class="op">=</span><span class="va">genres_subset</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label<span class="op">=</span><span class="va">size</span><span class="op">)</span>, position<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_nudge.html">position_nudge</a></span><span class="op">(</span>y<span class="op">=</span><span class="fl">0.15</span><span class="op">)</span><span class="op">)</span>
    <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_curve</a></span><span class="op">(</span>
        data<span class="op">=</span><span class="va">arranged</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html">which.min</a></span><span class="op">(</span><span class="va">arranged</span><span class="op">$</span><span class="va">length</span><span class="op">)</span>, <span class="op">]</span>,
        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>xend<span class="op">=</span><span class="va">x</span><span class="op">+</span><span class="fl">0.01</span>, yend<span class="op">=</span><span class="va">y</span><span class="op">+</span><span class="fl">0.01</span><span class="op">)</span>, x<span class="op">=</span><span class="fl">1.5</span>, y<span class="op">=</span><span class="fl">2.5</span>, curvature<span class="op">=</span><span class="fl">.2</span>,
        arrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/arrow.html">arrow</a></span><span class="op">(</span>length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">0.015</span>, <span class="st">"npc"</span><span class="op">)</span><span class="op">)</span>
    <span class="op">)</span>
    <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span>
        geom<span class="op">=</span><span class="st">'text'</span>, x<span class="op">=</span><span class="fl">1.9</span>, y<span class="op">=</span><span class="fl">2.6</span>, size<span class="op">=</span><span class="fl">6</span>,
        label<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span><span class="op">(</span><span class="va">arranged</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html">which.min</a></span><span class="op">(</span><span class="va">arranged</span><span class="op">$</span><span class="va">length</span><span class="op">)</span>, <span class="op">]</span><span class="op">$</span><span class="va">title</span>, <span class="fl">0</span>, <span class="fl">9</span><span class="op">)</span>, <span class="st">'is the shortest'</span><span class="op">)</span>
    <span class="op">)</span>
    <span class="op">+</span> <span class="fu"><a href="../reference/scale_color_venn_mix.html">scale_color_venn_mix</a></span><span class="op">(</span><span class="va">movies</span>, sets<span class="op">=</span><span class="va">genres_subset</span>, guide<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
    <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_shape_manual</a></span><span class="op">(</span>
        values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
            <span class="st">'TRUE'</span><span class="op">=</span><span class="st">'triangle filled'</span>,
            <span class="st">'FALSE'</span><span class="op">=</span><span class="st">'triangle down filled'</span>
        <span class="op">)</span>,
        labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
            <span class="st">'TRUE'</span><span class="op">=</span><span class="st">'above average'</span>,
            <span class="st">'FALSE'</span><span class="op">=</span><span class="st">'below average'</span>
        <span class="op">)</span>,
        name<span class="op">=</span><span class="st">'Rating'</span>
    <span class="op">)</span>
    <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_fill_gradient</a></span><span class="op">(</span>low<span class="op">=</span><span class="st">'white'</span>, high<span class="op">=</span><span class="st">'black'</span>, name<span class="op">=</span><span class="st">'Length (minutes)'</span><span class="op">)</span>

<span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_187_0.png"></p>
</div>
<div id="highlight-all-regions" class="section level3">
<h3 class="hasAnchor">
<a href="#highlight-all-regions" class="anchor"></a>12.2 Highlight all regions</h3>
<div class="sourceCode" id="cb89"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">8</span>, <span class="fl">5.5</span><span class="op">)</span>
<span class="op">(</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">arranged</span><span class="op">)</span>
    <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void</a></span><span class="op">(</span><span class="op">)</span>
    <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_fixed</a></span><span class="op">(</span><span class="op">)</span>
    <span class="op">+</span> <span class="fu"><a href="../reference/geom_venn_region.html">geom_venn_region</a></span><span class="op">(</span><span class="va">movies_subset</span>, sets<span class="op">=</span><span class="va">genres_subset</span>, alpha<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span>
    <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span>, y<span class="op">=</span><span class="va">y</span>, color<span class="op">=</span><span class="va">region</span><span class="op">)</span>, size<span class="op">=</span><span class="fl">2.5</span><span class="op">)</span>
    <span class="op">+</span> <span class="fu"><a href="../reference/geom_venn_circle.html">geom_venn_circle</a></span><span class="op">(</span><span class="va">movies_subset</span>, sets<span class="op">=</span><span class="va">genres_subset</span>, size<span class="op">=</span><span class="fl">1.5</span><span class="op">)</span>
    <span class="op">+</span> <span class="fu"><a href="../reference/geom_venn_label_set.html">geom_venn_label_set</a></span><span class="op">(</span><span class="va">movies_subset</span>, sets<span class="op">=</span><span class="va">genres_subset</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label<span class="op">=</span><span class="va">region</span><span class="op">)</span>, outwards_adjust<span class="op">=</span><span class="fl">2.6</span><span class="op">)</span>
    <span class="op">+</span> <span class="fu"><a href="../reference/geom_venn_label_region.html">geom_venn_label_region</a></span><span class="op">(</span><span class="va">movies_subset</span>, sets<span class="op">=</span><span class="va">genres_subset</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label<span class="op">=</span><span class="va">size</span><span class="op">)</span>, position<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_nudge.html">position_nudge</a></span><span class="op">(</span>y<span class="op">=</span><span class="fl">0.15</span><span class="op">)</span><span class="op">)</span>
    <span class="op">+</span> <span class="fu"><a href="../reference/scale_color_venn_mix.html">scale_color_venn_mix</a></span><span class="op">(</span><span class="va">movies</span>, sets<span class="op">=</span><span class="va">genres_subset</span>, guide<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
    <span class="op">+</span> <span class="fu"><a href="../reference/scale_fill_venn_mix.html">scale_fill_venn_mix</a></span><span class="op">(</span><span class="va">movies</span>, sets<span class="op">=</span><span class="va">genres_subset</span>, guide<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_189_0.png"></p>
</div>
<div id="highlight-specific-regions" class="section level3">
<h3 class="hasAnchor">
<a href="#highlight-specific-regions" class="anchor"></a>12.3 Highlight specific regions</h3>
<div class="sourceCode" id="cb90"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">8</span>, <span class="fl">5.5</span><span class="op">)</span>

<span class="op">(</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">arranged</span><span class="op">)</span>
    <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void</a></span><span class="op">(</span><span class="op">)</span>
    <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_fixed</a></span><span class="op">(</span><span class="op">)</span>
    <span class="op">+</span> <span class="fu"><a href="../reference/geom_venn_region.html">geom_venn_region</a></span><span class="op">(</span><span class="va">movies_subset</span>, sets<span class="op">=</span><span class="va">genres_subset</span>, alpha<span class="op">=</span><span class="fl">0.2</span><span class="op">)</span>
    <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span>, y<span class="op">=</span><span class="va">y</span>, color<span class="op">=</span><span class="va">region</span><span class="op">)</span>, size<span class="op">=</span><span class="fl">1.5</span><span class="op">)</span>
    <span class="op">+</span> <span class="fu"><a href="../reference/geom_venn_circle.html">geom_venn_circle</a></span><span class="op">(</span><span class="va">movies_subset</span>, sets<span class="op">=</span><span class="va">genres_subset</span>, size<span class="op">=</span><span class="fl">2</span><span class="op">)</span>
    <span class="op">+</span> <span class="fu"><a href="../reference/geom_venn_label_set.html">geom_venn_label_set</a></span><span class="op">(</span><span class="va">movies_subset</span>, sets<span class="op">=</span><span class="va">genres_subset</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label<span class="op">=</span><span class="va">region</span><span class="op">)</span>, outwards_adjust<span class="op">=</span><span class="fl">2.6</span><span class="op">)</span>
    <span class="op">+</span> <span class="fu"><a href="../reference/scale_color_venn_mix.html">scale_color_venn_mix</a></span><span class="op">(</span><span class="va">movies</span>, sets<span class="op">=</span><span class="va">genres_subset</span>, guide<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
    <span class="op">+</span> <span class="fu"><a href="../reference/scale_fill_venn_mix.html">scale_fill_venn_mix</a></span><span class="op">(</span><span class="va">movies</span>, sets<span class="op">=</span><span class="va">genres_subset</span>, guide<span class="op">=</span><span class="cn">FALSE</span>, highlight<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Comedy-Action'</span>, <span class="st">'Drama'</span><span class="op">)</span>, inactive_color<span class="op">=</span><span class="st">'white'</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_191_0.png"></p>
</div>
<div id="two-sets-venn" class="section level3">
<h3 class="hasAnchor">
<a href="#two-sets-venn" class="anchor"></a>12.4 Two sets Venn</h3>
<p>The density of the points grid is determined in such a way that the all the points from the set with the largest space restrictions are fit into the available area. In case of the diagram below, its the observations that do not belong to any set that define the grid density:</p>
<div class="sourceCode" id="cb91"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">6</span>, <span class="fl">4.5</span><span class="op">)</span>
<span class="va">genres_subset</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Action'</span>, <span class="st">'Drama'</span><span class="op">)</span>
<span class="op">(</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="../reference/arrange_venn.html">arrange_venn</a></span><span class="op">(</span><span class="va">movies_subset</span>, sets<span class="op">=</span><span class="va">genres_subset</span><span class="op">)</span><span class="op">)</span>
    <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void</a></span><span class="op">(</span><span class="op">)</span>
    <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_fixed</a></span><span class="op">(</span><span class="op">)</span>
    <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span>, y<span class="op">=</span><span class="va">y</span>, color<span class="op">=</span><span class="va">region</span><span class="op">)</span>, size<span class="op">=</span><span class="fl">2</span><span class="op">)</span>
    <span class="op">+</span> <span class="fu"><a href="../reference/geom_venn_circle.html">geom_venn_circle</a></span><span class="op">(</span><span class="va">movies_subset</span>, sets<span class="op">=</span><span class="va">genres_subset</span>, size<span class="op">=</span><span class="fl">2</span><span class="op">)</span>
    <span class="op">+</span> <span class="fu"><a href="../reference/geom_venn_label_set.html">geom_venn_label_set</a></span><span class="op">(</span><span class="va">movies_subset</span>, sets<span class="op">=</span><span class="va">genres_subset</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label<span class="op">=</span><span class="va">region</span><span class="op">)</span>, outwards_adjust<span class="op">=</span><span class="fl">2.6</span><span class="op">)</span>
    <span class="op">+</span> <span class="fu"><a href="../reference/scale_color_venn_mix.html">scale_color_venn_mix</a></span><span class="op">(</span><span class="va">movies</span>, sets<span class="op">=</span><span class="va">genres_subset</span>, guide<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_194_0.png"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Michał Krassowski.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.9000.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
